2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@654d6577
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@79bf04ef
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 200
2025-10-24 09:12:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:12:12 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 09:12:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:12:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 09:12:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 09:12:12 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 09:12:12 [http-nio-8080-exec-10] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 09:12:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:12:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 09:12:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 09:12:12 [http-nio-8080-exec-8] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 09:12:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 09:12:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:12:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 09:12:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 09:12:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 09:12:12 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 09:12:12 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 09:12:12 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 09:12:15 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 09:12:15 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 09:12:15 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 09:12:15 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 09:12:15 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555555(Integer), 555555555(Integer), 80(Integer), 90(Integer), 下单锁定库存(String), 2025-10-24T09:12:15.116690100(LocalDateTime)
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 09:12:15 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 09:12:15 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612683351197B937BD9(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T09:12:15.122669900(LocalDateTime), 2025-10-24T09:12:15.122669900(LocalDateTime)
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 09:12:15 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612683351197B937BD9
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 15(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 09:12:15 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 15, 订单号: ORD17612683351197B937BD9
2025-10-24 09:12:15 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612683351197B937BD9
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=15, orderNo=ORD17612683351197B937BD9, us (truncated)...]
2025-10-24 09:12:15 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:12:19 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/15/pay", parameters={}
2025-10-24 09:12:19 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 09:12:19 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 09:12:19 [http-nio-8080-exec-2] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 15, 支付方式: ALIPAY
2025-10-24 09:12:20 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 15, 支付方式: ALIPAY
2025-10-24 09:12:20 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 09:12:21 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 15(Long)
2025-10-24 09:12:21 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 09:12:25 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 15, 支付方式: ALIPAY
2025-10-24 09:12:27 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 15
2025-10-24 09:12:42 [http-nio-8080-exec-2] ERROR c.jiaoyi.controller.OrderController - 支付处理失败
java.lang.NullPointerException: Cannot invoke "com.jiaoyi.service.AlipayService$$M$_jr_3E77A1ED8603672B_6.createPayment(String, String, java.math.BigDecimal, String)" because the return value of "com.jiaoyi.service.PaymentService$$M$_jr_3E77A1ED8603672B_7._jr$ig$alipayService(Object)" is null
	at com.jiaoyi.service.PaymentService.callAlipayPayment(PaymentService.java:95)
	at com.jiaoyi.service.PaymentService.callThirdPartyPayment(PaymentService.java:75)
	at com.jiaoyi.service.PaymentService.processPayment(PaymentService.java:55)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.jiaoyi.service.PaymentService$$SpringCGLIB$$0.processPayment(<generated>)
	at com.jiaoyi.controller.OrderController.payOrder(OrderController.java:159)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:352)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:174)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.jiaoyi.controller.OrderController$$SpringCGLIB$$0.payOrder(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 09:12:42 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:12:42 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=500, message=支付处理失败: Cannot invoke "com.jiaoyi.service.AlipayService$$M$_jr_3E77A1E (truncated)...]
2025-10-24 09:12:42 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:12:43 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 09:12:43 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 09:12:47 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 38600 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 09:12:47 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 09:12:47 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 09:12:48 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 09:12:49 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 09:12:49 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 09:12:49 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 09:12:49 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1219 ms
2025-10-24 09:12:49 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 09:12:49 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 09:12:49 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 09:12:49 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 09:12:50 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 09:12:50 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 2.747 seconds (process running for 4.081)
2025-10-24 09:13:15 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 09:13:15 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@42c920bd
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@677e9935
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 09:13:15 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 09:13:15 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 09:13:15 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 09:13:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:13:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 09:13:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 09:13:15 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 09:13:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:13:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 09:13:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 09:13:15 [http-nio-8080-exec-5] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 09:13:15 [http-nio-8080-exec-7] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 09:13:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 09:13:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:13:15 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 09:13:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 09:13:16 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 09:13:16 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 09:13:16 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 09:13:16 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 09:13:17 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 09:13:17 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 09:13:17 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 09:13:17 [http-nio-8080-exec-6] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 09:13:17 [http-nio-8080-exec-6] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 09:13:18 [http-nio-8080-exec-6] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@135fe6f4
2025-10-24 09:13:18 [http-nio-8080-exec-6] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 09:13:18 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 09:13:18 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 09:13:18 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 09:13:18 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555555(Integer), 555555555(Integer), 90(Integer), 100(Integer), 下单锁定库存(String), 2025-10-24T09:13:18.191155500(LocalDateTime)
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 09:13:18 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 09:13:18 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612683982117336719D(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T09:13:18.216144200(LocalDateTime), 2025-10-24T09:13:18.217139800(LocalDateTime)
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 09:13:18 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612683982117336719D
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 16(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 09:13:18 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 16, 订单号: ORD17612683982117336719D
2025-10-24 09:13:18 [http-nio-8080-exec-6] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612683982117336719D
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=16, orderNo=ORD17612683982117336719D, us (truncated)...]
2025-10-24 09:13:18 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:13:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/16/pay", parameters={}
2025-10-24 09:13:19 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 09:13:19 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 09:13:19 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 16, 支付方式: ALIPAY
2025-10-24 09:13:20 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 16, 支付方式: ALIPAY
2025-10-24 09:13:20 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 09:13:20 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 16(Long)
2025-10-24 09:13:20 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 09:13:30 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 16, 支付方式: ALIPAY
2025-10-24 09:13:30 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 16
2025-10-24 09:13:30 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 创建支付宝支付订单，订单号: ORD17612683982117336719D, 金额: 0.6
2025-10-24 09:13:43 [http-nio-8080-exec-4] ERROR c.jiaoyi.controller.OrderController - 支付处理失败
java.lang.RuntimeException: com.alipay.api.AlipayApiException: RSA2签名遭遇异常，请检查私钥格式是否正确。java.security.InvalidKeyException: Unable to decode key content=alipay_sdk=alipay-sdk-java-4.38.10.ALL&app_id=9021000136671234&biz_content={"body":"订单支付：ORD17612683982117336719D","out_trade_no":"PAY1761268409546857E9FBE","subject":"订单支付：ORD17612683982117336719D","timeout_express":"30m","total_amount":"0.6"}&charset=UTF-8&format=JSON&method=alipay.trade.precreate&notify_url=http://localhost:8080/api/payment/alipay/notify&sign_type=RSA2&timestamp=2025-10-24 09:13:42&version=1.0，charset=UTF-8，privateKeySize=64
	at com.alipay.api.DefaultSigner.sign(DefaultSigner.java:25)
	at com.alipay.api.AbstractAlipayClient.getRequestHolderWithSign(AbstractAlipayClient.java:836)
	at com.alipay.api.AbstractAlipayClient.doPost(AbstractAlipayClient.java:982)
	at com.alipay.api.AbstractAlipayClient._execute(AbstractAlipayClient.java:921)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:395)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:377)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:372)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:366)
	at com.jiaoyi.service.AlipayService.createPayment(AlipayService.java:61)
	at com.jiaoyi.service.PaymentService.callAlipayPayment(PaymentService.java:95)
	at com.jiaoyi.service.PaymentService.callThirdPartyPayment(PaymentService.java:75)
	at com.jiaoyi.service.PaymentService.processPayment(PaymentService.java:55)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:352)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:385)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.jiaoyi.service.PaymentService$$SpringCGLIB$$0.processPayment(<generated>)
	at com.jiaoyi.controller.OrderController.payOrder(OrderController.java:159)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:352)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:174)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.jiaoyi.controller.OrderController$$SpringCGLIB$$0.payOrder(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: com.alipay.api.AlipayApiException: RSA2签名遭遇异常，请检查私钥格式是否正确。java.security.InvalidKeyException: Unable to decode key content=alipay_sdk=alipay-sdk-java-4.38.10.ALL&app_id=9021000136671234&biz_content={"body":"订单支付：ORD17612683982117336719D","out_trade_no":"PAY1761268409546857E9FBE","subject":"订单支付：ORD17612683982117336719D","timeout_express":"30m","total_amount":"0.6"}&charset=UTF-8&format=JSON&method=alipay.trade.precreate&notify_url=http://localhost:8080/api/payment/alipay/notify&sign_type=RSA2&timestamp=2025-10-24 09:13:42&version=1.0，charset=UTF-8，privateKeySize=64
	at com.alipay.api.internal.util.asymmetric.BaseAsymmetricEncryptor.sign(BaseAsymmetricEncryptor.java:86)
	at com.alipay.api.internal.util.AlipaySignature.rsaSign(AlipaySignature.java:422)
	at com.alipay.api.DefaultSigner.sign(DefaultSigner.java:23)
	... 85 common frames omitted
Caused by: java.security.spec.InvalidKeySpecException: java.security.InvalidKeyException: Unable to decode key
	at java.base/sun.security.rsa.RSAKeyFactory.engineGeneratePrivate(RSAKeyFactory.java:253)
	at java.base/java.security.KeyFactory.generatePrivate(KeyFactory.java:389)
	at com.alipay.api.internal.util.asymmetric.RSAEncryptor.getPrivateKeyFromPKCS8(RSAEncryptor.java:162)
	at com.alipay.api.internal.util.asymmetric.RSAEncryptor.doSign(RSAEncryptor.java:115)
	at com.alipay.api.internal.util.asymmetric.BaseAsymmetricEncryptor.sign(BaseAsymmetricEncryptor.java:75)
	... 87 common frames omitted
Caused by: java.security.InvalidKeyException: Unable to decode key
	at java.base/sun.security.pkcs.PKCS8Key.<init>(PKCS8Key.java:98)
	at java.base/sun.security.rsa.RSAPrivateCrtKeyImpl.<init>(RSAPrivateCrtKeyImpl.java:162)
	at java.base/sun.security.rsa.RSAPrivateCrtKeyImpl.newKey(RSAPrivateCrtKeyImpl.java:92)
	at java.base/sun.security.rsa.RSAKeyFactory.generatePrivate(RSAKeyFactory.java:348)
	at java.base/sun.security.rsa.RSAKeyFactory.engineGeneratePrivate(RSAKeyFactory.java:249)
	... 91 common frames omitted
Caused by: java.io.EOFException: not enough content
	at java.base/sun.security.util.DerValue.<init>(DerValue.java:429)
	at java.base/sun.security.util.DerValue.<init>(DerValue.java:344)
	at java.base/sun.security.pkcs.PKCS8Key.<init>(PKCS8Key.java:96)
	... 95 common frames omitted
2025-10-24 09:13:43 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:13:43 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=500, message=支付处理失败: com.alipay.api.AlipayApiException: RSA2签名遭遇异常，请检查私钥格式是否正确。java (truncated)...]
2025-10-24 09:13:43 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:14:42 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 09:14:42 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 09:14:42 [http-nio-8080-exec-10] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 09:14:42 [http-nio-8080-exec-10] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 09:14:42 [http-nio-8080-exec-10] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 09:14:42 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 09:14:42 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:14:42 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 09:14:42 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 09:14:42 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 09:14:42 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:14:42 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 09:14:42 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:14:42 [http-nio-8080-exec-8] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 09:14:42 [http-nio-8080-exec-9] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 09:14:42 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 09:14:42 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 09:14:42 [http-nio-8080-exec-9] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 09:14:42 [http-nio-8080-exec-8] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 09:14:42 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:14:42 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 09:14:42 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 09:14:42 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 09:14:42 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 09:14:42 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 09:14:42 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 09:14:42 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 09:14:44 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 09:14:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 09:14:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 09:14:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 09:14:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555555(Integer), 555555555(Integer), 100(Integer), 110(Integer), 下单锁定库存(String), 2025-10-24T09:14:44.407313600(LocalDateTime)
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 09:14:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 09:14:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761268484410236AF3AF(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T09:14:44.410304700(LocalDateTime), 2025-10-24T09:14:44.411301600(LocalDateTime)
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 09:14:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761268484410236AF3AF
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 17(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 09:14:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 17, 订单号: ORD1761268484410236AF3AF
2025-10-24 09:14:44 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761268484410236AF3AF
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=17, orderNo=ORD1761268484410236AF3AF, us (truncated)...]
2025-10-24 09:14:44 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:15:32 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/17/pay", parameters={}
2025-10-24 09:15:32 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 09:15:32 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 09:15:32 [http-nio-8080-exec-2] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 17, 支付方式: ALIPAY
2025-10-24 09:15:33 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 17, 支付方式: ALIPAY
2025-10-24 09:15:33 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 09:15:33 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 17(Long)
2025-10-24 09:15:33 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 09:15:34 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 17, 支付方式: ALIPAY
2025-10-24 09:15:34 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 17
2025-10-24 09:15:34 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.AlipayService - 创建支付宝支付订单，订单号: ORD1761268484410236AF3AF, 金额: 0.6
2025-10-24 09:15:35 [http-nio-8080-exec-2] ERROR c.jiaoyi.controller.OrderController - 支付处理失败
java.lang.RuntimeException: com.alipay.api.AlipayApiException: RSA2签名遭遇异常，请检查私钥格式是否正确。java.security.InvalidKeyException: Unable to decode key content=alipay_sdk=alipay-sdk-java-4.38.10.ALL&app_id=9021000136671234&biz_content={"body":"订单支付：ORD1761268484410236AF3AF","out_trade_no":"PAY1761268534086DEA41D28","subject":"订单支付：ORD1761268484410236AF3AF","timeout_express":"30m","total_amount":"0.6"}&charset=UTF-8&format=JSON&method=alipay.trade.precreate&notify_url=http://localhost:8080/api/payment/alipay/notify&sign_type=RSA2&timestamp=2025-10-24 09:15:35&version=1.0，charset=UTF-8，privateKeySize=64
	at com.alipay.api.DefaultSigner.sign(DefaultSigner.java:25)
	at com.alipay.api.AbstractAlipayClient.getRequestHolderWithSign(AbstractAlipayClient.java:836)
	at com.alipay.api.AbstractAlipayClient.doPost(AbstractAlipayClient.java:982)
	at com.alipay.api.AbstractAlipayClient._execute(AbstractAlipayClient.java:921)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:395)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:377)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:372)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:366)
	at com.jiaoyi.service.AlipayService.createPayment(AlipayService.java:61)
	at com.jiaoyi.service.PaymentService.callAlipayPayment(PaymentService.java:95)
	at com.jiaoyi.service.PaymentService.callThirdPartyPayment(PaymentService.java:75)
	at com.jiaoyi.service.PaymentService.processPayment(PaymentService.java:55)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:352)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:385)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.jiaoyi.service.PaymentService$$SpringCGLIB$$0.processPayment(<generated>)
	at com.jiaoyi.controller.OrderController.payOrder(OrderController.java:159)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:352)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:174)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.jiaoyi.controller.OrderController$$SpringCGLIB$$0.payOrder(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: com.alipay.api.AlipayApiException: RSA2签名遭遇异常，请检查私钥格式是否正确。java.security.InvalidKeyException: Unable to decode key content=alipay_sdk=alipay-sdk-java-4.38.10.ALL&app_id=9021000136671234&biz_content={"body":"订单支付：ORD1761268484410236AF3AF","out_trade_no":"PAY1761268534086DEA41D28","subject":"订单支付：ORD1761268484410236AF3AF","timeout_express":"30m","total_amount":"0.6"}&charset=UTF-8&format=JSON&method=alipay.trade.precreate&notify_url=http://localhost:8080/api/payment/alipay/notify&sign_type=RSA2&timestamp=2025-10-24 09:15:35&version=1.0，charset=UTF-8，privateKeySize=64
	at com.alipay.api.internal.util.asymmetric.BaseAsymmetricEncryptor.sign(BaseAsymmetricEncryptor.java:86)
	at com.alipay.api.internal.util.AlipaySignature.rsaSign(AlipaySignature.java:422)
	at com.alipay.api.DefaultSigner.sign(DefaultSigner.java:23)
	... 85 common frames omitted
Caused by: java.security.spec.InvalidKeySpecException: java.security.InvalidKeyException: Unable to decode key
	at java.base/sun.security.rsa.RSAKeyFactory.engineGeneratePrivate(RSAKeyFactory.java:253)
	at java.base/java.security.KeyFactory.generatePrivate(KeyFactory.java:389)
	at com.alipay.api.internal.util.asymmetric.RSAEncryptor.getPrivateKeyFromPKCS8(RSAEncryptor.java:162)
	at com.alipay.api.internal.util.asymmetric.RSAEncryptor.doSign(RSAEncryptor.java:115)
	at com.alipay.api.internal.util.asymmetric.BaseAsymmetricEncryptor.sign(BaseAsymmetricEncryptor.java:75)
	... 87 common frames omitted
Caused by: java.security.InvalidKeyException: Unable to decode key
	at java.base/sun.security.pkcs.PKCS8Key.<init>(PKCS8Key.java:98)
	at java.base/sun.security.rsa.RSAPrivateCrtKeyImpl.<init>(RSAPrivateCrtKeyImpl.java:162)
	at java.base/sun.security.rsa.RSAPrivateCrtKeyImpl.newKey(RSAPrivateCrtKeyImpl.java:92)
	at java.base/sun.security.rsa.RSAKeyFactory.generatePrivate(RSAKeyFactory.java:348)
	at java.base/sun.security.rsa.RSAKeyFactory.engineGeneratePrivate(RSAKeyFactory.java:249)
	... 91 common frames omitted
Caused by: java.io.EOFException: not enough content
	at java.base/sun.security.util.DerValue.<init>(DerValue.java:429)
	at java.base/sun.security.util.DerValue.<init>(DerValue.java:344)
	at java.base/sun.security.pkcs.PKCS8Key.<init>(PKCS8Key.java:96)
	... 95 common frames omitted
2025-10-24 09:15:35 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:15:35 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=500, message=支付处理失败: com.alipay.api.AlipayApiException: RSA2签名遭遇异常，请检查私钥格式是否正确。java (truncated)...]
2025-10-24 09:15:35 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:17:28 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 09:17:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 09:17:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 09:17:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 09:17:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 09:17:28 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 09:17:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:17:28 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 09:17:28 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 09:17:28 [http-nio-8080-exec-7] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 09:17:28 [http-nio-8080-exec-7] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 09:17:28 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 09:17:30 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 09:17:30 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 09:17:30 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 09:17:30 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 09:17:30 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555555(Integer), 555555555(Integer), 110(Integer), 120(Integer), 下单锁定库存(String), 2025-10-24T09:17:30.051478300(LocalDateTime)
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 09:17:30 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 09:17:30 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612686500522CB70C57(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T09:17:30.052474600(LocalDateTime), 2025-10-24T09:17:30.052474600(LocalDateTime)
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 09:17:30 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612686500522CB70C57
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 18(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 09:17:30 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 18, 订单号: ORD17612686500522CB70C57
2025-10-24 09:17:30 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612686500522CB70C57
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=18, orderNo=ORD17612686500522CB70C57, us (truncated)...]
2025-10-24 09:17:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:18:40 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/18/pay", parameters={}
2025-10-24 09:18:40 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 09:18:40 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 09:18:40 [http-nio-8080-exec-8] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 18, 支付方式: ALIPAY
2025-10-24 09:18:40 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 18, 支付方式: ALIPAY
2025-10-24 09:18:40 [http-nio-8080-exec-8] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 09:18:40 [http-nio-8080-exec-8] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 18(Long)
2025-10-24 09:18:40 [http-nio-8080-exec-8] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 09:18:40 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 18, 支付方式: ALIPAY
2025-10-24 09:18:40 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 18
2025-10-24 09:18:40 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.AlipayService - 创建支付宝支付订单，订单号: ORD17612686500522CB70C57, 金额: 0.6
2025-10-24 09:18:40 [http-nio-8080-exec-8] ERROR c.jiaoyi.controller.OrderController - 支付处理失败
java.lang.RuntimeException: com.alipay.api.AlipayApiException: RSA2签名遭遇异常，请检查私钥格式是否正确。java.security.InvalidKeyException: Unable to decode key content=alipay_sdk=alipay-sdk-java-4.38.10.ALL&app_id=9021000136671234&biz_content={"body":"订单支付：ORD17612686500522CB70C57","out_trade_no":"PAY176126872027655B7A759","subject":"订单支付：ORD17612686500522CB70C57","timeout_express":"30m","total_amount":"0.6"}&charset=UTF-8&format=JSON&method=alipay.trade.precreate&notify_url=http://localhost:8080/api/payment/alipay/notify&sign_type=RSA2&timestamp=2025-10-24 09:18:40&version=1.0，charset=UTF-8，privateKeySize=64
	at com.alipay.api.DefaultSigner.sign(DefaultSigner.java:25)
	at com.alipay.api.AbstractAlipayClient.getRequestHolderWithSign(AbstractAlipayClient.java:836)
	at com.alipay.api.AbstractAlipayClient.doPost(AbstractAlipayClient.java:982)
	at com.alipay.api.AbstractAlipayClient._execute(AbstractAlipayClient.java:921)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:395)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:377)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:372)
	at com.alipay.api.AbstractAlipayClient.execute(AbstractAlipayClient.java:366)
	at com.jiaoyi.service.AlipayService.createPayment(AlipayService.java:61)
	at com.jiaoyi.service.PaymentService.callAlipayPayment(PaymentService.java:95)
	at com.jiaoyi.service.PaymentService.callThirdPartyPayment(PaymentService.java:75)
	at com.jiaoyi.service.PaymentService.processPayment(PaymentService.java:55)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:352)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:385)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.jiaoyi.service.PaymentService$$SpringCGLIB$$0.processPayment(<generated>)
	at com.jiaoyi.controller.OrderController.payOrder(OrderController.java:159)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:352)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:174)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.jiaoyi.controller.OrderController$$SpringCGLIB$$0.payOrder(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: com.alipay.api.AlipayApiException: RSA2签名遭遇异常，请检查私钥格式是否正确。java.security.InvalidKeyException: Unable to decode key content=alipay_sdk=alipay-sdk-java-4.38.10.ALL&app_id=9021000136671234&biz_content={"body":"订单支付：ORD17612686500522CB70C57","out_trade_no":"PAY176126872027655B7A759","subject":"订单支付：ORD17612686500522CB70C57","timeout_express":"30m","total_amount":"0.6"}&charset=UTF-8&format=JSON&method=alipay.trade.precreate&notify_url=http://localhost:8080/api/payment/alipay/notify&sign_type=RSA2&timestamp=2025-10-24 09:18:40&version=1.0，charset=UTF-8，privateKeySize=64
	at com.alipay.api.internal.util.asymmetric.BaseAsymmetricEncryptor.sign(BaseAsymmetricEncryptor.java:86)
	at com.alipay.api.internal.util.AlipaySignature.rsaSign(AlipaySignature.java:422)
	at com.alipay.api.DefaultSigner.sign(DefaultSigner.java:23)
	... 85 common frames omitted
Caused by: java.security.spec.InvalidKeySpecException: java.security.InvalidKeyException: Unable to decode key
	at java.base/sun.security.rsa.RSAKeyFactory.engineGeneratePrivate(RSAKeyFactory.java:253)
	at java.base/java.security.KeyFactory.generatePrivate(KeyFactory.java:389)
	at com.alipay.api.internal.util.asymmetric.RSAEncryptor.getPrivateKeyFromPKCS8(RSAEncryptor.java:162)
	at com.alipay.api.internal.util.asymmetric.RSAEncryptor.doSign(RSAEncryptor.java:115)
	at com.alipay.api.internal.util.asymmetric.BaseAsymmetricEncryptor.sign(BaseAsymmetricEncryptor.java:75)
	... 87 common frames omitted
Caused by: java.security.InvalidKeyException: Unable to decode key
	at java.base/sun.security.pkcs.PKCS8Key.<init>(PKCS8Key.java:98)
	at java.base/sun.security.rsa.RSAPrivateCrtKeyImpl.<init>(RSAPrivateCrtKeyImpl.java:162)
	at java.base/sun.security.rsa.RSAPrivateCrtKeyImpl.newKey(RSAPrivateCrtKeyImpl.java:92)
	at java.base/sun.security.rsa.RSAKeyFactory.generatePrivate(RSAKeyFactory.java:348)
	at java.base/sun.security.rsa.RSAKeyFactory.engineGeneratePrivate(RSAKeyFactory.java:249)
	... 91 common frames omitted
Caused by: java.io.EOFException: not enough content
	at java.base/sun.security.util.DerValue.<init>(DerValue.java:429)
	at java.base/sun.security.util.DerValue.<init>(DerValue.java:344)
	at java.base/sun.security.pkcs.PKCS8Key.<init>(PKCS8Key.java:96)
	... 95 common frames omitted
2025-10-24 09:18:40 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:18:40 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=500, message=支付处理失败: com.alipay.api.AlipayApiException: RSA2签名遭遇异常，请检查私钥格式是否正确。java (truncated)...]
2025-10-24 09:18:40 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:30:18 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 18236 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 09:30:18 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 09:30:18 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 09:30:19 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 09:30:19 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 09:30:19 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 09:30:19 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 09:30:19 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 984 ms
2025-10-24 09:30:19 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 09:30:19 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 09:30:19 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 09:30:19 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 09:30:20 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 09:30:20 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 1.839 seconds (process running for 2.095)
2025-10-24 09:31:00 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 31488 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 09:31:00 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 09:31:00 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 09:31:01 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 09:31:01 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 09:31:01 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 09:31:01 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 09:31:01 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 681 ms
2025-10-24 09:31:01 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 09:31:01 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 09:31:01 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 09:31:01 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 09:31:01 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-10-24 09:31:01 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 09:31:01 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-10-24 09:31:11 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 38488 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 09:31:11 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 09:31:11 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 09:31:11 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 09:31:11 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 09:31:11 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 09:31:11 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 09:31:11 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 679 ms
2025-10-24 09:31:12 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 09:31:12 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 09:31:12 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 09:31:12 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 09:31:12 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-10-24 09:31:12 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 09:31:12 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-10-24 09:31:43 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 6272 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 09:31:43 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 09:31:43 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 09:31:44 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 09:31:44 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 09:31:44 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 09:31:44 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 09:31:44 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 629 ms
2025-10-24 09:31:44 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 09:31:44 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 09:31:44 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 09:31:44 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 09:31:44 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 09:31:44 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 1.367 seconds (process running for 1.821)
2025-10-24 09:31:49 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 09:31:49 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 09:31:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 09:31:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 09:31:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 09:31:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@54f91f10
2025-10-24 09:31:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@2dd4f115
2025-10-24 09:31:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 09:31:49 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-10-24 09:31:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment.html", parameters={}
2025-10-24 09:31:49 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:31:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:31:49 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 09:31:49 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:31:49 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 09:31:49 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 09:31:49 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 09:31:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 09:31:49 [http-nio-8080-exec-2] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 09:31:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 09:31:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 09:31:49 [http-nio-8080-exec-3] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 09:31:49 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 09:31:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:31:49 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 09:31:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 09:31:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 09:31:49 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 09:31:49 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 09:31:49 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2bc59c6
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555555(Integer), 555555555(Integer), 120(Integer), 130(Integer), 下单锁定库存(String), 2025-10-24T09:31:50.972819200(LocalDateTime)
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761269510979690BD8B8(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T09:31:50.982278700(LocalDateTime), 2025-10-24T09:31:50.982278700(LocalDateTime)
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761269510979690BD8B8
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 19(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 09:31:50 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 19, 订单号: ORD1761269510979690BD8B8
2025-10-24 09:31:50 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761269510979690BD8B8
2025-10-24 09:31:51 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:31:51 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=19, orderNo=ORD1761269510979690BD8B8, us (truncated)...]
2025-10-24 09:31:51 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:32:01 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/19/pay", parameters={}
2025-10-24 09:32:01 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 09:32:01 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 09:32:01 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 19, 支付方式: ALIPAY
2025-10-24 09:32:01 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 19, 支付方式: ALIPAY
2025-10-24 09:32:01 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 09:32:01 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 19(Long)
2025-10-24 09:32:01 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 09:32:01 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 19, 支付方式: ALIPAY
2025-10-24 09:32:01 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 19
2025-10-24 09:32:01 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD1761269510979690BD8B8, 金额: 0.6
2025-10-24 09:32:01 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY17612695210390A024B59, 二维码: alipay://pay?orderNo=ORD1761269510979690BD8B8&amount=0.6
2025-10-24 09:32:01 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 09:32:01 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY17612695210390A024B59, statu (truncated)...]
2025-10-24 09:32:01 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 09:51:34 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 29428 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 09:51:34 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 09:51:34 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 09:51:35 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 09:51:35 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 09:51:35 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 09:51:35 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 09:51:35 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 907 ms
2025-10-24 09:51:36 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'requestMappingHandlerMapping' defined in class path resource [org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration$EnableWebMvcConfiguration.class]: Ambiguous mapping. Cannot map 'paymentController' method 
com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
to {POST [/api/payment/alipay/notify]}: There is already 'paymentCallbackController' bean method
com.jiaoyi.controller.PaymentCallbackController#alipayNotify(HttpServletRequest) mapped.
2025-10-24 09:51:36 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-10-24 09:51:36 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 09:51:36 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'requestMappingHandlerMapping' defined in class path resource [org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration$EnableWebMvcConfiguration.class]: Ambiguous mapping. Cannot map 'paymentController' method 
com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
to {POST [/api/payment/alipay/notify]}: There is already 'paymentCallbackController' bean method
com.jiaoyi.controller.PaymentCallbackController#alipayNotify(HttpServletRequest) mapped.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1775)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:946)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.jiaoyi.JiaoyiApplication.main(JiaoyiApplication.java:15)
Caused by: java.lang.IllegalStateException: Ambiguous mapping. Cannot map 'paymentController' method 
com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
to {POST [/api/payment/alipay/notify]}: There is already 'paymentCallbackController' bean method
com.jiaoyi.controller.PaymentCallbackController#alipayNotify(HttpServletRequest) mapped.
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping$MappingRegistry.validateMethodMapping(AbstractHandlerMethodMapping.java:667)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping$MappingRegistry.register(AbstractHandlerMethodMapping.java:633)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.registerHandlerMethod(AbstractHandlerMethodMapping.java:331)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping.registerHandlerMethod(RequestMappingHandlerMapping.java:486)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping.registerHandlerMethod(RequestMappingHandlerMapping.java:79)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.lambda$detectHandlerMethods$2(AbstractHandlerMethodMapping.java:298)
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.detectHandlerMethods(AbstractHandlerMethodMapping.java:296)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.processCandidateBean(AbstractHandlerMethodMapping.java:265)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.initHandlerMethods(AbstractHandlerMethodMapping.java:224)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.afterPropertiesSet(AbstractHandlerMethodMapping.java:212)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping.afterPropertiesSet(RequestMappingHandlerMapping.java:233)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	... 16 common frames omitted
2025-10-24 09:59:31 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 09:59:31 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 09:59:35 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 25700 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 09:59:35 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 09:59:35 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 09:59:36 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 09:59:36 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 09:59:36 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 09:59:36 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 09:59:36 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1122 ms
2025-10-24 09:59:36 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'requestMappingHandlerMapping' defined in class path resource [org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration$EnableWebMvcConfiguration.class]: Ambiguous mapping. Cannot map 'paymentController' method 
com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
to {POST [/api/payment/alipay/notify]}: There is already 'paymentCallbackController' bean method
com.jiaoyi.controller.PaymentCallbackController#alipayNotify(HttpServletRequest) mapped.
2025-10-24 09:59:36 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-10-24 09:59:36 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 09:59:36 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'requestMappingHandlerMapping' defined in class path resource [org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration$EnableWebMvcConfiguration.class]: Ambiguous mapping. Cannot map 'paymentController' method 
com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
to {POST [/api/payment/alipay/notify]}: There is already 'paymentCallbackController' bean method
com.jiaoyi.controller.PaymentCallbackController#alipayNotify(HttpServletRequest) mapped.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1775)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:946)
	at org.springframework.context.support.AbstractApplicationContext.__refresh(AbstractApplicationContext.java:616)
	at org.springframework.context.support.AbstractApplicationContext.jrLockAndRefresh(AbstractApplicationContext.java:41002)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:42008)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.jiaoyi.JiaoyiApplication.main(JiaoyiApplication.java:15)
Caused by: java.lang.IllegalStateException: Ambiguous mapping. Cannot map 'paymentController' method 
com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
to {POST [/api/payment/alipay/notify]}: There is already 'paymentCallbackController' bean method
com.jiaoyi.controller.PaymentCallbackController#alipayNotify(HttpServletRequest) mapped.
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping$MappingRegistry.validateMethodMapping(AbstractHandlerMethodMapping.java:667)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping$MappingRegistry.register(AbstractHandlerMethodMapping.java:633)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.registerHandlerMethod(AbstractHandlerMethodMapping.java:331)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping.registerHandlerMethod(RequestMappingHandlerMapping.java:486)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping.registerHandlerMethod(RequestMappingHandlerMapping.java:79)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.lambda$detectHandlerMethods$2(AbstractHandlerMethodMapping.java:298)
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.detectHandlerMethods(AbstractHandlerMethodMapping.java:296)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.processCandidateBean(AbstractHandlerMethodMapping.java:265)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.initHandlerMethods(AbstractHandlerMethodMapping.java:224)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.afterPropertiesSet(AbstractHandlerMethodMapping.java:212)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping.afterPropertiesSet(RequestMappingHandlerMapping.java:233)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	... 18 common frames omitted
2025-10-24 10:01:49 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 32704 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 10:01:49 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 10:01:49 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 10:01:50 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 10:01:50 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 10:01:50 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 10:01:50 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 10:01:50 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 648 ms
2025-10-24 10:01:50 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 10:01:51 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 10:01:51 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 10:01:51 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 10:01:51 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 10:01:51 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 1.519 seconds (process running for 1.754)
2025-10-24 10:02:29 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 18712 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 10:02:29 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 10:02:29 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 10:02:30 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 10:02:30 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 10:02:30 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 10:02:30 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 10:02:30 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 744 ms
2025-10-24 10:02:30 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 10:02:30 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 10:02:30 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 10:02:30 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 10:02:31 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-10-24 10:02:31 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 10:02:31 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-10-24 10:02:48 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 31992 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 10:02:48 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 10:02:48 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 10:02:49 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 10:02:49 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 10:02:49 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 10:02:49 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 10:02:49 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 686 ms
2025-10-24 10:02:49 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 10:02:49 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 10:02:49 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 10:02:49 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 10:02:49 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 10:02:49 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 1.496 seconds (process running for 1.942)
2025-10-24 10:03:42 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 10:03:42 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 10:03:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 10:03:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 10:03:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 10:03:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@6fa4689b
2025-10-24 10:03:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@3643cc6d
2025-10-24 10:03:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 10:03:42 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-10-24 10:03:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment.html", parameters={}
2025-10-24 10:03:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:03:43 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 10:03:43 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 10:03:43 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:03:43 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:03:43 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:03:43 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:03:43 [http-nio-8080-exec-3] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:03:43 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:03:43 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:03:43 [http-nio-8080-exec-3] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:03:43 [http-nio-8080-exec-2] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:03:43 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:03:43 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:03:43 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:03:43 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:03:43 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:03:43 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 10:03:43 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:03:43 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@24b2dee2
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555555(Integer), 555555555(Integer), 130(Integer), 140(Integer), 下单锁定库存(String), 2025-10-24T10:03:44.756162700(LocalDateTime)
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761271424763E486E0F5(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T10:03:44.765132700(LocalDateTime), 2025-10-24T10:03:44.765132700(LocalDateTime)
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761271424763E486E0F5
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 20(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 20, 订单号: ORD1761271424763E486E0F5
2025-10-24 10:03:44 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761271424763E486E0F5
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=20, orderNo=ORD1761271424763E486E0F5, us (truncated)...]
2025-10-24 10:03:44 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:03:55 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/20/pay", parameters={}
2025-10-24 10:03:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 10:03:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 10:03:55 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 20, 支付方式: ALIPAY
2025-10-24 10:03:56 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 20, 支付方式: ALIPAY
2025-10-24 10:03:56 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 10:03:56 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 20(Long)
2025-10-24 10:03:56 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 10:04:00 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 20, 支付方式: ALIPAY
2025-10-24 10:04:00 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 20
2025-10-24 10:04:00 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD1761271424763E486E0F5, 金额: 0.6
2025-10-24 10:04:09 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY17612714384838FAD752D, 二维码: http://localhost:8080/payment-test.html?orderNo=ORD1761271424763E486E0F5&amount=0.6
2025-10-24 10:04:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:04:21 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY17612714384838FAD752D, statu (truncated)...]
2025-10-24 10:04:21 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:06:45 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/qr-test.html", parameters={}
2025-10-24 10:06:45 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:06:45 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:06:45 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:06:45 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:06:45 [http-nio-8080-exec-8] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:06:45 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:06:45 [http-nio-8080-exec-8] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:06:45 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:06:45 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:06:45 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:06:45 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:10:42 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 10:10:42 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 10:10:46 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 26424 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 10:10:46 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 10:10:46 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 10:10:48 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 10:10:48 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 10:10:48 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 10:10:48 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 10:10:48 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1137 ms
2025-10-24 10:10:48 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 10:10:48 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 10:10:48 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 10:10:48 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 10:10:49 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 10:10:49 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 2.6 seconds (process running for 3.933)
2025-10-24 10:11:30 [http-nio-8080-exec-4] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 10:11:30 [http-nio-8080-exec-4] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 10:11:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 10:11:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 10:11:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 10:11:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@374eddda
2025-10-24 10:11:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@517e054
2025-10-24 10:11:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 10:11:30 [http-nio-8080-exec-4] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-10-24 10:11:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment.html", parameters={}
2025-10-24 10:11:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:11:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:11:30 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:11:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:11:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:11:30 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 10:11:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:11:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:11:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:11:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:11:30 [http-nio-8080-exec-7] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:11:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:11:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:11:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:11:30 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:11:30 [http-nio-8080-exec-8] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:11:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:11:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:11:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 10:11:30 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1296fc8b
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555555(Integer), 555555555(Integer), 140(Integer), 150(Integer), 下单锁定库存(String), 2025-10-24T10:11:31.848544700(LocalDateTime)
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD176127189185707D54E31(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T10:11:31.859507900(LocalDateTime), 2025-10-24T10:11:31.859507900(LocalDateTime)
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD176127189185707D54E31
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 21(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 21, 订单号: ORD176127189185707D54E31
2025-10-24 10:11:31 [http-nio-8080-exec-9] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD176127189185707D54E31
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=21, orderNo=ORD176127189185707D54E31, us (truncated)...]
2025-10-24 10:11:31 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:11:33 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/21/pay", parameters={}
2025-10-24 10:11:33 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 10:11:33 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 10:11:33 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 21, 支付方式: ALIPAY
2025-10-24 10:11:35 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 21, 支付方式: ALIPAY
2025-10-24 10:11:35 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 10:11:35 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 21(Long)
2025-10-24 10:11:35 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 10:11:37 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 21, 支付方式: ALIPAY
2025-10-24 10:11:37 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 21
2025-10-24 10:11:37 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD176127189185707D54E31, 金额: 0.6
2025-10-24 10:11:37 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 生成的二维码内容: http://localhost:8080/payment-test.html?orderNo=ORD176127189185707D54E31&amount=0.6
2025-10-24 10:11:37 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY17612718966734E355B9E, 二维码: http://localhost:8080/payment-test.html?orderNo=ORD176127189185707D54E31&amount=0.6
2025-10-24 10:11:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:11:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY17612718966734E355B9E, statu (truncated)...]
2025-10-24 10:11:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:11:48 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/payment-test.html?orderNo=ORD176127189185707D54E31&amount=0.6", parameters={masked}
2025-10-24 10:11:48 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:11:48 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:11:48 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:11:48 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:11:48 [http-nio-8080-exec-1] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:11:48 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:11:48 [http-nio-8080-exec-1] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:11:48 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:11:48 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:11:48 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:11:48 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:18:20 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 10:18:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:18:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:18:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:18:20 [http-nio-8080-exec-2] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:18:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:18:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:18:20 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 10:18:20 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:20:04 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 10:20:04 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 10:20:04 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 10:20:10 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = ORD176127189185707D54E31
2025-10-24 10:20:11 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 10:20:20 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 0.6
2025-10-24 10:20:21 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: trade_no = TEST1761272404874
2025-10-24 10:20:25 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: ORD176127189185707D54E31, 状态: TRADE_SUCCESS, 金额: 0.6, 支付宝交易号: TEST1761272404874
2025-10-24 10:20:36 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.PaymentService - 处理支付成功，支付流水号: ORD176127189185707D54E31, 第三方交易号: TEST1761272404874
2025-10-24 10:20:36 [http-nio-8080-exec-6] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id IN ( SELECT order_id FROM order_items WHERE payment_no = ? )
2025-10-24 10:20:36 [http-nio-8080-exec-6] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), ORD176127189185707D54E31(String)
2025-10-24 10:20:37 [http-nio-8080-exec-6] ERROR com.jiaoyi.service.PaymentService - 处理支付成功异常
org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 'payment_no' in 'where clause'
### The error may exist in file [D:\软件\ideaproject\jiaoyi\target\classes\mapper\OrderMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: UPDATE orders SET status = ?, update_time = NOW()          WHERE id IN (             SELECT order_id FROM order_items              WHERE payment_no = ?         )
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 'payment_no' in 'where clause'
; bad SQL grammar []
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:246)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at jdk.proxy2/jdk.proxy2.$Proxy74.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:141)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at jdk.proxy2/jdk.proxy2.$Proxy78.updateStatusByPaymentNo(Unknown Source)
	at com.jiaoyi.service.PaymentService.handlePaymentSuccess(PaymentService.java:164)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:352)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:713)
	at com.jiaoyi.service.PaymentService$$SpringCGLIB$$0.handlePaymentSuccess(<generated>)
	at com.jiaoyi.controller.PaymentController.alipayNotify(PaymentController.java:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'payment_no' in 'where clause'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:121)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:354)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:58)
	at jdk.proxy3/jdk.proxy3.$Proxy96.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 62 common frames omitted
2025-10-24 10:21:39 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m7s82ms236µs899ns).
2025-10-24 10:21:39 [http-nio-8080-exec-6] ERROR c.j.controller.PaymentController - 处理支付回调异常
java.lang.RuntimeException: 处理支付成功失败: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 'payment_no' in 'where clause'
### The error may exist in file [D:\软件\ideaproject\jiaoyi\target\classes\mapper\OrderMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: UPDATE orders SET status = ?, update_time = NOW()          WHERE id IN (             SELECT order_id FROM order_items              WHERE payment_no = ?         )
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 'payment_no' in 'where clause'
; bad SQL grammar []
	at com.jiaoyi.service.PaymentService.handlePaymentSuccess(PaymentService.java:169)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:352)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:713)
	at com.jiaoyi.service.PaymentService$$SpringCGLIB$$0.handlePaymentSuccess(<generated>)
	at com.jiaoyi.controller.PaymentController.alipayNotify(PaymentController.java:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:21:39 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 10:21:39 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["fail"]
2025-10-24 10:21:39 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:24:24 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 10:24:24 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 10:24:28 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 16212 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 10:24:28 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 10:24:28 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 10:24:29 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 10:24:29 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 10:24:29 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 10:24:29 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 10:24:29 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1244 ms
2025-10-24 10:24:30 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 10:24:30 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 10:24:30 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 10:24:30 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 10:24:30 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 10:24:30 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 2.767 seconds (process running for 4.089)
2025-10-24 10:24:47 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 10:24:47 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 10:24:47 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 10:24:47 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 10:24:47 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 10:24:47 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@4121e666
2025-10-24 10:24:47 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@5299c774
2025-10-24 10:24:47 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 10:24:47 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-10-24 10:24:47 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/payment-test.html?orderNo=ORD176127189185707D54E31&amount=0.6", parameters={masked}
2025-10-24 10:24:47 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:24:47 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 10:24:47 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 10:24:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:24:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:24:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:24:47 [http-nio-8080-exec-6] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:24:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:24:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:24:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 10:24:47 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:24:48 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:24:48 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:24:48 [http-nio-8080-exec-5] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:24:48 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:24:48 [http-nio-8080-exec-5] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:24:48 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:24:48 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:24:48 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:24:48 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:24:52 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment.html", parameters={}
2025-10-24 10:24:52 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:24:52 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 10:24:52 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 10:24:52 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:24:52 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:24:52 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:24:52 [http-nio-8080-exec-10] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:24:52 [http-nio-8080-exec-9] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:24:52 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:24:52 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:24:52 [http-nio-8080-exec-10] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:24:52 [http-nio-8080-exec-9] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:24:52 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:24:52 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:24:52 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:24:52 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:24:52 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:24:52 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:24:52 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 10:24:52 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:24:58 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 10:24:58 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 10:24:58 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 10:24:58 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 10:24:58 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 10:24:58 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@333db022
2025-10-24 10:24:58 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 10:24:58 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 10:24:58 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 10:24:58 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 10:24:58 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555555(Integer), 555555555(Integer), 150(Integer), 160(Integer), 下单锁定库存(String), 2025-10-24T10:24:59.118757(LocalDateTime)
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 10:24:59 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 10:24:59 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612726991346B51B13A(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T10:24:59.137694200(LocalDateTime), 2025-10-24T10:24:59.137694200(LocalDateTime)
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 10:24:59 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612726991346B51B13A
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 22(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 10:24:59 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 22, 订单号: ORD17612726991346B51B13A
2025-10-24 10:24:59 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612726991346B51B13A
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=22, orderNo=ORD17612726991346B51B13A, us (truncated)...]
2025-10-24 10:24:59 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:25:00 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/22/pay", parameters={}
2025-10-24 10:25:00 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 10:25:00 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 10:25:00 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 22, 支付方式: ALIPAY
2025-10-24 10:25:03 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 22, 支付方式: ALIPAY
2025-10-24 10:25:03 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 10:25:03 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 22(Long)
2025-10-24 10:25:03 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 10:25:05 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 22, 支付方式: ALIPAY
2025-10-24 10:25:05 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 22
2025-10-24 10:25:05 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD17612726991346B51B13A, 金额: 0.6
2025-10-24 10:25:06 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 生成的二维码内容: http://localhost:8080/payment-test.html?orderNo=ORD17612726991346B51B13A&amount=0.6
2025-10-24 10:25:06 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY1761272705262B33BF45B, 二维码: http://localhost:8080/payment-test.html?orderNo=ORD17612726991346B51B13A&amount=0.6
2025-10-24 10:25:06 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:25:06 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY1761272705262B33BF45B, statu (truncated)...]
2025-10-24 10:25:06 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:25:10 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/payment-test.html?orderNo=ORD17612726991346B51B13A&amount=0.6", parameters={masked}
2025-10-24 10:25:10 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:25:10 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:25:10 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:25:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:25:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:25:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:25:10 [http-nio-8080-exec-2] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:25:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:25:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:25:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:25:10 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:25:14 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 10:25:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 10:25:14 [http-nio-8080-exec-1] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 10:25:26 [http-nio-8080-exec-1] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = ORD17612726991346B51B13A
2025-10-24 10:25:26 [http-nio-8080-exec-1] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 10:25:26 [http-nio-8080-exec-1] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 0.6
2025-10-24 10:25:26 [http-nio-8080-exec-1] INFO  c.j.controller.PaymentController - 回调参数: trade_no = TEST1761272714343
2025-10-24 10:25:26 [http-nio-8080-exec-1] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: ORD17612726991346B51B13A, 状态: TRADE_SUCCESS, 金额: 0.6, 支付宝交易号: TEST1761272714343
2025-10-24 10:25:26 [http-nio-8080-exec-1] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE order_no = ?
2025-10-24 10:25:26 [http-nio-8080-exec-1] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), ORD17612726991346B51B13A(String)
2025-10-24 10:25:26 [http-nio-8080-exec-1] DEBUG c.j.m.O.updateStatusByPaymentNo - <==    Updates: 1
2025-10-24 10:25:27 [http-nio-8080-exec-1] INFO  c.j.controller.PaymentController - 支付成功处理完成，订单号: ORD17612726991346B51B13A
2025-10-24 10:25:27 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 10:25:27 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-24 10:25:27 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:34:40 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 10:34:40 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 10:34:44 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 20740 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 10:34:44 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 10:34:44 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 10:34:45 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 10:34:45 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 10:34:45 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 10:34:45 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 10:34:45 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1218 ms
2025-10-24 10:34:46 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 10:34:46 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 10:34:46 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 10:34:46 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 10:34:46 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 10:34:46 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 2.616 seconds (process running for 3.921)
2025-10-24 10:36:39 [http-nio-8080-exec-6] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 10:36:39 [http-nio-8080-exec-6] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@497c89ee
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@276cad97
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 10:36:39 [http-nio-8080-exec-6] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 10:36:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:36:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:36:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:36:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:36:39 [http-nio-8080-exec-1] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:36:39 [http-nio-8080-exec-6] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:36:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:36:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:36:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 10:36:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:36:39 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:36:40 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/static/test-payment.html", parameters={}
2025-10-24 10:36:40 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:36:40 [http-nio-8080-exec-10] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:36:40 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:36:40 [http-nio-8080-exec-10] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource static/test-payment.html.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:36:40 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7] and supported [application/json, application/*+json]
2025-10-24 10:36:40 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:36:40 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource static/test-payment.html.]
2025-10-24 10:36:40 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:36:40 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 10:36:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:36:40 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:36:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:36:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:36:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:36:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:36:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:36:40 [http-nio-8080-exec-7] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:36:40 [http-nio-8080-exec-3] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:36:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:36:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:36:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:36:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:36:40 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 10:36:40 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:36:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:36:40 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:37:53 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:37:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:37:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:37:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:37:53 [http-nio-8080-exec-8] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:37:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:37:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:37:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:37:53 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:37:53 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 10:37:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:37:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:37:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:37:53 [http-nio-8080-exec-9] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:37:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:37:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:37:53 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 10:37:53 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:37:55 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment.html", parameters={}
2025-10-24 10:37:55 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:37:55 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 10:37:55 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/.well-known/appspecific/com.chrome.devtools.json", parameters={}
2025-10-24 10:37:55 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:37:55 [http-nio-8080-exec-4] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:37:55 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:37:55 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:37:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:37:55 [http-nio-8080-exec-4] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:37:55 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:37:55 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:37:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:37:55 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.]
2025-10-24 10:37:55 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:37:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:37:55 [http-nio-8080-exec-5] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:37:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:37:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:37:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:37:55 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:37:58 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 10:37:58 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7caf27be
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555555(Integer), 555555555(Integer), 160(Integer), 170(Integer), 下单锁定库存(String), 2025-10-24T10:37:59.436163900(LocalDateTime)
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761273479447DF984F45(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T10:37:59.452250(LocalDateTime), 2025-10-24T10:37:59.452250(LocalDateTime)
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761273479447DF984F45
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 23(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 23, 订单号: ORD1761273479447DF984F45
2025-10-24 10:37:59 [http-nio-8080-exec-1] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761273479447DF984F45
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=23, orderNo=ORD1761273479447DF984F45, us (truncated)...]
2025-10-24 10:37:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:38:11 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/23/pay", parameters={}
2025-10-24 10:38:11 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 10:38:11 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 10:38:11 [http-nio-8080-exec-6] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 23, 支付方式: ALIPAY
2025-10-24 10:38:17 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 23, 支付方式: ALIPAY
2025-10-24 10:38:17 [http-nio-8080-exec-6] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 10:38:17 [http-nio-8080-exec-6] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 23(Long)
2025-10-24 10:38:17 [http-nio-8080-exec-6] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 10:38:17 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 23, 支付方式: ALIPAY
2025-10-24 10:38:17 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 23
2025-10-24 10:38:17 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD1761273479447DF984F45, 金额: 0.6
2025-10-24 10:38:17 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 生成的二维码内容: http://localhost:8080/payment-test.html?orderNo=ORD1761273479447DF984F45&amount=0.6
2025-10-24 10:38:17 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY1761273497629984E0B58, 二维码: http://localhost:8080/payment-test.html?orderNo=ORD1761273479447DF984F45&amount=0.6
2025-10-24 10:38:17 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 10:38:17 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY1761273497629984E0B58, statu (truncated)...]
2025-10-24 10:38:17 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:38:24 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/payment-test.html?orderNo=ORD1761273479447DF984F45&amount=0.6", parameters={masked}
2025-10-24 10:38:24 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:38:24 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:38:24 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:38:24 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:38:24 [http-nio-8080-exec-3] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:38:24 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:38:24 [http-nio-8080-exec-3] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:38:24 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:38:24 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:38:24 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:38:24 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:38:27 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 10:38:27 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 10:38:27 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 10:38:37 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = ORD1761273479447DF984F45
2025-10-24 10:38:37 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 10:38:37 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 0.6
2025-10-24 10:38:37 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: trade_no = TEST1761273507950
2025-10-24 10:38:37 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: ORD1761273479447DF984F45, 状态: TRADE_SUCCESS, 金额: 0.6, 支付宝交易号: TEST1761273507950
2025-10-24 10:38:37 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 开始处理支付成功回调，订单号: ORD1761273479447DF984F45
2025-10-24 10:38:39 [http-nio-8080-exec-7] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE order_no = ?
2025-10-24 10:38:39 [http-nio-8080-exec-7] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), ORD1761273479447DF984F45(String)
2025-10-24 10:38:39 [http-nio-8080-exec-7] DEBUG c.j.m.O.updateStatusByPaymentNo - <==    Updates: 1
2025-10-24 10:38:40 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 订单状态更新为已支付，订单号: ORD1761273479447DF984F45
2025-10-24 10:38:40 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 开始扣减库存，订单号: ORD1761273479447DF984F45
2025-10-24 10:38:46 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 根据订单号扣减库存，订单号: ORD1761273479447DF984F45
2025-10-24 10:38:48 [http-nio-8080-exec-7] DEBUG c.j.m.O.selectByOrderNo - ==>  Preparing: SELECT oi.* FROM order_items oi INNER JOIN orders o ON oi.order_id = o.id WHERE o.order_no = ?
2025-10-24 10:38:48 [http-nio-8080-exec-7] DEBUG c.j.m.O.selectByOrderNo - ==> Parameters: ORD1761273479447DF984F45(String)
2025-10-24 10:38:48 [http-nio-8080-exec-7] DEBUG c.j.m.O.selectByOrderNo - <==      Total: 1
2025-10-24 10:38:59 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 扣减库存，商品ID: 2002, 数量: 10, 订单ID: null
2025-10-24 10:39:00 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 10:39:00 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 10:39:00 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 10:39:03 [http-nio-8080-exec-7] DEBUG c.j.m.InventoryMapper.deductStock - ==>  Preparing: UPDATE inventory SET current_stock = current_stock - ?, locked_stock = locked_stock - ?, update_time = NOW() WHERE product_id = ? AND locked_stock >= ?
2025-10-24 10:39:03 [http-nio-8080-exec-7] DEBUG c.j.m.InventoryMapper.deductStock - ==> Parameters: 10(Integer), 10(Integer), 2002(Long), 10(Integer)
2025-10-24 10:39:03 [http-nio-8080-exec-7] DEBUG c.j.m.InventoryMapper.deductStock - <==    Updates: 1
2025-10-24 10:39:04 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 10:39:04 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, OUT(String), 10(Integer), 555555565(Integer), 555555555(Integer), 170(Integer), 160(Integer), 支付成功扣减库存(String), 2025-10-24T10:39:04.965318900(LocalDateTime)
2025-10-24 10:39:04 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 10:39:04 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 库存扣减成功，商品ID: 2002, 扣减数量: 10
2025-10-24 10:39:04 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 商品库存扣减成功，商品ID: 2002, 数量: 10
2025-10-24 10:39:04 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 订单库存扣减完成，订单号: ORD1761273479447DF984F45
2025-10-24 10:39:04 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 支付成功处理完成，订单号: ORD1761273479447DF984F45
2025-10-24 10:39:04 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 10:39:04 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-24 10:39:04 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:59:25 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/", parameters={}
2025-10-24 10:59:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:59:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:59:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:59:25 [http-nio-8080-exec-2] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:59:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7] and supported [application/json, application/*+json]
2025-10-24 10:59:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:59:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .]
2025-10-24 10:59:25 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:59:25 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:59:25 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:59:25 [http-nio-8080-exec-4] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:59:25 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:59:25 [http-nio-8080-exec-4] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:59:25 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:59:25 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:59:25 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:59:25 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 10:59:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 10:59:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 10:59:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 10:59:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 10:59:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 10:59:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 10:59:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:59:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 200
2025-10-24 10:59:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 10:59:37 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 10:59:37 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 10:59:37 [http-nio-8080-exec-1] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 10:59:37 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 10:59:37 [http-nio-8080-exec-1] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 10:59:37 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 10:59:37 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 10:59:37 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 10:59:37 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 11:08:24 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 11:08:24 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 11:08:33 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 2804 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 11:08:33 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 11:08:33 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 11:08:34 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 11:08:34 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 11:08:34 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 11:08:34 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 11:08:34 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1176 ms
2025-10-24 11:08:35 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 11:08:35 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 11:08:35 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 11:08:35 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 11:08:35 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 11:08:35 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 2.635 seconds (process running for 3.961)
2025-10-24 11:09:02 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 11:09:02 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@5327784a
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@4fc0fe13
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 11:09:02 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 11:09:02 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 11:09:03 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 11:09:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 11:09:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 11:09:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 11:09:03 [http-nio-8080-exec-6] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 11:09:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 11:09:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 11:09:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 11:09:03 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 11:09:04 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 11:09:04 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 11:09:04 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@11e51b29
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 160(Integer), 170(Integer), 下单锁定库存(String), 2025-10-24T11:09:05.251240400(LocalDateTime)
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761275345260918FE36D(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T11:09:05.262203600(LocalDateTime), 2025-10-24T11:09:05.262203600(LocalDateTime)
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761275345260918FE36D
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 24(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 24, 订单号: ORD1761275345260918FE36D
2025-10-24 11:09:05 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761275345260918FE36D
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=24, orderNo=ORD1761275345260918FE36D, us (truncated)...]
2025-10-24 11:09:05 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 11:09:07 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/24/pay", parameters={}
2025-10-24 11:09:07 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 11:09:07 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 11:09:07 [http-nio-8080-exec-9] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 24, 支付方式: ALIPAY
2025-10-24 11:09:09 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 24, 支付方式: ALIPAY
2025-10-24 11:09:09 [http-nio-8080-exec-9] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 11:09:09 [http-nio-8080-exec-9] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 24(Long)
2025-10-24 11:09:09 [http-nio-8080-exec-9] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 11:09:10 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 24, 支付方式: ALIPAY
2025-10-24 11:09:10 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 24
2025-10-24 11:09:10 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.AlipayService - 创建支付宝支付订单，订单号: ORD1761275345260918FE36D, 金额: 0.6
2025-10-24 11:09:11 [http-nio-8080-exec-9] INFO  sdk.biz.info - Summary^_^10000^_^null^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.precreate&sign=GXev2I9lTAIKXJ6gtao9Xl/JUkXIIqYFrHYmEMnSA6scIxv2i2qELAuRECmxxbYlWTPmvrhKO4R5BevSNUNm2PidfHNUVzL45q1teB0TjWrKjH6beD5hXWX2YxzXTf0+6LXc+zPJOM/y8xtfKSlJp+yUxyHV5wyviNlFnh5/k9r6AZAKNDrbfjMo2WjD3xpQtC4qtnSLjI+fC+gpponeO4qTXG5vi+Nx53hBDUc8A2Pk71Slotgkp47HFA5Mv34z8jzA2wxgmAiWI7ptJtn1tnW86+Py6KrGBsigDhH4+bUrUp0vt4g3GcDedlPrGJ511ubVnp8v7sCO5pFSjhAHEg==&return_url=https://dorotha-gloomful-elfrieda.ngrok-free.dev/api/payment/alipay/return&notify_url=https://dorotha-gloomful-elfrieda.ngrok-free.dev/api/payment/alipay/notify&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-24 11:09:10^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=JSON^_^ApplicationParams:biz_content={"body":"订单支付：ORD1761275345260918FE36D","out_trade_no":"PAY176127534946587B68C17","subject":"订单支付：ORD1761275345260918FE36D","timeout_express":"30m","total_amount":"0.6"}^_^31ms,1150ms,51ms^_^trace_id:060389ba176127535217630331954925
2025-10-24 11:09:11 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.AlipayService - 支付宝支付订单创建成功，支付流水号: PAY176127534946587B68C17, 二维码: https://qr.alipay.com/bax06708xeycxkmawfkt0006
2025-10-24 11:09:11 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 11:09:11 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY176127534946587B68C17, statu (truncated)...]
2025-10-24 11:09:11 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 11:11:59 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 11:11:59 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 11:11:59 [http-nio-8080-exec-4] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 11:11:59 [http-nio-8080-exec-4] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 11:11:59 [http-nio-8080-exec-4] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 11:11:59 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 11:11:59 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 11:11:59 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 200
2025-10-24 11:11:59 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 11:12:00 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 11:12:00 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 11:12:00 [http-nio-8080-exec-8] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 11:12:00 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 11:12:00 [http-nio-8080-exec-8] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 11:12:00 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 11:12:00 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 11:12:00 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 11:12:00 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 11:12:01 [http-nio-8080-exec-10] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 11:12:01 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 11:12:01 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 11:12:01 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 11:12:01 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 170(Integer), 180(Integer), 下单锁定库存(String), 2025-10-24T11:12:01.730544700(LocalDateTime)
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 11:12:01 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 11:12:01 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612755217329C17D73C(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T11:12:01.732539500(LocalDateTime), 2025-10-24T11:12:01.732539500(LocalDateTime)
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 11:12:01 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612755217329C17D73C
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 25(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 11:12:01 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 25, 订单号: ORD17612755217329C17D73C
2025-10-24 11:12:01 [http-nio-8080-exec-10] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612755217329C17D73C
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=25, orderNo=ORD17612755217329C17D73C, us (truncated)...]
2025-10-24 11:12:01 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 11:12:03 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/25/pay", parameters={}
2025-10-24 11:12:03 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 11:12:03 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 11:12:03 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 25, 支付方式: ALIPAY
2025-10-24 11:12:05 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 25, 支付方式: ALIPAY
2025-10-24 11:12:05 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 11:12:05 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 25(Long)
2025-10-24 11:12:05 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 11:12:15 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 25, 支付方式: ALIPAY
2025-10-24 11:12:19 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 25
2025-10-24 11:12:23 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 创建支付宝支付订单，订单号: ORD17612755217329C17D73C, 金额: 0.6
2025-10-24 11:12:36 [http-nio-8080-exec-5] INFO  sdk.biz.info - Summary^_^10000^_^null^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.precreate&sign=WS3xRdCslyoxHatF66GVFr/X8sqVvbV6Y78Wpo/4lupJ5xpTmHVQ1vvhIDzl0672/W0YOI0YKuKfo740unZ9pHyZM+F+qB26EX185ZvyyJoOM+LXZXG9U1Lg0NC+fcZtAvjUCMpTpZ4/ZWhqHGZqdSY6SFb3G1xedY8XRHt6uynZDHMriJSFsfwttry7nIfIvgOSqaaG39ha4pFrMc5OhWDQDLqhyXlGlxAKyp83fnKw5EnO6ZN+bA0ZP+Ey7SWNZIubOa+jvivIvrsrItkktrrxvejh4a2p9oh0gsU3GweIMl68vgbIhxx6bnQGGPJufMyskJZTgA7usEuTTwK1Fg==&return_url=https://dorotha-gloomful-elfrieda.ngrok-free.dev/api/payment/alipay/return&notify_url=https://dorotha-gloomful-elfrieda.ngrok-free.dev/api/payment/alipay/notify&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-24 11:12:35^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=JSON^_^ApplicationParams:biz_content={"body":"订单支付：ORD17612755217329C17D73C","out_trade_no":"PAY1761275533911ED14D507","subject":"订单支付：ORD17612755217329C17D73C","timeout_express":"30m","total_amount":"0.6"}^_^193ms,773ms,197ms^_^trace_id:06030329176127555718344441958422
2025-10-24 11:12:40 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 支付宝支付订单创建成功，支付流水号: PAY1761275533911ED14D507, 二维码: https://qr.alipay.com/bax06059ye6qrxnfsvw50097
2025-10-24 11:12:40 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 11:12:40 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY1761275533911ED14D507, statu (truncated)...]
2025-10-24 11:12:40 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 11:13:04 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/payment/query/PAY1761275533911ED14D507", parameters={}
2025-10-24 11:13:04 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#queryPayment(String)
2025-10-24 11:13:04 [http-nio-8080-exec-2] INFO  c.j.controller.PaymentController - 查询支付结果，支付流水号: PAY1761275533911ED14D507
2025-10-24 11:13:04 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.AlipayService - 查询支付宝支付结果，支付流水号: PAY1761275533911ED14D507
2025-10-24 11:13:05 [http-nio-8080-exec-2] ERROR sdk.biz.err - ErrorScene^_^40004^_^ACQ.TRADE_NOT_EXIST^_^null^_^Windows 10^_^2025-10-24 11:13:05^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.query&sign=SSZecx4UyZRgV76Arppyd14j7fbE1QMdnnc7jcQM1khaqLqmik5fSHwSQCDfGG3WPYTHbKj15IeoDxJ3V7CEqTfQ25saQkC1h/cs3VFA0BI8NRZCDcbJ3KvNfzyWomdNYEjnjR4mTNBqmGpwrLQpZHsT4Z+2A70Jgdeh5/j0pZvPg598y+M5PuZ1iaPowb5/X7kk3ElN5GaTPgIdLmMByuK7cnLbBYv2KF+oXEYlOMCwHoIoh5l4MybR46XRjeqkMIEx4c7qHKScd2CMLGegTN7Ex8W4kqdh2SECm2qgh06P0Rqad986E9WoMaGnL5/XUtxa378NsnSOne5mHyaFcA==&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-24 11:13:04^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=JSON^_^ApplicationParams:traceId=0601ac3e176127558651366094904&biz_content={"out_trade_no":"PAY1761275533911ED14D507"}^_^Body:{"alipay_trade_query_response":{"msg":"Business Failed","code":"40004","out_trade_no":"PAY1761275533911ED14D507","sub_msg":"交易不存在","sub_code":"ACQ.TRADE_NOT_EXIST","receipt_amount":"0.00","point_amount":"0.00","buyer_pay_amount":"0.00","invoice_amount":"0.00"},"sign":"biSWeQ7o3ufisXsvnsFOlirf7Xc6Fcft7ElAk1WC5ZowEHoYKhcjgQ7sAaERgLYkC/XabRXGNSoCP5cmmZpZ9l8AX1AGbMElgBItHdNXF4gifleOHQ5Nx4hs2CjsvdmRG9v0huAf4Fdes4dRUnHTxKWiWVaA6jUPqaM3dzzpcGr9AIvnx2gE42wmICtrqrUFa43dtX4f4Fsly4Ty7kwURCgd8WdWM1edJHkDhL9sgsgsWki6A0eMczPw1N2DUADy1YJ/qvfwVDOvVP+MybvygYsTSJSK6ycYtDMMxP/j7IvHyPCjJ5QlKDZ4X13r+MhCVDWJpx4tCnqyw5pNJdoO6w=="}^_^9ms,348ms,20ms^_^trace_id:0601ac3e176127558651366094904
2025-10-24 11:13:05 [http-nio-8080-exec-2] ERROR com.jiaoyi.service.AlipayService - 支付宝支付查询失败，支付流水号: PAY1761275533911ED14D507, 错误信息: Business Failed
2025-10-24 11:13:05 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 11:13:05 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=查询成功, data=PaymentResponse(paymentNo=PAY1761275533911ED14D507, status= (truncated)...]
2025-10-24 11:13:05 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 11:15:37 [http-nio-8080-exec-6] WARN  o.m.s.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.jiaoyi.mapper]' package. Please check your configuration.
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@5327784a
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@4fc0fe13
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 11:15:37 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 11:15:37 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 11:15:37 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 11:15:37 [http-nio-8080-exec-7] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 11:15:37 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 11:15:37 [http-nio-8080-exec-7] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 11:15:37 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 11:15:37 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 11:15:37 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 11:15:37 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 11:15:38 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 11:15:38 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 11:15:38 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 11:15:38 [http-nio-8080-exec-9] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 11:15:38 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 11:15:38 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 11:15:39 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 11:15:39 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 180(Integer), 190(Integer), 下单锁定库存(String), 2025-10-24T11:15:39.007738400(LocalDateTime)
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 11:15:39 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 11:15:39 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD176127573901094073DC4(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T11:15:39.014714700(LocalDateTime), 2025-10-24T11:15:39.014714700(LocalDateTime)
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 11:15:39 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD176127573901094073DC4
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 26(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 11:15:39 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 26, 订单号: ORD176127573901094073DC4
2025-10-24 11:15:39 [http-nio-8080-exec-9] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD176127573901094073DC4
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=26, orderNo=ORD176127573901094073DC4, us (truncated)...]
2025-10-24 11:15:39 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 11:15:42 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/26/pay", parameters={}
2025-10-24 11:15:42 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 11:15:42 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 11:15:42 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 26, 支付方式: ALIPAY
2025-10-24 11:15:43 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 26, 支付方式: ALIPAY
2025-10-24 11:15:43 [http-nio-8080-exec-3] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 11:15:43 [http-nio-8080-exec-3] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 26(Long)
2025-10-24 11:15:43 [http-nio-8080-exec-3] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 11:15:46 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 26, 支付方式: ALIPAY
2025-10-24 11:15:46 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 26
2025-10-24 11:15:46 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.AlipayService - 创建支付宝支付订单，订单号: ORD176127573901094073DC4, 金额: 0.6
2025-10-24 11:15:50 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.AlipayService - 开始调用支付宝预下单API，参数: outTradeNo=PAY17612757450462F97D3FD, totalAmount=0.6, subject=订单支付：ORD176127573901094073DC4
2025-10-24 11:15:53 [http-nio-8080-exec-3] INFO  sdk.biz.info - Summary^_^10000^_^null^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.precreate&sign=jKq4QV4OEE9VME4movWB580hgDzNgk6Et2VR7RPkAeAe6lzM1iuhdjEebnmULyeuD/gMW8wuiIMo4eoRnP+12qN6pFBB6a0jYF2ABtJwkkGrwgfsYTMhOWh93jFelxSnq7Gx1pnUBevvvRBDvu83HQp91h9VboWBTmwwbV32gI3DFGNKheDuFewSerDmUEPCHnmvh33p093y/QntGn5bwdRQK4kuqKoG/fwo9vIgq08zr+LG/QV9EmOEXM+3+oJ4ivQSwqQhhWO6rYklvQdySIL3w7CuCuuPwY1sqQWKfPDaUvVGQll+Nug5sOzev3iZSCwbhb4/lLZuEqneQwhHXQ==&return_url=https://dorotha-gloomful-elfrieda.ngrok-free.dev/api/payment/alipay/return&notify_url=https://dorotha-gloomful-elfrieda.ngrok-free.dev/api/payment/alipay/notify&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-24 11:15:51^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=JSON^_^ApplicationParams:biz_content={"body":"订单支付：ORD176127573901094073DC4","out_trade_no":"PAY17612757450462F97D3FD","subject":"订单支付：ORD176127573901094073DC4","timeout_express":"30m","total_amount":"0.6"}^_^298ms,832ms,227ms^_^trace_id:060389ba176127575421250761954925
2025-10-24 13:12:16 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h56m40s863ms152µs100ns).
2025-10-24 13:12:16 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.AlipayService - 支付宝API响应: isSuccess=true, code=10000, msg=Success, subCode=null, subMsg=null
2025-10-24 13:12:16 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.AlipayService - 支付宝支付订单创建成功，支付流水号: PAY17612757450462F97D3FD, 二维码: https://qr.alipay.com/bax08183sjkiuy7hhh5b0087
2025-10-24 13:12:20 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 36760 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:12:20 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:12:21 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:12:22 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:12:22 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:12:22 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:12:22 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:12:22 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1347 ms
2025-10-24 13:12:23 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 13:12:23 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 13:12:23 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 13:12:23 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 13:12:23 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 13:12:23 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 2.906 seconds (process running for 4.511)
2025-10-24 13:12:29 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 13:12:29 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@331272b1
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@601eb6d2
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 13:12:29 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 13:12:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 13:12:29 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:12:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:12:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:12:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:12:29 [http-nio-8080-exec-6] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:12:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:12:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:12:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:12:29 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@cb1bff
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 190(Integer), 200(Integer), 下单锁定库存(String), 2025-10-24T13:12:33.843870400(LocalDateTime)
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761282753861134E6C85(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:12:33.866432600(LocalDateTime), 2025-10-24T13:12:33.866432600(LocalDateTime)
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761282753861134E6C85
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 27(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 27, 订单号: ORD1761282753861134E6C85
2025-10-24 13:12:33 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761282753861134E6C85
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=27, orderNo=ORD1761282753861134E6C85, us (truncated)...]
2025-10-24 13:12:33 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:12:35 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/27/pay", parameters={}
2025-10-24 13:12:35 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:12:35 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:12:35 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 27, 支付方式: ALIPAY
2025-10-24 13:12:37 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 27, 支付方式: ALIPAY
2025-10-24 13:12:37 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:12:37 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 27(Long)
2025-10-24 13:12:37 [http-nio-8080-exec-5] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:12:37 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 27, 支付方式: ALIPAY
2025-10-24 13:12:37 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 27
2025-10-24 13:12:37 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD1761282753861134E6C85, 金额: 0.6
2025-10-24 13:12:37 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 生成的模拟二维码内容: http://localhost:8080/payment-test.html?orderNo=ORD1761282753861134E6C85&amount=0.6
2025-10-24 13:12:37 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY176128275743837BE10CD, 二维码: http://localhost:8080/payment-test.html?orderNo=ORD1761282753861134E6C85&amount=0.6
2025-10-24 13:12:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:12:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY176128275743837BE10CD, statu (truncated)...]
2025-10-24 13:12:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:12:49 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/payment/query/PAY176128275743837BE10CD", parameters={}
2025-10-24 13:12:49 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#queryPayment(String)
2025-10-24 13:12:49 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 查询支付结果，支付流水号: PAY176128275743837BE10CD
2025-10-24 13:12:49 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.AlipayService - 查询模拟支付宝支付结果，支付流水号: PAY176128275743837BE10CD
2025-10-24 13:12:49 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付查询成功，支付流水号: PAY176128275743837BE10CD
2025-10-24 13:12:49 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:12:49 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=查询成功, data=PaymentResponse(paymentNo=PAY176128275743837BE10CD, status= (truncated)...]
2025-10-24 13:12:49 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:18:14 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 13:18:14 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 13:18:18 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 22240 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:18:18 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:18:18 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:18:19 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:18:19 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:18:19 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:18:19 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:18:19 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1185 ms
2025-10-24 13:18:19 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 13:18:19 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 13:18:19 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 13:18:19 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 13:18:20 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 13:18:20 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 2.562 seconds (process running for 3.908)
2025-10-24 13:27:58 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 13:27:58 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 13:27:58 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 13:27:58 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 13:27:58 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 13:27:58 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@4ea89213
2025-10-24 13:27:58 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@1d681453
2025-10-24 13:27:58 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 13:27:58 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-10-24 13:27:58 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 13:27:59 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 13:27:59 [http-nio-8080-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 13:27:59 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 13:27:59 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 13:27:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 13:27:59 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:27:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 13:27:59 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 13:27:59 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:27:59 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:27:59 [http-nio-8080-exec-6] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:27:59 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:27:59 [http-nio-8080-exec-6] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:27:59 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:27:59 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:27:59 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:27:59 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4845af9c
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 200(Integer), 210(Integer), 下单锁定库存(String), 2025-10-24T13:28:00.569227500(LocalDateTime)
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612836805803E372E06(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:28:00.583185(LocalDateTime), 2025-10-24T13:28:00.583185(LocalDateTime)
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612836805803E372E06
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 28(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 28, 订单号: ORD17612836805803E372E06
2025-10-24 13:28:00 [http-nio-8080-exec-9] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612836805803E372E06
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=28, orderNo=ORD17612836805803E372E06, us (truncated)...]
2025-10-24 13:28:00 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:28:01 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/28/pay", parameters={}
2025-10-24 13:28:01 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:28:01 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:28:01 [http-nio-8080-exec-8] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 28, 支付方式: ALIPAY
2025-10-24 13:28:01 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 28, 支付方式: ALIPAY
2025-10-24 13:28:01 [http-nio-8080-exec-8] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:28:01 [http-nio-8080-exec-8] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 28(Long)
2025-10-24 13:28:01 [http-nio-8080-exec-8] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:28:01 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 28, 支付方式: ALIPAY
2025-10-24 13:28:01 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 28
2025-10-24 13:28:01 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD17612836805803E372E06, 金额: 0.6
2025-10-24 13:28:01 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.AlipayService - 生成的模拟二维码内容: http://localhost:8080/payment-simulate.html?orderNo=ORD17612836805803E372E06&amount=0.6&paymentNo=PAY1761283681720C61665AC
2025-10-24 13:28:01 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY1761283681720C61665AC, 二维码: http://localhost:8080/payment-simulate.html?orderNo=ORD17612836805803E372E06&amount=0.6&paymentNo=PAY1761283681720C61665AC
2025-10-24 13:28:01 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:28:01 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY1761283681720C61665AC, statu (truncated)...]
2025-10-24 13:28:01 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:28:06 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 13:28:06 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 13:28:09 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 42360 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:28:09 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:28:09 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:28:10 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:28:10 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:28:10 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:28:10 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:28:10 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1358 ms
2025-10-24 13:28:11 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 13:28:11 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 13:28:11 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 13:28:11 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 13:28:11 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 13:28:11 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 2.742 seconds (process running for 4.05)
2025-10-24 13:28:52 [rebel-change-detector-thread] WARN  o.m.s.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.jiaoyi.mapper]' package. Please check your configuration.
2025-10-24 13:29:25 [rebel-change-detector-thread] WARN  o.m.s.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.jiaoyi.mapper]' package. Please check your configuration.
2025-10-24 13:29:59 [rebel-change-detector-thread] WARN  o.m.s.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.jiaoyi.mapper]' package. Please check your configuration.
2025-10-24 13:32:40 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 35040 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:32:40 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:32:40 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:32:41 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:32:41 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:32:41 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:32:41 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:32:41 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1186 ms
2025-10-24 13:32:41 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'paymentController': Lookup method resolution failed
2025-10-24 13:32:41 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-10-24 13:32:41 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 13:32:41 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'paymentController': Lookup method resolution failed
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.checkLookupMethods(AutowiredAnnotationBeanPostProcessor.java:482)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstructorsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:1295)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1190)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:946)
	at org.springframework.context.support.AbstractApplicationContext.__refresh(AbstractApplicationContext.java:616)
	at org.springframework.context.support.AbstractApplicationContext.jrLockAndRefresh(AbstractApplicationContext.java:41002)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:42008)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.jiaoyi.JiaoyiApplication.main(JiaoyiApplication.java:15)
Caused by: java.lang.IllegalStateException: Failed to introspect Class [com.jiaoyi.controller.PaymentController] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@24273305]
	at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:483)
	at org.springframework.util.ReflectionUtils.doWithLocalMethods(ReflectionUtils.java:320)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.checkLookupMethods(AutowiredAnnotationBeanPostProcessor.java:460)
	... 21 common frames omitted
Caused by: java.lang.NoClassDefFoundError: InventoryService
	at java.base/java.lang.Class.getDeclaredMethods0(Native Method)
	at java.base/java.lang.Class.privateGetDeclaredMethods(Class.java:3578)
	at java.base/java.lang.Class.getDeclaredMethods(Class.java:2676)
	at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:465)
	... 23 common frames omitted
Caused by: java.lang.ClassNotFoundException: InventoryService
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:526)
	... 27 common frames omitted
2025-10-24 13:35:33 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 7828 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:35:33 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:35:33 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:35:33 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:35:33 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:35:33 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:35:33 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:35:33 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 762 ms
2025-10-24 13:35:34 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 13:35:34 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 13:35:34 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 13:35:34 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 13:35:34 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 13:35:34 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 1.672 seconds (process running for 2.345)
2025-10-24 13:35:42 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 13:35:42 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@7b5c6308
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@1ecf21f9
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 13:35:42 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:35:42 [http-nio-8080-exec-1] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:35:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@8c98a75
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 210(Integer), 220(Integer), 下单锁定库存(String), 2025-10-24T13:35:43.446062100(LocalDateTime)
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761284143453CB0BDD74(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:35:43.454035700(LocalDateTime), 2025-10-24T13:35:43.454035700(LocalDateTime)
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761284143453CB0BDD74
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 29(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 29, 订单号: ORD1761284143453CB0BDD74
2025-10-24 13:35:43 [http-nio-8080-exec-2] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761284143453CB0BDD74
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=29, orderNo=ORD1761284143453CB0BDD74, us (truncated)...]
2025-10-24 13:35:43 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:35:44 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/29/pay", parameters={}
2025-10-24 13:35:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:35:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:35:44 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 29, 支付方式: ALIPAY
2025-10-24 13:35:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 29, 支付方式: ALIPAY
2025-10-24 13:35:44 [http-nio-8080-exec-3] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:35:44 [http-nio-8080-exec-3] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 29(Long)
2025-10-24 13:35:44 [http-nio-8080-exec-3] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:35:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 29, 支付方式: ALIPAY
2025-10-24 13:35:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 29
2025-10-24 13:35:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD1761284143453CB0BDD74, 金额: 0.6
2025-10-24 13:35:44 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY176128414492742124D23
2025-10-24 13:35:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:35:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY176128414492742124D23, statu (truncated)...]
2025-10-24 13:35:44 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:36:27 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:36:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:36:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:36:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:36:27 [http-nio-8080-exec-4] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:36:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:36:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:36:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:36:27 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:36:28 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:36:28 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:36:28 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:36:28 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:36:28 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 220(Integer), 230(Integer), 下单锁定库存(String), 2025-10-24T13:36:28.482969900(LocalDateTime)
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:36:28 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:36:28 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761284188485C194E097(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:36:28.485959400(LocalDateTime), 2025-10-24T13:36:28.485959400(LocalDateTime)
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:36:28 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761284188485C194E097
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 30(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:36:28 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 30, 订单号: ORD1761284188485C194E097
2025-10-24 13:36:28 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761284188485C194E097
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=30, orderNo=ORD1761284188485C194E097, us (truncated)...]
2025-10-24 13:36:28 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:36:33 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/30/pay", parameters={}
2025-10-24 13:36:33 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:36:33 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:36:33 [http-nio-8080-exec-10] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 30, 支付方式: ALIPAY
2025-10-24 13:36:33 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 30, 支付方式: ALIPAY
2025-10-24 13:36:33 [http-nio-8080-exec-10] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:36:33 [http-nio-8080-exec-10] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 30(Long)
2025-10-24 13:36:33 [http-nio-8080-exec-10] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:36:33 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 30, 支付方式: ALIPAY
2025-10-24 13:36:33 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 30
2025-10-24 13:36:33 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD1761284188485C194E097, 金额: 0.6
2025-10-24 13:36:33 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY17612841933575A28A814
2025-10-24 13:36:33 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:36:33 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY17612841933575A28A814, statu (truncated)...]
2025-10-24 13:36:33 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:36:48 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/30/pay", parameters={}
2025-10-24 13:36:48 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:36:48 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:36:48 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 30, 支付方式: ALIPAY
2025-10-24 13:36:48 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 30, 支付方式: ALIPAY
2025-10-24 13:36:48 [http-nio-8080-exec-7] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:36:48 [http-nio-8080-exec-7] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 30(Long)
2025-10-24 13:36:48 [http-nio-8080-exec-7] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:36:48 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 30, 支付方式: ALIPAY
2025-10-24 13:36:48 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 30
2025-10-24 13:36:48 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD1761284188485C194E097, 金额: 0.6
2025-10-24 13:36:48 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY17612842084104F348838
2025-10-24 13:36:48 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:36:48 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY17612842084104F348838, statu (truncated)...]
2025-10-24 13:36:48 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:40:19 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:40:19 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:40:19 [http-nio-8080-exec-9] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:40:19 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:40:19 [http-nio-8080-exec-9] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:40:19 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:40:19 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:40:19 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:40:19 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:40:21 [http-nio-8080-exec-6] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:40:21 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:40:21 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:40:21 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:40:21 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 230(Integer), 240(Integer), 下单锁定库存(String), 2025-10-24T13:40:21.147008(LocalDateTime)
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:40:21 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:40:21 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612844211487C9C30E4(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:40:21.148001900(LocalDateTime), 2025-10-24T13:40:21.148001900(LocalDateTime)
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:40:21 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612844211487C9C30E4
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 31(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:40:21 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 31, 订单号: ORD17612844211487C9C30E4
2025-10-24 13:40:21 [http-nio-8080-exec-6] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612844211487C9C30E4
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=31, orderNo=ORD17612844211487C9C30E4, us (truncated)...]
2025-10-24 13:40:21 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:40:21 [http-nio-8080-exec-1] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:40:21 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:40:21 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:40:21 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:40:21 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 240(Integer), 250(Integer), 下单锁定库存(String), 2025-10-24T13:40:21.395219500(LocalDateTime)
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:40:21 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:40:21 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761284421398FC47395C(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:40:21.398210(LocalDateTime), 2025-10-24T13:40:21.398210(LocalDateTime)
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:40:21 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761284421398FC47395C
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 32(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:40:21 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 32, 订单号: ORD1761284421398FC47395C
2025-10-24 13:40:21 [http-nio-8080-exec-1] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761284421398FC47395C
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=32, orderNo=ORD1761284421398FC47395C, us (truncated)...]
2025-10-24 13:40:21 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:40:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/32/pay", parameters={}
2025-10-24 13:40:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:40:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:40:23 [http-nio-8080-exec-2] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 32, 支付方式: ALIPAY
2025-10-24 13:40:23 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 32, 支付方式: ALIPAY
2025-10-24 13:40:23 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:40:23 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 32(Long)
2025-10-24 13:40:23 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:40:23 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 32, 支付方式: ALIPAY
2025-10-24 13:40:23 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 32
2025-10-24 13:40:23 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD1761284421398FC47395C, 金额: 0.6
2025-10-24 13:40:23 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY1761284423354A4C4FE67
2025-10-24 13:40:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:40:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY1761284423354A4C4FE67, statu (truncated)...]
2025-10-24 13:40:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:41:44 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 30632 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:41:44 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:41:44 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:41:45 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:41:45 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:41:45 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:41:45 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:41:45 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 607 ms
2025-10-24 13:41:45 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 13:41:45 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 13:41:45 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 13:41:45 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 13:41:45 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-10-24 13:41:45 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 13:41:45 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-10-24 13:42:09 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 13:42:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 13:42:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 13:42:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 13:42:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 13:42:09 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 13:42:09 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:42:09 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 200
2025-10-24 13:42:09 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:42:09 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:42:09 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:42:09 [http-nio-8080-exec-5] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:42:09 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:42:09 [http-nio-8080-exec-5] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:42:09 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:42:09 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:42:09 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:42:09 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:42:11 [http-nio-8080-exec-10] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:42:11 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:42:11 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:42:11 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:42:11 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 250(Integer), 260(Integer), 下单锁定库存(String), 2025-10-24T13:42:11.599375700(LocalDateTime)
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:42:11 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:42:11 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612845316007BCED628(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:42:11.600372200(LocalDateTime), 2025-10-24T13:42:11.600372200(LocalDateTime)
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:42:11 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612845316007BCED628
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 33(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:42:11 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 33, 订单号: ORD17612845316007BCED628
2025-10-24 13:42:11 [http-nio-8080-exec-10] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612845316007BCED628
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=33, orderNo=ORD17612845316007BCED628, us (truncated)...]
2025-10-24 13:42:11 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:42:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/33/pay", parameters={}
2025-10-24 13:42:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:42:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:42:12 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 33, 支付方式: ALIPAY
2025-10-24 13:42:12 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 33, 支付方式: ALIPAY
2025-10-24 13:42:12 [http-nio-8080-exec-7] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:42:12 [http-nio-8080-exec-7] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 33(Long)
2025-10-24 13:42:12 [http-nio-8080-exec-7] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:42:12 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 33, 支付方式: ALIPAY
2025-10-24 13:42:12 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 33
2025-10-24 13:42:12 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD17612845316007BCED628, 金额: 0.6
2025-10-24 13:42:12 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY176128453298754CB3381
2025-10-24 13:42:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:42:12 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY176128453298754CB3381, statu (truncated)...]
2025-10-24 13:42:12 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:42:14 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 13:42:14 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = PAY176128453298754CB3381
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 60
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 回调参数: trade_no = MOCK_SUCCESS_1761284534774
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 回调参数: seller_id = 2088102146216666
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 回调参数: app_id = 9021000157614744
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 回调参数: timestamp = 2025-10-24 05:42:14
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 回调参数: sign_type = RSA2
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 回调参数: sign = MOCKED_SIGNATURE
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: PAY176128453298754CB3381, 状态: TRADE_SUCCESS, 金额: 60, 支付宝交易号: MOCK_SUCCESS_1761284534774
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 开始处理支付成功回调，支付流水号: PAY176128453298754CB3381
2025-10-24 13:42:14 [http-nio-8080-exec-8] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE order_no = ?
2025-10-24 13:42:14 [http-nio-8080-exec-8] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), PAY176128453298754CB3381(String)
2025-10-24 13:42:14 [http-nio-8080-exec-8] DEBUG c.j.m.O.updateStatusByPaymentNo - <==    Updates: 0
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 订单状态更新为已支付，支付流水号: PAY176128453298754CB3381
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 开始扣减库存，支付流水号: PAY176128453298754CB3381
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.InventoryService - 根据订单号扣减库存，订单号: PAY176128453298754CB3381
2025-10-24 13:42:14 [http-nio-8080-exec-8] DEBUG c.j.m.O.selectByOrderNo - ==>  Preparing: SELECT oi.* FROM order_items oi INNER JOIN orders o ON oi.order_id = o.id WHERE o.order_no = ?
2025-10-24 13:42:14 [http-nio-8080-exec-8] DEBUG c.j.m.O.selectByOrderNo - ==> Parameters: PAY176128453298754CB3381(String)
2025-10-24 13:42:14 [http-nio-8080-exec-8] DEBUG c.j.m.O.selectByOrderNo - <==      Total: 0
2025-10-24 13:42:14 [http-nio-8080-exec-8] WARN  com.jiaoyi.service.InventoryService - 订单项不存在，订单号: PAY176128453298754CB3381
2025-10-24 13:42:14 [http-nio-8080-exec-8] INFO  c.j.controller.PaymentController - 支付成功处理完成，支付流水号: PAY176128453298754CB3381
2025-10-24 13:42:14 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 13:42:14 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-24 13:42:14 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:42:18 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 13:42:18 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 13:42:24 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 12596 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:42:24 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:42:24 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:42:25 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:42:25 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:42:25 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:42:25 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:42:25 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1146 ms
2025-10-24 13:42:26 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 13:42:26 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 13:42:26 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 13:42:26 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 13:42:26 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 13:42:26 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 2.586 seconds (process running for 4.056)
2025-10-24 13:42:28 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 13:42:28 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@3467db6a
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@33430818
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 13:42:28 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 200
2025-10-24 13:42:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:42:29 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:42:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:42:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:42:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:42:29 [http-nio-8080-exec-6] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:42:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:42:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:42:29 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:42:29 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3669856a
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 260(Integer), 270(Integer), 下单锁定库存(String), 2025-10-24T13:42:30.720272400(LocalDateTime)
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612845507320AB77ED6(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:42:30.734225800(LocalDateTime), 2025-10-24T13:42:30.734225800(LocalDateTime)
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612845507320AB77ED6
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 34(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 34, 订单号: ORD17612845507320AB77ED6
2025-10-24 13:42:30 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612845507320AB77ED6
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=34, orderNo=ORD17612845507320AB77ED6, us (truncated)...]
2025-10-24 13:42:30 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:42:32 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/34/pay", parameters={}
2025-10-24 13:42:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:42:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:42:32 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 34, 支付方式: ALIPAY
2025-10-24 13:42:32 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 34, 支付方式: ALIPAY
2025-10-24 13:42:32 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:42:32 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 34(Long)
2025-10-24 13:42:32 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:42:32 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 34, 支付方式: ALIPAY
2025-10-24 13:42:32 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 34
2025-10-24 13:42:32 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD17612845507320AB77ED6, 金额: 0.6
2025-10-24 13:42:32 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY1761284552228EE279177
2025-10-24 13:42:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:42:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY1761284552228EE279177, statu (truncated)...]
2025-10-24 13:42:32 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:42:33 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 13:42:33 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = PAY1761284552228EE279177
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 60
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 回调参数: trade_no = MOCK_SUCCESS_1761284553362
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 回调参数: seller_id = 2088102146216666
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 回调参数: app_id = 9021000157614744
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 回调参数: timestamp = 2025-10-24 05:42:33
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 回调参数: sign_type = RSA2
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 回调参数: sign = MOCKED_SIGNATURE
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: PAY1761284552228EE279177, 状态: TRADE_SUCCESS, 金额: 60, 支付宝交易号: MOCK_SUCCESS_1761284553362
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 开始处理支付成功回调，支付流水号: PAY1761284552228EE279177
2025-10-24 13:42:33 [http-nio-8080-exec-9] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE order_no = ?
2025-10-24 13:42:33 [http-nio-8080-exec-9] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), PAY1761284552228EE279177(String)
2025-10-24 13:42:33 [http-nio-8080-exec-9] DEBUG c.j.m.O.updateStatusByPaymentNo - <==    Updates: 0
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 订单状态更新为已支付，支付流水号: PAY1761284552228EE279177
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 开始扣减库存，支付流水号: PAY1761284552228EE279177
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 根据订单号扣减库存，订单号: PAY1761284552228EE279177
2025-10-24 13:42:33 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderNo - ==>  Preparing: SELECT oi.* FROM order_items oi INNER JOIN orders o ON oi.order_id = o.id WHERE o.order_no = ?
2025-10-24 13:42:33 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderNo - ==> Parameters: PAY1761284552228EE279177(String)
2025-10-24 13:42:33 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderNo - <==      Total: 0
2025-10-24 13:42:33 [http-nio-8080-exec-9] WARN  com.jiaoyi.service.InventoryService - 订单项不存在，订单号: PAY1761284552228EE279177
2025-10-24 13:42:33 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 支付成功处理完成，支付流水号: PAY1761284552228EE279177
2025-10-24 13:42:33 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 13:42:33 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-24 13:42:33 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:42:45 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 13:42:45 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = PAY1761284552228EE279177
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 60
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: trade_no = MOCK_SUCCESS_1761284565832
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: seller_id = 2088102146216666
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: app_id = 9021000157614744
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: timestamp = 2025-10-24 05:42:45
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: sign_type = RSA2
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: sign = MOCKED_SIGNATURE
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: PAY1761284552228EE279177, 状态: TRADE_SUCCESS, 金额: 60, 支付宝交易号: MOCK_SUCCESS_1761284565832
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 开始处理支付成功回调，支付流水号: PAY1761284552228EE279177
2025-10-24 13:42:45 [http-nio-8080-exec-10] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE order_no = ?
2025-10-24 13:42:45 [http-nio-8080-exec-10] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), PAY1761284552228EE279177(String)
2025-10-24 13:42:45 [http-nio-8080-exec-10] DEBUG c.j.m.O.updateStatusByPaymentNo - <==    Updates: 0
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 订单状态更新为已支付，支付流水号: PAY1761284552228EE279177
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 开始扣减库存，支付流水号: PAY1761284552228EE279177
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 根据订单号扣减库存，订单号: PAY1761284552228EE279177
2025-10-24 13:42:45 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderNo - ==>  Preparing: SELECT oi.* FROM order_items oi INNER JOIN orders o ON oi.order_id = o.id WHERE o.order_no = ?
2025-10-24 13:42:45 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderNo - ==> Parameters: PAY1761284552228EE279177(String)
2025-10-24 13:42:45 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderNo - <==      Total: 0
2025-10-24 13:42:45 [http-nio-8080-exec-10] WARN  com.jiaoyi.service.InventoryService - 订单项不存在，订单号: PAY1761284552228EE279177
2025-10-24 13:42:45 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 支付成功处理完成，支付流水号: PAY1761284552228EE279177
2025-10-24 13:42:45 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 13:42:45 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-24 13:42:45 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:43:07 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 13:43:07 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 13:43:07 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 13:43:14 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = PAY1761284552228EE279177
2025-10-24 13:43:14 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 13:43:14 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 60
2025-10-24 13:43:14 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 回调参数: trade_no = MOCK_SUCCESS_1761284587959
2025-10-24 13:43:14 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 回调参数: seller_id = 2088102146216666
2025-10-24 13:43:14 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 回调参数: app_id = 9021000157614744
2025-10-24 13:43:14 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 回调参数: timestamp = 2025-10-24 05:43:07
2025-10-24 13:43:14 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 回调参数: sign_type = RSA2
2025-10-24 13:43:14 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 回调参数: sign = MOCKED_SIGNATURE
2025-10-24 13:43:14 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: PAY1761284552228EE279177, 状态: TRADE_SUCCESS, 金额: 60, 支付宝交易号: MOCK_SUCCESS_1761284587959
2025-10-24 13:43:14 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 开始处理支付成功回调，支付流水号: PAY1761284552228EE279177
2025-10-24 13:43:17 [http-nio-8080-exec-3] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE order_no = ?
2025-10-24 13:43:17 [http-nio-8080-exec-3] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), PAY1761284552228EE279177(String)
2025-10-24 13:43:17 [http-nio-8080-exec-3] DEBUG c.j.m.O.updateStatusByPaymentNo - <==    Updates: 0
2025-10-24 13:43:18 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 订单状态更新为已支付，支付流水号: PAY1761284552228EE279177
2025-10-24 13:43:18 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 开始扣减库存，支付流水号: PAY1761284552228EE279177
2025-10-24 13:43:19 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 根据订单号扣减库存，订单号: PAY1761284552228EE279177
2025-10-24 13:43:21 [http-nio-8080-exec-3] DEBUG c.j.m.O.selectByOrderNo - ==>  Preparing: SELECT oi.* FROM order_items oi INNER JOIN orders o ON oi.order_id = o.id WHERE o.order_no = ?
2025-10-24 13:43:21 [http-nio-8080-exec-3] DEBUG c.j.m.O.selectByOrderNo - ==> Parameters: PAY1761284552228EE279177(String)
2025-10-24 13:43:21 [http-nio-8080-exec-3] DEBUG c.j.m.O.selectByOrderNo - <==      Total: 0
2025-10-24 13:43:24 [http-nio-8080-exec-3] WARN  com.jiaoyi.service.InventoryService - 订单项不存在，订单号: PAY1761284552228EE279177
2025-10-24 13:43:24 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 支付成功处理完成，支付流水号: PAY1761284552228EE279177
2025-10-24 13:43:24 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 13:43:24 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-24 13:43:24 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:43:31 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 13:43:31 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 13:43:31 [http-nio-8080-exec-8] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 13:43:31 [http-nio-8080-exec-8] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 13:43:31 [http-nio-8080-exec-8] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 13:43:31 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 13:43:31 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:43:31 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 13:43:31 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 13:43:31 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:43:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:43:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:43:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:43:31 [http-nio-8080-exec-2] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:43:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:43:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:43:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:43:31 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:43:34 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:43:34 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:43:34 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:43:34 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:43:34 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 270(Integer), 280(Integer), 下单锁定库存(String), 2025-10-24T13:43:34.333937700(LocalDateTime)
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:43:34 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:43:34 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612846143358BBC5450(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:43:34.335931400(LocalDateTime), 2025-10-24T13:43:34.335931400(LocalDateTime)
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:43:34 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612846143358BBC5450
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 35(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:43:34 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 35, 订单号: ORD17612846143358BBC5450
2025-10-24 13:43:34 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612846143358BBC5450
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=35, orderNo=ORD17612846143358BBC5450, us (truncated)...]
2025-10-24 13:43:34 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:44:31 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/35/pay", parameters={}
2025-10-24 13:44:31 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:44:31 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:44:31 [http-nio-8080-exec-6] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 35, 支付方式: ALIPAY
2025-10-24 13:44:35 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 35, 支付方式: ALIPAY
2025-10-24 13:44:35 [http-nio-8080-exec-6] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:44:35 [http-nio-8080-exec-6] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 35(Long)
2025-10-24 13:44:35 [http-nio-8080-exec-6] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:44:35 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 35, 支付方式: ALIPAY
2025-10-24 13:44:35 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 35
2025-10-24 13:44:35 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD17612846143358BBC5450, 金额: 0.6
2025-10-24 13:44:35 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY176128467585794146C17
2025-10-24 13:44:35 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:44:35 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY176128467585794146C17, statu (truncated)...]
2025-10-24 13:44:35 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:44:39 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 13:44:39 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 13:44:39 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 13:44:43 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = PAY176128467585794146C17
2025-10-24 13:44:43 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 13:44:43 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 60
2025-10-24 13:44:43 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: trade_no = MOCK_SUCCESS_1761284679434
2025-10-24 13:44:43 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: seller_id = 2088102146216666
2025-10-24 13:44:43 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: app_id = 9021000157614744
2025-10-24 13:44:43 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: timestamp = 2025-10-24 05:44:39
2025-10-24 13:44:43 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: sign_type = RSA2
2025-10-24 13:44:43 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 回调参数: sign = MOCKED_SIGNATURE
2025-10-24 13:44:43 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: PAY176128467585794146C17, 状态: TRADE_SUCCESS, 金额: 60, 支付宝交易号: MOCK_SUCCESS_1761284679434
2025-10-24 13:44:43 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 开始处理支付成功回调，支付流水号: PAY176128467585794146C17
2025-10-24 13:44:48 [http-nio-8080-exec-7] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE order_no = ?
2025-10-24 13:44:48 [http-nio-8080-exec-7] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), PAY176128467585794146C17(String)
2025-10-24 13:44:48 [http-nio-8080-exec-7] DEBUG c.j.m.O.updateStatusByPaymentNo - <==    Updates: 0
2025-10-24 13:44:49 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 订单状态更新为已支付，支付流水号: PAY176128467585794146C17
2025-10-24 13:44:49 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 开始扣减库存，支付流水号: PAY176128467585794146C17
2025-10-24 13:44:53 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 根据订单号扣减库存，订单号: PAY176128467585794146C17
2025-10-24 13:45:41 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m10s795ms160µs600ns).
2025-10-24 13:45:41 [http-nio-8080-exec-7] DEBUG c.j.m.O.selectByOrderNo - ==>  Preparing: SELECT oi.* FROM order_items oi INNER JOIN orders o ON oi.order_id = o.id WHERE o.order_no = ?
2025-10-24 13:45:41 [http-nio-8080-exec-7] DEBUG c.j.m.O.selectByOrderNo - ==> Parameters: PAY176128467585794146C17(String)
2025-10-24 13:45:41 [http-nio-8080-exec-7] DEBUG c.j.m.O.selectByOrderNo - <==      Total: 0
2025-10-24 13:45:41 [http-nio-8080-exec-7] WARN  com.jiaoyi.service.InventoryService - 订单项不存在，订单号: PAY176128467585794146C17
2025-10-24 13:45:41 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 支付成功处理完成，支付流水号: PAY176128467585794146C17
2025-10-24 13:45:41 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 13:45:41 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-24 13:45:41 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:46:44 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 29120 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:46:44 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:46:44 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:46:45 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:46:45 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:46:45 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:46:45 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:46:45 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 705 ms
2025-10-24 13:46:45 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 13:46:45 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 13:46:45 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 13:46:45 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 13:46:45 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 13:46:45 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 1.603 seconds (process running for 1.814)
2025-10-24 13:47:56 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 41084 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:47:56 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:47:56 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:47:57 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:47:57 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:47:57 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:47:57 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:47:57 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1152 ms
2025-10-24 13:47:58 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 13:47:58 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 13:47:58 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 13:47:58 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 13:47:58 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-10-24 13:47:58 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 13:47:58 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-10-24 13:48:57 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 36092 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:48:57 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:48:57 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:48:57 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:48:57 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:48:57 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:48:57 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:48:57 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 631 ms
2025-10-24 13:48:58 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 13:48:58 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 13:48:58 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 13:48:58 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 13:48:58 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 13:48:58 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 1.563 seconds (process running for 1.98)
2025-10-24 13:50:01 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 13:50:01 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@388ab2b6
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@3c6e5f2f
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 13:50:01 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 200
2025-10-24 13:50:01 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:50:02 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:50:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:50:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:50:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:50:02 [http-nio-8080-exec-3] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:50:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:50:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:50:02 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:50:02 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4a0431ea
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555545(Integer), 555555545(Integer), 280(Integer), 290(Integer), 下单锁定库存(String), 2025-10-24T13:50:03.482296100(LocalDateTime)
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761285003493096ED311(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:50:03.496250(LocalDateTime), 2025-10-24T13:50:03.496250(LocalDateTime)
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761285003493096ED311
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 36(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 36, 订单号: ORD1761285003493096ED311
2025-10-24 13:50:03 [http-nio-8080-exec-2] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761285003493096ED311
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=36, orderNo=ORD1761285003493096ED311, us (truncated)...]
2025-10-24 13:50:03 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:50:04 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/36/pay", parameters={}
2025-10-24 13:50:04 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:50:05 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:50:05 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 36, 支付方式: ALIPAY
2025-10-24 13:50:06 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 36, 支付方式: ALIPAY
2025-10-24 13:50:06 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:50:06 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 36(Long)
2025-10-24 13:50:06 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:50:06 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 36, 支付方式: ALIPAY
2025-10-24 13:50:06 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 36
2025-10-24 13:50:06 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD1761285003493096ED311, 金额: 0.6
2025-10-24 13:50:06 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY176128500670317100B80
2025-10-24 13:50:06 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:50:06 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY176128500670317100B80, statu (truncated)...]
2025-10-24 13:50:06 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:50:08 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 13:50:08 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 13:50:08 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = ORD1761285003493096ED311
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 60
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: trade_no = MOCK_SUCCESS_1761285008774
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: seller_id = 2088102146216666
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: app_id = 9021000157614744
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: timestamp = 2025-10-24 05:50:08
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: sign_type = RSA2
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: sign = MOCKED_SIGNATURE
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: ORD1761285003493096ED311, 状态: TRADE_SUCCESS, 金额: 60, 支付宝交易号: MOCK_SUCCESS_1761285008774
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 开始处理支付成功回调，支付流水号: ORD1761285003493096ED311
2025-10-24 13:50:11 [http-nio-8080-exec-5] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE order_no = ?
2025-10-24 13:50:11 [http-nio-8080-exec-5] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), ORD1761285003493096ED311(String)
2025-10-24 13:50:11 [http-nio-8080-exec-5] DEBUG c.j.m.O.updateStatusByPaymentNo - <==    Updates: 1
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 订单状态更新为已支付，订单号: ORD1761285003493096ED311
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 开始扣减库存，订单号: ORD1761285003493096ED311
2025-10-24 13:50:11 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 根据订单号扣减库存，订单号: ORD1761285003493096ED311
2025-10-24 13:50:13 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderNo - ==>  Preparing: SELECT oi.* FROM order_items oi INNER JOIN orders o ON oi.order_id = o.id WHERE o.order_no = ?
2025-10-24 13:50:13 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderNo - ==> Parameters: ORD1761285003493096ED311(String)
2025-10-24 13:50:13 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderNo - <==      Total: 1
2025-10-24 13:50:18 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 扣减库存，商品ID: 2002, 数量: 10, 订单ID: null
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG c.j.m.InventoryMapper.deductStock - ==>  Preparing: UPDATE inventory SET current_stock = current_stock - ?, locked_stock = locked_stock - ?, update_time = NOW() WHERE product_id = ? AND locked_stock >= ?
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG c.j.m.InventoryMapper.deductStock - ==> Parameters: 10(Integer), 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG c.j.m.InventoryMapper.deductStock - <==    Updates: 1
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, OUT(String), 10(Integer), 555555555(Integer), 555555545(Integer), 290(Integer), 280(Integer), 支付成功扣减库存(String), 2025-10-24T13:50:18.411041400(LocalDateTime)
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:50:18 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 库存扣减成功，商品ID: 2002, 扣减数量: 10
2025-10-24 13:50:18 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 商品库存扣减成功，商品ID: 2002, 数量: 10
2025-10-24 13:50:18 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 订单库存扣减完成，订单号: ORD1761285003493096ED311
2025-10-24 13:50:18 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 支付成功处理完成，订单号: ORD1761285003493096ED311
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-24 13:50:18 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:50:25 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 13:50:25 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 13:50:25 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = ORD1761285003493096ED311
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 60
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: trade_no = MOCK_SUCCESS_1761285025819
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: seller_id = 2088102146216666
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: app_id = 9021000157614744
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: timestamp = 2025-10-24 05:50:25
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: sign_type = RSA2
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: sign = MOCKED_SIGNATURE
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: ORD1761285003493096ED311, 状态: TRADE_SUCCESS, 金额: 60, 支付宝交易号: MOCK_SUCCESS_1761285025819
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 开始处理支付成功回调，支付流水号: ORD1761285003493096ED311
2025-10-24 13:50:26 [http-nio-8080-exec-6] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE order_no = ?
2025-10-24 13:50:26 [http-nio-8080-exec-6] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), ORD1761285003493096ED311(String)
2025-10-24 13:50:26 [http-nio-8080-exec-6] DEBUG c.j.m.O.updateStatusByPaymentNo - <==    Updates: 1
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 订单状态更新为已支付，订单号: ORD1761285003493096ED311
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 开始扣减库存，订单号: ORD1761285003493096ED311
2025-10-24 13:50:26 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 根据订单号扣减库存，订单号: ORD1761285003493096ED311
2025-10-24 13:50:28 [http-nio-8080-exec-6] DEBUG c.j.m.O.selectByOrderNo - ==>  Preparing: SELECT oi.* FROM order_items oi INNER JOIN orders o ON oi.order_id = o.id WHERE o.order_no = ?
2025-10-24 13:50:28 [http-nio-8080-exec-6] DEBUG c.j.m.O.selectByOrderNo - ==> Parameters: ORD1761285003493096ED311(String)
2025-10-24 13:50:28 [http-nio-8080-exec-6] DEBUG c.j.m.O.selectByOrderNo - <==      Total: 1
2025-10-24 13:50:32 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 扣减库存，商品ID: 2002, 数量: 10, 订单ID: null
2025-10-24 13:50:33 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:50:33 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:50:33 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:50:35 [http-nio-8080-exec-6] DEBUG c.j.m.InventoryMapper.deductStock - ==>  Preparing: UPDATE inventory SET current_stock = current_stock - ?, locked_stock = locked_stock - ?, update_time = NOW() WHERE product_id = ? AND locked_stock >= ?
2025-10-24 13:50:35 [http-nio-8080-exec-6] DEBUG c.j.m.InventoryMapper.deductStock - ==> Parameters: 10(Integer), 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:50:35 [http-nio-8080-exec-6] DEBUG c.j.m.InventoryMapper.deductStock - <==    Updates: 1
2025-10-24 13:50:40 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:50:40 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, OUT(String), 10(Integer), 555555545(Integer), 555555535(Integer), 280(Integer), 270(Integer), 支付成功扣减库存(String), 2025-10-24T13:50:40.193290700(LocalDateTime)
2025-10-24 13:50:40 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:50:40 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 库存扣减成功，商品ID: 2002, 扣减数量: 10
2025-10-24 13:50:42 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 商品库存扣减成功，商品ID: 2002, 数量: 10
2025-10-24 13:50:44 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 订单库存扣减完成，订单号: ORD1761285003493096ED311
2025-10-24 13:50:46 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 支付成功处理完成，订单号: ORD1761285003493096ED311
2025-10-24 13:50:49 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 13:50:49 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-24 13:50:49 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:52:24 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 27484 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:52:24 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:52:24 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:52:25 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:52:25 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:52:25 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:52:25 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:52:25 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 829 ms
2025-10-24 13:52:25 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 13:52:25 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 13:52:25 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 13:52:25 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 13:52:25 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-10-24 13:52:25 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 13:52:25 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-10-24 13:53:57 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 13:53:57 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 13:54:01 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 41312 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 13:54:01 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 13:54:01 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 13:54:01 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 13:54:01 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 13:54:01 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 13:54:02 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 13:54:02 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 752 ms
2025-10-24 13:54:02 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 13:54:02 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 13:54:02 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 13:54:02 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 13:54:02 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 13:54:02 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 1.54 seconds (process running for 1.991)
2025-10-24 13:54:57 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 13:54:57 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@33c0a207
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@127a888a
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 13:54:57 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 13:54:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 13:54:57 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:54:57 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:54:57 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:54:57 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:54:57 [http-nio-8080-exec-2] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:54:57 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:54:57 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:54:57 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:54:57 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@496fbedc
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555525(Integer), 555555525(Integer), 270(Integer), 280(Integer), 下单锁定库存(String), 2025-10-24T13:54:59.328068200(LocalDateTime)
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD176128529933450802DD7(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:54:59.335044800(LocalDateTime), 2025-10-24T13:54:59.335044800(LocalDateTime)
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD176128529933450802DD7
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 37(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 37, 订单号: ORD176128529933450802DD7
2025-10-24 13:54:59 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD176128529933450802DD7
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=37, orderNo=ORD176128529933450802DD7, us (truncated)...]
2025-10-24 13:54:59 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:55:00 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/37/pay", parameters={}
2025-10-24 13:55:00 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:55:00 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:55:00 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 37, 支付方式: ALIPAY
2025-10-24 13:55:00 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 37, 支付方式: ALIPAY
2025-10-24 13:55:00 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:55:00 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 37(Long)
2025-10-24 13:55:00 [http-nio-8080-exec-4] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:55:00 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 37, 支付方式: ALIPAY
2025-10-24 13:55:00 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 37
2025-10-24 13:55:00 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD176128529933450802DD7, 金额: 60
2025-10-24 13:55:00 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY1761285300453DBAD7A8F
2025-10-24 13:55:00 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:55:00 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY1761285300453DBAD7A8F, statu (truncated)...]
2025-10-24 13:55:00 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:55:01 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 13:55:01 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 13:55:01 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = ORD176128529933450802DD7
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 60
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: trade_no = MOCK_SUCCESS_1761285301929
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: seller_id = 2088102146216666
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: app_id = 9021000157614744
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: timestamp = 2025-10-24 05:55:01
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: sign_type = RSA2
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 回调参数: sign = MOCKED_SIGNATURE
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: ORD176128529933450802DD7, 状态: TRADE_SUCCESS, 金额: 60, 支付宝交易号: MOCK_SUCCESS_1761285301929
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 开始处理支付成功回调，支付流水号: ORD176128529933450802DD7
2025-10-24 13:55:03 [http-nio-8080-exec-5] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE order_no = ?
2025-10-24 13:55:03 [http-nio-8080-exec-5] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), ORD176128529933450802DD7(String)
2025-10-24 13:55:03 [http-nio-8080-exec-5] DEBUG c.j.m.O.updateStatusByPaymentNo - <==    Updates: 1
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 订单状态更新为已支付，订单号: ORD176128529933450802DD7
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 开始扣减库存，订单号: ORD176128529933450802DD7
2025-10-24 13:55:03 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 根据订单号扣减库存，订单号: ORD176128529933450802DD7
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderNo - ==>  Preparing: SELECT oi.* FROM order_items oi INNER JOIN orders o ON oi.order_id = o.id WHERE o.order_no = ?
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderNo - ==> Parameters: ORD176128529933450802DD7(String)
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderNo - <==      Total: 1
2025-10-24 13:55:04 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 扣减库存，商品ID: 2002, 数量: 10, 订单ID: null
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.InventoryMapper.deductStock - ==>  Preparing: UPDATE inventory SET current_stock = current_stock - ?, locked_stock = locked_stock - ?, update_time = NOW() WHERE product_id = ? AND locked_stock >= ?
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.InventoryMapper.deductStock - ==> Parameters: 10(Integer), 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.InventoryMapper.deductStock - <==    Updates: 1
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, OUT(String), 10(Integer), 555555535(Integer), 555555525(Integer), 280(Integer), 270(Integer), 支付成功扣减库存(String), 2025-10-24T13:55:04.136003500(LocalDateTime)
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:55:04 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 库存扣减成功，商品ID: 2002, 扣减数量: 10
2025-10-24 13:55:04 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 商品库存扣减成功，商品ID: 2002, 数量: 10
2025-10-24 13:55:04 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 订单库存扣减完成，订单号: ORD176128529933450802DD7
2025-10-24 13:55:04 [http-nio-8080-exec-5] INFO  c.j.controller.PaymentController - 支付成功处理完成，订单号: ORD176128529933450802DD7
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-24 13:55:04 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:55:07 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 13:55:07 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 13:55:07 [http-nio-8080-exec-6] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 13:55:07 [http-nio-8080-exec-6] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 13:55:07 [http-nio-8080-exec-6] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 13:55:07 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 13:55:07 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:55:07 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 13:55:07 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 13:55:07 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:55:07 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:55:07 [http-nio-8080-exec-7] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:55:07 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:55:07 [http-nio-8080-exec-7] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:55:07 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:55:07 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:55:07 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:55:07 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 13:55:30 [http-nio-8080-exec-8] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 13:55:30 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 13:55:30 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 13:55:30 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 13:55:30 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555515(Integer), 555555515(Integer), 270(Integer), 280(Integer), 下单锁定库存(String), 2025-10-24T13:55:30.820727800(LocalDateTime)
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:55:30 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 13:55:30 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612853308228F7A7C5B(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T13:55:30.822720400(LocalDateTime), 2025-10-24T13:55:30.822720400(LocalDateTime)
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 13:55:30 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612853308228F7A7C5B
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 38(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 13:55:30 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 38, 订单号: ORD17612853308228F7A7C5B
2025-10-24 13:55:30 [http-nio-8080-exec-8] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612853308228F7A7C5B
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=38, orderNo=ORD17612853308228F7A7C5B, us (truncated)...]
2025-10-24 13:55:30 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:55:34 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/38/pay", parameters={}
2025-10-24 13:55:34 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 13:55:34 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 13:55:34 [http-nio-8080-exec-9] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 38, 支付方式: ALIPAY
2025-10-24 13:55:34 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 38, 支付方式: ALIPAY
2025-10-24 13:55:34 [http-nio-8080-exec-9] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 13:55:34 [http-nio-8080-exec-9] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 38(Long)
2025-10-24 13:55:34 [http-nio-8080-exec-9] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 13:55:34 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 38, 支付方式: ALIPAY
2025-10-24 13:55:34 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 38
2025-10-24 13:55:34 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD17612853308228F7A7C5B, 金额: 60
2025-10-24 13:55:34 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY1761285334746E6624BEB
2025-10-24 13:55:34 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 13:55:34 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY1761285334746E6624BEB, statu (truncated)...]
2025-10-24 13:55:34 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:55:35 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-24 13:55:35 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-24 13:55:35 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = ORD17612853308228F7A7C5B
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 60
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: trade_no = MOCK_SUCCESS_1761285335814
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: seller_id = 2088102146216666
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: app_id = 9021000157614744
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: timestamp = 2025-10-24 05:55:35
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: sign_type = RSA2
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 回调参数: sign = MOCKED_SIGNATURE
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: ORD17612853308228F7A7C5B, 状态: TRADE_SUCCESS, 金额: 60, 支付宝交易号: MOCK_SUCCESS_1761285335814
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 开始处理支付成功回调，支付流水号: ORD17612853308228F7A7C5B
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.O.updateStatusByPaymentNo - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE order_no = ?
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.O.updateStatusByPaymentNo - ==> Parameters: PAID(String), ORD17612853308228F7A7C5B(String)
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.O.updateStatusByPaymentNo - <==    Updates: 1
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 订单状态更新为已支付，订单号: ORD17612853308228F7A7C5B
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 开始扣减库存，订单号: ORD17612853308228F7A7C5B
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 根据订单号扣减库存，订单号: ORD17612853308228F7A7C5B
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderNo - ==>  Preparing: SELECT oi.* FROM order_items oi INNER JOIN orders o ON oi.order_id = o.id WHERE o.order_no = ?
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderNo - ==> Parameters: ORD17612853308228F7A7C5B(String)
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderNo - <==      Total: 1
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 扣减库存，商品ID: 2002, 数量: 10, 订单ID: null
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.InventoryMapper.deductStock - ==>  Preparing: UPDATE inventory SET current_stock = current_stock - ?, locked_stock = locked_stock - ?, update_time = NOW() WHERE product_id = ? AND locked_stock >= ?
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.InventoryMapper.deductStock - ==> Parameters: 10(Integer), 10(Integer), 2002(Long), 10(Integer)
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.InventoryMapper.deductStock - <==    Updates: 1
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, OUT(String), 10(Integer), 555555525(Integer), 555555515(Integer), 280(Integer), 270(Integer), 支付成功扣减库存(String), 2025-10-24T13:55:38.524781(LocalDateTime)
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 库存扣减成功，商品ID: 2002, 扣减数量: 10
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 商品库存扣减成功，商品ID: 2002, 数量: 10
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 订单库存扣减完成，订单号: ORD17612853308228F7A7C5B
2025-10-24 13:55:38 [http-nio-8080-exec-10] INFO  c.j.controller.PaymentController - 支付成功处理完成，订单号: ORD17612853308228F7A7C5B
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-24 13:55:38 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 13:55:40 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 13:55:40 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 13:55:40 [http-nio-8080-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 13:55:40 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 13:55:40 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 13:55:40 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 13:55:40 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:55:40 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 13:55:40 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 13:55:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 13:55:40 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 13:55:40 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 13:55:40 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 13:55:40 [http-nio-8080-exec-2] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 13:55:40 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 13:55:40 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 13:55:40 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 13:55:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 14:39:42 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 14:39:42 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 14:39:48 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 29468 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 14:39:48 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 14:39:48 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 14:39:49 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-24 14:39:49 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-24 14:39:49 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 20 ms. Found 0 Redis repository interfaces.
2025-10-24 14:39:50 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 14:39:50 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 14:39:50 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 14:39:50 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 14:39:50 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1838 ms
2025-10-24 14:39:51 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'paymentController': Lookup method resolution failed
2025-10-24 14:39:51 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-10-24 14:39:51 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 14:39:51 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'paymentController': Lookup method resolution failed
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.checkLookupMethods(AutowiredAnnotationBeanPostProcessor.java:482)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstructorsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:1295)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1190)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:946)
	at org.springframework.context.support.AbstractApplicationContext.__refresh(AbstractApplicationContext.java:616)
	at org.springframework.context.support.AbstractApplicationContext.jrLockAndRefresh(AbstractApplicationContext.java:41002)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:42008)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.jiaoyi.JiaoyiApplication.main(JiaoyiApplication.java:15)
Caused by: java.lang.IllegalStateException: Failed to introspect Class [com.jiaoyi.controller.PaymentController] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@24273305]
	at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:483)
	at org.springframework.util.ReflectionUtils.doWithLocalMethods(ReflectionUtils.java:320)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.checkLookupMethods(AutowiredAnnotationBeanPostProcessor.java:460)
	... 21 common frames omitted
Caused by: java.lang.NoClassDefFoundError: AlipayService
	at java.base/java.lang.Class.getDeclaredMethods0(Native Method)
	at java.base/java.lang.Class.privateGetDeclaredMethods(Class.java:3578)
	at java.base/java.lang.Class.getDeclaredMethods(Class.java:2676)
	at org.springframework.util.ReflectionUtils.getDeclaredMethods(ReflectionUtils.java:465)
	... 23 common frames omitted
Caused by: java.lang.ClassNotFoundException: AlipayService
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:526)
	... 27 common frames omitted
2025-10-24 14:40:16 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 40168 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 14:40:16 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 14:40:16 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 14:40:16 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-24 14:40:16 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-24 14:40:17 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2025-10-24 14:40:17 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 14:40:17 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 14:40:17 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 14:40:17 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 14:40:17 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1000 ms
2025-10-24 14:40:18 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 14:40:18 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 14:40:18 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 14:40:18 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 14:40:18 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 14:40:18 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 2.107 seconds (process running for 3.114)
2025-10-24 14:51:36 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 25408 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 14:51:36 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 14:51:36 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 14:51:36 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-24 14:51:36 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-24 14:51:36 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
2025-10-24 14:51:37 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 14:51:37 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 14:51:37 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 14:51:37 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 14:51:37 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1543 ms
2025-10-24 14:51:37 [main] DEBUG o.s.w.f.ServerHttpObservationFilter - Filter 'webMvcObservationFilter' configured for use
2025-10-24 14:51:37 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-10-24 14:51:42 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'preventDuplicateSubmissionAspect' defined in file [D:\软件\ideaproject\jiaoyi\target\classes\com\jiaoyi\aspect\PreventDuplicateSubmissionAspect.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
2025-10-24 14:51:42 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-10-24 14:51:42 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 14:51:42 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'preventDuplicateSubmissionAspect' defined in file [D:\软件\ideaproject\jiaoyi\target\classes\com\jiaoyi\aspect\PreventDuplicateSubmissionAspect.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:802)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:241)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1356)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1193)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:946)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.jiaoyi.JiaoyiApplication.main(JiaoyiApplication.java:15)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:655)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:489)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1336)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1166)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1441)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1348)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:911)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:789)
	... 19 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:178)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651)
	... 33 common frames omitted
Caused by: org.redisson.client.RedisConnectionException: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$0(ConnectionPool.java:129)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.connection.pool.ConnectionPool.promiseFailure(ConnectionPool.java:281)
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$6(ConnectionPool.java:245)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.client.RedisClient$1$1.run(RedisClient.java:301)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.util.concurrent.CompletionException: org.redisson.client.RedisException: ERR Client sent AUTH, but no password is set. channel: [id: 0x65334399, L:/127.0.0.1:55709 - R:localhost/127.0.0.1:6379] command: (AUTH), params: (password masked)
	at java.base/java.util.concurrent.CompletableFuture.encodeRelay(CompletableFuture.java:368)
	at java.base/java.util.concurrent.CompletableFuture.completeRelay(CompletableFuture.java:377)
	at java.base/java.util.concurrent.CompletableFuture$UniRelay.tryFire(CompletableFuture.java:1097)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.client.protocol.CommandData.tryFailure(CommandData.java:87)
	at org.redisson.client.handler.CommandDecoder.decode(CommandDecoder.java:381)
	at org.redisson.client.handler.CommandDecoder.decodeCommand(CommandDecoder.java:205)
	at org.redisson.client.handler.CommandDecoder.decode(CommandDecoder.java:144)
	at org.redisson.client.handler.CommandDecoder.decode(CommandDecoder.java:120)
	at io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:529)
	at io.netty.handler.codec.ReplayingDecoder.callDecode(ReplayingDecoder.java:366)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:290)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	... 4 common frames omitted
Caused by: org.redisson.client.RedisException: ERR Client sent AUTH, but no password is set. channel: [id: 0x65334399, L:/127.0.0.1:55709 - R:localhost/127.0.0.1:6379] command: (AUTH), params: (password masked)
	... 23 common frames omitted
2025-10-24 15:02:23 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 41620 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 15:02:23 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 15:02:23 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 15:02:24 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-24 15:02:24 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-24 15:02:24 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-10-24 15:02:24 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 15:02:24 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 15:02:24 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 15:02:24 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 15:02:24 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1233 ms
2025-10-24 15:02:25 [main] DEBUG o.s.w.f.ServerHttpObservationFilter - Filter 'webMvcObservationFilter' configured for use
2025-10-24 15:02:25 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-10-24 15:02:29 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'preventDuplicateSubmissionAspect' defined in file [D:\软件\ideaproject\jiaoyi\target\classes\com\jiaoyi\aspect\PreventDuplicateSubmissionAspect.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
2025-10-24 15:02:29 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-10-24 15:02:29 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 15:02:30 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'preventDuplicateSubmissionAspect' defined in file [D:\软件\ideaproject\jiaoyi\target\classes\com\jiaoyi\aspect\PreventDuplicateSubmissionAspect.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:802)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:241)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1356)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1193)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:946)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.jiaoyi.JiaoyiApplication.main(JiaoyiApplication.java:15)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:655)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:489)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1336)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1166)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1441)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1348)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:911)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:789)
	... 19 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:178)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651)
	... 33 common frames omitted
Caused by: org.redisson.client.RedisConnectionException: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$0(ConnectionPool.java:129)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.connection.pool.ConnectionPool.promiseFailure(ConnectionPool.java:281)
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$6(ConnectionPool.java:245)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.client.RedisClient$1$1.run(RedisClient.java:301)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.util.concurrent.CompletionException: org.redisson.client.RedisException: ERR Client sent AUTH, but no password is set. channel: [id: 0x6451ed17, L:/127.0.0.1:63252 - R:localhost/127.0.0.1:6379] command: (AUTH), params: (password masked)
	at java.base/java.util.concurrent.CompletableFuture.encodeRelay(CompletableFuture.java:368)
	at java.base/java.util.concurrent.CompletableFuture.completeRelay(CompletableFuture.java:377)
	at java.base/java.util.concurrent.CompletableFuture$UniRelay.tryFire(CompletableFuture.java:1097)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.client.protocol.CommandData.tryFailure(CommandData.java:87)
	at org.redisson.client.handler.CommandDecoder.decode(CommandDecoder.java:381)
	at org.redisson.client.handler.CommandDecoder.decodeCommand(CommandDecoder.java:205)
	at org.redisson.client.handler.CommandDecoder.decode(CommandDecoder.java:144)
	at org.redisson.client.handler.CommandDecoder.decode(CommandDecoder.java:120)
	at io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:529)
	at io.netty.handler.codec.ReplayingDecoder.callDecode(ReplayingDecoder.java:366)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:290)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	... 4 common frames omitted
Caused by: org.redisson.client.RedisException: ERR Client sent AUTH, but no password is set. channel: [id: 0x6451ed17, L:/127.0.0.1:63252 - R:localhost/127.0.0.1:6379] command: (AUTH), params: (password masked)
	... 23 common frames omitted
2025-10-24 15:05:20 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 42836 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 15:05:20 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 15:05:20 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 15:05:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-24 15:05:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-24 15:05:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-10-24 15:05:21 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 15:05:21 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 15:05:21 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 15:05:21 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 15:05:21 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1201 ms
2025-10-24 15:05:22 [main] DEBUG o.s.w.f.ServerHttpObservationFilter - Filter 'webMvcObservationFilter' configured for use
2025-10-24 15:05:22 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-10-24 15:05:22 [redisson-netty-2-5] INFO  o.r.c.p.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-10-24 15:05:22 [redisson-netty-2-20] INFO  o.r.c.pool.MasterConnectionPool - 24 connections initialized for localhost/127.0.0.1:6379
2025-10-24 15:05:22 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 15:05:22 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 15:05:22 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 15:05:23 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 15:05:23 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-10-24 15:05:23 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 15:05:23 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 3.066 seconds (process running for 3.578)
2025-10-24 15:05:23 [RMI TCP Connection(4)-192.168.0.120] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 15:05:23 [RMI TCP Connection(4)-192.168.0.120] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 15:05:23 [RMI TCP Connection(4)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 15:05:23 [RMI TCP Connection(4)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 15:05:23 [RMI TCP Connection(4)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 15:05:23 [RMI TCP Connection(4)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@78151a74
2025-10-24 15:05:23 [RMI TCP Connection(4)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@1901267c
2025-10-24 15:05:23 [RMI TCP Connection(3)-192.168.0.120] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 15:05:23 [RMI TCP Connection(4)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 15:05:23 [RMI TCP Connection(4)-192.168.0.120] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-10-24 15:05:23 [RMI TCP Connection(3)-192.168.0.120] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@17c958eb
2025-10-24 15:05:23 [RMI TCP Connection(3)-192.168.0.120] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 15:07:08 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 15:07:08 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 15:07:08 [http-nio-8080-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 15:07:08 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 15:07:08 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 15:07:08 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 15:07:08 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 15:07:08 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 200
2025-10-24 15:07:08 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 15:07:08 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 15:07:08 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 15:07:08 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 15:07:08 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 15:07:08 [http-nio-8080-exec-2] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:07:08 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 15:07:08 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 15:07:08 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 15:07:08 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 15:07:09 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 15:07:09 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 15:07:09 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 15:07:39 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=45s250ms734µs700ns).
2025-10-24 15:08:53 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m13s933ms808µs200ns).
2025-10-24 15:08:57 [http-nio-8080-exec-3] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 15:40:57 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=32m4s437ms89µs600ns).
2025-10-24 15:40:57 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 15:40:57 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 15:40:57 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 15:40:59 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 15:40:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 15:40:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 15:40:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 15:40:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 270(Integer), 280(Integer), 下单锁定库存(String), 2025-10-24T15:40:59.747554900(LocalDateTime)
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 15:40:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 15:40:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761291659780212F2489(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T15:40:59.791467800(LocalDateTime), 2025-10-24T15:40:59.791467800(LocalDateTime)
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 15:40:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761291659780212F2489
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 39(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 15:40:59 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 15:40:59 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 39, 订单号: ORD1761291659780212F2489
2025-10-24 15:40:59 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761291659780212F2489
2025-10-24 15:41:12 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 15:41:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 15:41:12 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 15:41:25 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleRuntimeException(RuntimeException)
2025-10-24 15:41:25 [http-nio-8080-exec-3] ERROR c.j.exception.GlobalExceptionHandler - 运行时异常
org.redisson.client.RedisResponseTimeoutException: Redis server response timeout (5000 ms) occured after 3 retry attempts, is non-idempotent command: false Check connection with Redis node: localhost/127.0.0.1:6379 for TCP packet drops or bandwidth limits.  Try to increase nettyThreads and/or timeout settings. Command: (HEXISTS), params: [duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==, ad7dd2fe-0899-4a6f-8e1b-5c58c1401369:99], channel: [id: 0x9963f7ef, L:/127.0.0.1:53030 - R:localhost/127.0.0.1:6379]
	at org.redisson.command.RedisExecutor.lambda$scheduleResponseTimeout$9(RedisExecutor.java:419)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:25 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 15:41:25 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误: Redis server response timeout (5000 ms) occured after 3 retry  (truncated)...]
2025-10-24 15:41:25 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.DisconnectedClient - Looks like the client has gone away: org.apache.catalina.connector.ClientAbortException: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。 (For a full stack trace, set the log category 'org.apache.commons.logging.LogAdapter$Slf4jLocationAwareLog@6c8ec3bb' to TRACE level.)
2025-10-24 15:41:25 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: org.redisson.client.RedisResponseTimeoutException: Redis server response timeout (5000 ms) occured after 3 retry attempts, is non-idempotent command: false Check connection with Redis node: localhost/127.0.0.1:6379 for TCP packet drops or bandwidth limits.  Try to increase nettyThreads and/or timeout settings. Command: (HEXISTS), params: [duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==, ad7dd2fe-0899-4a6f-8e1b-5c58c1401369:99], channel: [id: 0x9963f7ef, L:/127.0.0.1:53030 - R:localhost/127.0.0.1:6379]
2025-10-24 15:41:25 [http-nio-8080-exec-3] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.redisson.client.RedisResponseTimeoutException: Redis server response timeout (5000 ms) occured after 3 retry attempts, is non-idempotent command: false Check connection with Redis node: localhost/127.0.0.1:6379 for TCP packet drops or bandwidth limits.  Try to increase nettyThreads and/or timeout settings. Command: (HEXISTS), params: [duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==, ad7dd2fe-0899-4a6f-8e1b-5c58c1401369:99], channel: [id: 0x9963f7ef, L:/127.0.0.1:53030 - R:localhost/127.0.0.1:6379]] with root cause
org.redisson.client.RedisResponseTimeoutException: Redis server response timeout (5000 ms) occured after 3 retry attempts, is non-idempotent command: false Check connection with Redis node: localhost/127.0.0.1:6379 for TCP packet drops or bandwidth limits.  Try to increase nettyThreads and/or timeout settings. Command: (HEXISTS), params: [duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==, ad7dd2fe-0899-4a6f-8e1b-5c58c1401369:99], channel: [id: 0x9963f7ef, L:/127.0.0.1:53030 - R:localhost/127.0.0.1:6379]
	at org.redisson.command.RedisExecutor.lambda$scheduleResponseTimeout$9(RedisExecutor.java:419)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x1c6dd823, L:/127.0.0.1:53020 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x002bed43, L:/127.0.0.1:53018 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xa97782d8, L:/127.0.0.1:53021 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x1e705ec9, L:/127.0.0.1:53022 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xc08f3306, L:/127.0.0.1:53023 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xed5700be, L:/127.0.0.1:53024 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x0d1323a9, L:/127.0.0.1:53025 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x4fdb2194, L:/127.0.0.1:53026 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x3f10ac7f, L:/127.0.0.1:53027 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xc767dc0d, L:/127.0.0.1:53028 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xdd1ac890, L:/127.0.0.1:53029 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x9963f7ef, L:/127.0.0.1:53030 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x51414b5d, L:/127.0.0.1:53031 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x469936be, L:/127.0.0.1:53033 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xa9ff7fa4, L:/127.0.0.1:53034 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xb7a4143f, L:/127.0.0.1:53035 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xf315a35b, L:/127.0.0.1:53036 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xc9c9c3c1, L:/127.0.0.1:53037 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xcf8c4f04, L:/127.0.0.1:53038 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xfe07e5e0, L:/127.0.0.1:53039 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x40dde837, L:/127.0.0.1:53040 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x0ec97ddb, L:/127.0.0.1:53041 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x4e0f6645, L:/127.0.0.1:53042 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0xd350153f, L:/127.0.0.1:53043 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:41:34 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleRuntimeException(RuntimeException)
2025-10-24 15:41:34 [http-nio-8080-exec-8] ERROR c.j.exception.GlobalExceptionHandler - 运行时异常
org.redisson.client.WriteRedisConnectionException: Unable to write command into connection! Increase nettyThreads setting. Node source: NodeSource [slot=0, addr=null, redisClient=null, redirect=null, entry=null], connection: RedisConnection@837324064 [redisClient=[addr=redis://localhost:6379], channel=[id: 0x40dde837, L:/127.0.0.1:53040 ! R:localhost/127.0.0.1:6379], currentCommand=null, usage=1], command: (HEXISTS), params: [duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==, ad7dd2fe-0899-4a6f-8e1b-5c58c1401369:104] after 3 retry attempts
	at org.redisson.command.RedisExecutor.checkWriteFuture(RedisExecutor.java:357)
	at org.redisson.command.RedisExecutor.lambda$execute$3(RedisExecutor.java:195)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:629)
	at io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:118)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetFailure(AbstractChannel.java:999)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(AbstractChannel.java:860)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.write(DefaultChannelPipeline.java:1367)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:877)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:940)
	at io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1247)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: io.netty.channel.StacklessClosedChannelException: null
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(Object, ChannelPromise)(Unknown Source)
2025-10-24 15:41:34 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 15:41:34 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误: Unable to write command into connection! Increase nettyThreads (truncated)...]
2025-10-24 15:41:34 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.redisson.client.WriteRedisConnectionException: Unable to write command into connection! Increase nettyThreads setting. Node source: NodeSource [slot=0, addr=null, redisClient=null, redirect=null, entry=null], connection: RedisConnection@837324064 [redisClient=[addr=redis://localhost:6379], channel=[id: 0x40dde837, L:/127.0.0.1:53040 ! R:localhost/127.0.0.1:6379], currentCommand=null, usage=1], command: (HEXISTS), params: [duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==, ad7dd2fe-0899-4a6f-8e1b-5c58c1401369:104] after 3 retry attempts]
2025-10-24 15:41:34 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 15:41:35 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleRuntimeException(RuntimeException)
2025-10-24 15:41:35 [http-nio-8080-exec-4] ERROR c.j.exception.GlobalExceptionHandler - 运行时异常
org.redisson.client.WriteRedisConnectionException: Unable to write command into connection! Increase nettyThreads setting. Node source: NodeSource [slot=0, addr=null, redisClient=null, redirect=null, entry=null], connection: RedisConnection@1037532714 [redisClient=[addr=redis://localhost:6379], channel=[id: 0x0ec97ddb, L:/127.0.0.1:53041 ! R:localhost/127.0.0.1:6379], currentCommand=null, usage=1], command: (HEXISTS), params: [duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==, ad7dd2fe-0899-4a6f-8e1b-5c58c1401369:100] after 3 retry attempts
	at org.redisson.command.RedisExecutor.checkWriteFuture(RedisExecutor.java:357)
	at org.redisson.command.RedisExecutor.lambda$execute$3(RedisExecutor.java:195)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:629)
	at io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:118)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetFailure(AbstractChannel.java:999)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(AbstractChannel.java:860)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.write(DefaultChannelPipeline.java:1367)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:877)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:940)
	at io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1247)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: io.netty.channel.StacklessClosedChannelException: null
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(Object, ChannelPromise)(Unknown Source)
2025-10-24 15:41:35 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 15:41:35 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误: Unable to write command into connection! Increase nettyThreads (truncated)...]
2025-10-24 15:41:35 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.DisconnectedClient - Looks like the client has gone away: org.apache.catalina.connector.ClientAbortException: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。 (For a full stack trace, set the log category 'org.apache.commons.logging.LogAdapter$Slf4jLocationAwareLog@6c8ec3bb' to TRACE level.)
2025-10-24 15:41:35 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: org.redisson.client.WriteRedisConnectionException: Unable to write command into connection! Increase nettyThreads setting. Node source: NodeSource [slot=0, addr=null, redisClient=null, redirect=null, entry=null], connection: RedisConnection@1037532714 [redisClient=[addr=redis://localhost:6379], channel=[id: 0x0ec97ddb, L:/127.0.0.1:53041 ! R:localhost/127.0.0.1:6379], currentCommand=null, usage=1], command: (HEXISTS), params: [duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==, ad7dd2fe-0899-4a6f-8e1b-5c58c1401369:100] after 3 retry attempts
2025-10-24 15:41:35 [http-nio-8080-exec-4] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.redisson.client.WriteRedisConnectionException: Unable to write command into connection! Increase nettyThreads setting. Node source: NodeSource [slot=0, addr=null, redisClient=null, redirect=null, entry=null], connection: RedisConnection@1037532714 [redisClient=[addr=redis://localhost:6379], channel=[id: 0x0ec97ddb, L:/127.0.0.1:53041 ! R:localhost/127.0.0.1:6379], currentCommand=null, usage=1], command: (HEXISTS), params: [duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==, ad7dd2fe-0899-4a6f-8e1b-5c58c1401369:100] after 3 retry attempts] with root cause
io.netty.channel.StacklessClosedChannelException: null
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(Object, ChannelPromise)(Unknown Source)
2025-10-24 15:41:51 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 15:41:51 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 15:41:51 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 15:42:21 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleRuntimeException(RuntimeException)
2025-10-24 15:42:21 [http-nio-8080-exec-6] ERROR c.j.exception.GlobalExceptionHandler - 运行时异常
org.redisson.client.WriteRedisConnectionException: Unable to write command into connection! Increase nettyThreads setting. Node source: NodeSource [slot=0, addr=null, redisClient=null, redirect=null, entry=null], connection: RedisConnection@455017802 [redisClient=[addr=redis://localhost:6379], channel=[id: 0x0d1323a9, L:/127.0.0.1:53025 ! R:localhost/127.0.0.1:6379], currentCommand=null, usage=1], command: (HEXISTS), params: [duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==, ad7dd2fe-0899-4a6f-8e1b-5c58c1401369:102] after 3 retry attempts
	at org.redisson.command.RedisExecutor.checkWriteFuture(RedisExecutor.java:357)
	at org.redisson.command.RedisExecutor.lambda$execute$3(RedisExecutor.java:195)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:557)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
	at io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:629)
	at io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:118)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetFailure(AbstractChannel.java:999)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(AbstractChannel.java:860)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.write(DefaultChannelPipeline.java:1367)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:877)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:940)
	at io.netty.channel.AbstractChannelHandlerContext$WriteTask.run(AbstractChannelHandlerContext.java:1247)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: io.netty.channel.StacklessClosedChannelException: null
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(Object, ChannelPromise)(Unknown Source)
2025-10-24 15:42:21 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 15:42:21 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误: Unable to write command into connection! Increase nettyThreads (truncated)...]
2025-10-24 15:42:21 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.redisson.client.WriteRedisConnectionException: Unable to write command into connection! Increase nettyThreads setting. Node source: NodeSource [slot=0, addr=null, redisClient=null, redirect=null, entry=null], connection: RedisConnection@455017802 [redisClient=[addr=redis://localhost:6379], channel=[id: 0x0d1323a9, L:/127.0.0.1:53025 ! R:localhost/127.0.0.1:6379], currentCommand=null, usage=1], command: (HEXISTS), params: [duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==, ad7dd2fe-0899-4a6f-8e1b-5c58c1401369:102] after 3 retry attempts]
2025-10-24 15:42:21 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 15:42:27 [redisson-timer-4-1] ERROR o.r.c.handler.PingConnectionHandler - Unable to send PING command over channel: [id: 0x170d045f, L:/127.0.0.1:53032 - R:localhost/127.0.0.1:6379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:46:48 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 15:46:48 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 15:46:52 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 35732 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 15:46:52 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 15:46:52 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 15:46:53 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-24 15:46:53 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-24 15:46:53 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-10-24 15:46:53 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 15:46:53 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 15:46:53 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 15:46:53 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 15:46:53 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1281 ms
2025-10-24 15:46:54 [main] DEBUG o.s.w.f.ServerHttpObservationFilter - Filter 'webMvcObservationFilter' configured for use
2025-10-24 15:46:54 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-10-24 15:47:19 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'preventDuplicateSubmissionAspect' defined in file [D:\软件\ideaproject\jiaoyi\target\classes\com\jiaoyi\aspect\PreventDuplicateSubmissionAspect.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
2025-10-24 15:47:19 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-10-24 15:47:19 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 15:47:19 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'preventDuplicateSubmissionAspect' defined in file [D:\软件\ideaproject\jiaoyi\target\classes\com\jiaoyi\aspect\PreventDuplicateSubmissionAspect.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:802)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:241)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1356)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1193)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:946)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.jiaoyi.JiaoyiApplication.main(JiaoyiApplication.java:15)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:655)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:489)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1336)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1166)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1441)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1348)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:911)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:789)
	... 19 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:178)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651)
	... 33 common frames omitted
Caused by: org.redisson.client.RedisConnectionException: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$0(ConnectionPool.java:129)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.connection.pool.ConnectionPool.promiseFailure(ConnectionPool.java:281)
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$6(ConnectionPool.java:245)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.client.RedisClient$1$1.run(RedisClient.java:301)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.util.concurrent.CompletionException: org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1498)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:257)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	... 2 common frames omitted
Caused by: org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	... 7 common frames omitted
2025-10-24 15:50:59 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 42248 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 15:50:59 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 15:50:59 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 15:50:59 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-24 15:50:59 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-24 15:50:59 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-10-24 15:51:00 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 15:51:00 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 15:51:00 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 15:51:00 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 15:51:00 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1186 ms
2025-10-24 15:51:00 [main] DEBUG o.s.w.f.ServerHttpObservationFilter - Filter 'webMvcObservationFilter' configured for use
2025-10-24 15:51:00 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-10-24 15:51:25 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'preventDuplicateSubmissionAspect' defined in file [D:\软件\ideaproject\jiaoyi\target\classes\com\jiaoyi\aspect\PreventDuplicateSubmissionAspect.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
2025-10-24 15:51:25 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-10-24 15:51:25 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 15:51:25 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'preventDuplicateSubmissionAspect' defined in file [D:\软件\ideaproject\jiaoyi\target\classes\com\jiaoyi\aspect\PreventDuplicateSubmissionAspect.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:802)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:241)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1356)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1193)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:946)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.jiaoyi.JiaoyiApplication.main(JiaoyiApplication.java:15)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:655)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:489)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1336)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1166)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1441)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1348)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:911)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:789)
	... 19 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:178)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651)
	... 33 common frames omitted
Caused by: org.redisson.client.RedisConnectionException: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$0(ConnectionPool.java:129)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.connection.pool.ConnectionPool.promiseFailure(ConnectionPool.java:281)
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$6(ConnectionPool.java:245)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.client.RedisClient$1$1.run(RedisClient.java:301)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.util.concurrent.CompletionException: org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1498)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:257)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	... 2 common frames omitted
Caused by: org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	... 7 common frames omitted
2025-10-24 15:54:11 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 39212 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 15:54:11 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 15:54:11 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 15:54:12 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-24 15:54:12 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-24 15:54:12 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2025-10-24 15:54:12 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 15:54:12 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 15:54:12 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 15:54:12 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 15:54:12 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1371 ms
2025-10-24 15:54:13 [main] DEBUG o.s.w.f.ServerHttpObservationFilter - Filter 'webMvcObservationFilter' configured for use
2025-10-24 15:54:13 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-10-24 15:54:38 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'preventDuplicateSubmissionAspect' defined in file [D:\软件\ideaproject\jiaoyi\target\classes\com\jiaoyi\aspect\PreventDuplicateSubmissionAspect.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
2025-10-24 15:54:38 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-10-24 15:54:38 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-24 15:54:38 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'preventDuplicateSubmissionAspect' defined in file [D:\软件\ideaproject\jiaoyi\target\classes\com\jiaoyi\aspect\PreventDuplicateSubmissionAspect.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:802)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:241)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1356)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1193)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:946)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.jiaoyi.JiaoyiApplication.main(JiaoyiApplication.java:15)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redisson' defined in class path resource [org/redisson/spring/starter/RedissonAutoConfigurationV2.class]: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:655)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:489)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1336)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1166)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1441)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1348)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:911)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:789)
	... 19 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redisson' threw exception with message: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:178)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651)
	... 33 common frames omitted
Caused by: org.redisson.client.RedisConnectionException: Unable to connect to Redis server: localhost/127.0.0.1:6379
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$0(ConnectionPool.java:129)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.connection.pool.ConnectionPool.promiseFailure(ConnectionPool.java:281)
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$6(ConnectionPool.java:245)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.client.RedisClient$1$1.run(RedisClient.java:301)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.util.concurrent.CompletionException: org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1498)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:257)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	... 2 common frames omitted
Caused by: org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://localhost:6379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	... 7 common frames omitted
2025-10-24 15:55:47 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 34428 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 15:55:47 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 15:55:47 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 15:55:47 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-24 15:55:47 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-24 15:55:47 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-10-24 15:55:48 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 15:55:48 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 15:55:48 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 15:55:48 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 15:55:48 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1265 ms
2025-10-24 15:55:48 [main] DEBUG o.s.w.f.ServerHttpObservationFilter - Filter 'webMvcObservationFilter' configured for use
2025-10-24 15:55:48 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-10-24 15:55:48 [redisson-netty-2-5] INFO  o.r.c.p.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-10-24 15:55:48 [redisson-netty-2-20] INFO  o.r.c.pool.MasterConnectionPool - 24 connections initialized for localhost/127.0.0.1:6379
2025-10-24 15:55:49 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 15:55:49 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 15:55:49 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 15:55:49 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 15:55:50 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-10-24 15:55:50 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 15:55:50 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 3.151 seconds (process running for 3.692)
2025-10-24 15:55:50 [RMI TCP Connection(1)-192.168.0.120] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 15:55:50 [RMI TCP Connection(1)-192.168.0.120] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 15:55:50 [RMI TCP Connection(1)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 15:55:50 [RMI TCP Connection(1)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 15:55:50 [RMI TCP Connection(1)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 15:55:50 [RMI TCP Connection(1)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@749ae8b6
2025-10-24 15:55:50 [RMI TCP Connection(1)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@2c9cf956
2025-10-24 15:55:50 [RMI TCP Connection(1)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 15:55:50 [RMI TCP Connection(1)-192.168.0.120] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-10-24 15:55:50 [RMI TCP Connection(2)-192.168.0.120] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 15:55:50 [RMI TCP Connection(2)-192.168.0.120] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1af5a8ad
2025-10-24 15:55:50 [RMI TCP Connection(2)-192.168.0.120] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 15:59:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 15:59:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 15:59:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 15:59:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 15:59:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 15:59:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 15:59:42 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 15:59:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 15:59:42 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 15:59:42 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 15:59:42 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 15:59:42 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 15:59:42 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 15:59:42 [http-nio-8080-exec-2] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 15:59:42 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 15:59:42 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 15:59:42 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 15:59:42 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 280(Integer), 290(Integer), 下单锁定库存(String), 2025-10-24T15:59:43.782552100(LocalDateTime)
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761292783789648D0207(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T15:59:43.790269900(LocalDateTime), 2025-10-24T15:59:43.790269900(LocalDateTime)
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761292783789648D0207
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 40(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 40, 订单号: ORD1761292783789648D0207
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761292783789648D0207
2025-10-24 15:59:43 [http-nio-8080-exec-4] INFO  c.j.a.PreventDuplicateSubmissionAspect - 锁已释放，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=40, orderNo=ORD1761292783789648D0207, us (truncated)...]
2025-10-24 15:59:43 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 290(Integer), 300(Integer), 下单锁定库存(String), 2025-10-24T15:59:46.837404500(LocalDateTime)
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612927868391C666BBE(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T15:59:46.839399200(LocalDateTime), 2025-10-24T15:59:46.839399200(LocalDateTime)
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612927868391C666BBE
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 41(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 41, 订单号: ORD17612927868391C666BBE
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612927868391C666BBE
2025-10-24 15:59:46 [http-nio-8080-exec-3] INFO  c.j.a.PreventDuplicateSubmissionAspect - 锁已释放，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=41, orderNo=ORD17612927868391C666BBE, us (truncated)...]
2025-10-24 15:59:46 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 16:02:14 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/41/pay", parameters={}
2025-10-24 16:02:14 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-24 16:02:14 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=60, channel=WEB, clientIp=192.168.1.100, userAgent=Mozil (truncated)...]
2025-10-24 16:02:14 [http-nio-8080-exec-6] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:41_pay
2025-10-24 16:02:14 [http-nio-8080-exec-6] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 41, 支付方式: ALIPAY
2025-10-24 16:02:14 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 41, 支付方式: ALIPAY
2025-10-24 16:02:14 [http-nio-8080-exec-6] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-24 16:02:14 [http-nio-8080-exec-6] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 41(Long)
2025-10-24 16:02:14 [http-nio-8080-exec-6] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-24 16:02:14 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 41, 支付方式: ALIPAY
2025-10-24 16:02:14 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 41
2025-10-24 16:02:14 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 创建模拟支付宝支付订单，订单号: ORD17612927868391C666BBE, 金额: 60
2025-10-24 16:02:14 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 模拟支付宝支付订单创建成功，支付流水号: PAY1761292934868242908A3
2025-10-24 16:02:14 [http-nio-8080-exec-6] INFO  c.j.a.PreventDuplicateSubmissionAspect - 锁已释放，锁key: duplicate_submission:41_pay
2025-10-24 16:02:14 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 16:02:14 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY1761292934868242908A3, statu (truncated)...]
2025-10-24 16:02:14 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 16:02:19 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 16:02:19 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 16:02:19 [http-nio-8080-exec-7] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 16:02:19 [http-nio-8080-exec-7] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 16:02:19 [http-nio-8080-exec-7] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 16:02:19 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 16:02:19 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 16:02:19 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 16:02:19 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 16:02:19 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 16:02:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 16:02:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 16:02:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 16:02:19 [http-nio-8080-exec-8] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 16:02:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 16:02:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 16:02:19 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 16:02:19 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 300(Integer), 310(Integer), 下单锁定库存(String), 2025-10-24T16:02:21.166975800(LocalDateTime)
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD176129294117107196E47(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T16:02:21.172423600(LocalDateTime), 2025-10-24T16:02:21.172423600(LocalDateTime)
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD176129294117107196E47
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 42(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 42, 订单号: ORD176129294117107196E47
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD176129294117107196E47
2025-10-24 16:02:21 [http-nio-8080-exec-9] INFO  c.j.a.PreventDuplicateSubmissionAspect - 锁已释放，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=42, orderNo=ORD176129294117107196E47, us (truncated)...]
2025-10-24 16:02:21 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 16:02:51 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 16:02:51 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 16:02:51 [http-nio-8080-exec-10] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 16:02:51 [http-nio-8080-exec-10] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 16:02:51 [http-nio-8080-exec-10] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 16:02:51 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 16:02:51 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 16:02:51 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 16:02:51 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 16:02:51 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 16:02:51 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 16:02:51 [http-nio-8080-exec-1] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 16:02:51 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 16:02:51 [http-nio-8080-exec-1] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 16:02:51 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 16:02:51 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 16:02:51 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 16:02:51 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 16:02:52 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 16:02:52 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 16:02:52 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 16:02:58 [http-nio-8080-exec-2] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:02:59 [http-nio-8080-exec-2] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 16:02:59 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 16:02:59 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 16:02:59 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 16:02:59 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 310(Integer), 320(Integer), 下单锁定库存(String), 2025-10-24T16:02:59.378477700(LocalDateTime)
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 16:02:59 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 16:02:59 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761292979386AF22D0A3(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T16:02:59.386450200(LocalDateTime), 2025-10-24T16:02:59.386450200(LocalDateTime)
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 16:02:59 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761292979386AF22D0A3
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 43(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 16:02:59 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 43, 订单号: ORD1761292979386AF22D0A3
2025-10-24 16:02:59 [http-nio-8080-exec-2] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761292979386AF22D0A3
2025-10-24 16:02:59 [http-nio-8080-exec-2] INFO  c.j.a.PreventDuplicateSubmissionAspect - 锁已释放，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=43, orderNo=ORD1761292979386AF22D0A3, us (truncated)...]
2025-10-24 16:02:59 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 16:03:01 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 16:03:01 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 16:03:01 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 320(Integer), 330(Integer), 下单锁定库存(String), 2025-10-24T16:03:05.858560300(LocalDateTime)
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612929858670168638B(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T16:03:05.867533900(LocalDateTime), 2025-10-24T16:03:05.867533900(LocalDateTime)
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612929858670168638B
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 44(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 44, 订单号: ORD17612929858670168638B
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612929858670168638B
2025-10-24 16:03:05 [http-nio-8080-exec-4] INFO  c.j.a.PreventDuplicateSubmissionAspect - 锁已释放，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=44, orderNo=ORD17612929858670168638B, us (truncated)...]
2025-10-24 16:03:05 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 16:03:11 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 16:03:11 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 16:03:11 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 330(Integer), 340(Integer), 下单锁定库存(String), 2025-10-24T16:03:18.672080200(LocalDateTime)
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD176129299867674D70BAC(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T16:03:18.676066800(LocalDateTime), 2025-10-24T16:03:18.676066800(LocalDateTime)
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD176129299867674D70BAC
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 45(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 45, 订单号: ORD176129299867674D70BAC
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD176129299867674D70BAC
2025-10-24 16:03:18 [http-nio-8080-exec-3] INFO  c.j.a.PreventDuplicateSubmissionAspect - 锁已释放，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=45, orderNo=ORD176129299867674D70BAC, us (truncated)...]
2025-10-24 16:03:18 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 16:03:20 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 16:03:20 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 16:03:20 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 340(Integer), 350(Integer), 下单锁定库存(String), 2025-10-24T16:03:39.509134400(LocalDateTime)
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761293019511B83E41A0(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T16:03:39.511127900(LocalDateTime), 2025-10-24T16:03:39.511127900(LocalDateTime)
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761293019511B83E41A0
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 46(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 46, 订单号: ORD1761293019511B83E41A0
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761293019511B83E41A0
2025-10-24 16:03:39 [http-nio-8080-exec-5] INFO  c.j.a.PreventDuplicateSubmissionAspect - 锁已释放，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=46, orderNo=ORD1761293019511B83E41A0, us (truncated)...]
2025-10-24 16:03:39 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 16:03:48 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 16:03:48 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 16:03:48 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 16:06:41 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=3m19s628ms838µs).
2025-10-24 16:06:43 [http-nio-8080-exec-6] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:16:02 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=9m20s685ms972µs500ns).
2025-10-24 16:16:02 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 16:16:02 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 16:16:02 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 16:16:02 [http-nio-8080-exec-6] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 16:16:02 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 16:16:02 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 16:16:02 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 16:16:02 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 16:16:02 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 16:16:02 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 350(Integer), 360(Integer), 下单锁定库存(String), 2025-10-24T16:16:03.367721600(LocalDateTime)
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761293763369892AF142(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T16:16:03.369719200(LocalDateTime), 2025-10-24T16:16:03.369719200(LocalDateTime)
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761293763369892AF142
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 47(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 47, 订单号: ORD1761293763369892AF142
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761293763369892AF142
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 16:16:03 [http-nio-8080-exec-7] INFO  c.j.a.PreventDuplicateSubmissionAspect - 锁已释放，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=47, orderNo=ORD1761293763369892AF142, us (truncated)...]
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 16:16:03 [http-nio-8080-exec-7] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.apache.catalina.connector.ClientAbortException: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:305)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:267)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:120)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1200)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:483)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:114)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:245)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:78)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:136)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:542)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:118)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1381)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:566)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:157)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:220)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1245)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:400)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:301)
	... 58 common frames omitted
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Found 'Content-Type:application/json' in response
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.DisconnectedClient - Looks like the client has gone away: org.apache.catalina.connector.ClientAbortException: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。 (For a full stack trace, set the log category 'org.apache.commons.logging.LogAdapter$Slf4jLocationAwareLog@6d776086' to TRACE level.)
2025-10-24 16:16:03 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: org.apache.catalina.connector.ClientAbortException: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 350(Integer), 360(Integer), 下单锁定库存(String), 2025-10-24T16:16:03.373701400(LocalDateTime)
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 16:16:03 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 16:16:03 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761293763381B6DAA334(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T16:16:03.381677600(LocalDateTime), 2025-10-24T16:16:03.381677600(LocalDateTime)
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 16:16:03 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761293763381B6DAA334
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 48(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 16:16:03 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 48, 订单号: ORD1761293763381B6DAA334
2025-10-24 16:16:03 [http-nio-8080-exec-6] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761293763381B6DAA334
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=48, orderNo=ORD1761293763381B6DAA334, us (truncated)...]
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 16:16:03 [http-nio-8080-exec-6] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.apache.catalina.connector.ClientAbortException: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:305)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:267)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:120)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1200)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:483)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:114)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:245)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:78)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:136)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:542)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:118)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1381)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:566)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:157)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:220)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1245)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:400)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:301)
	... 58 common frames omitted
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Found 'Content-Type:application/json' in response
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.DisconnectedClient - Looks like the client has gone away: org.apache.catalina.connector.ClientAbortException: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。 (For a full stack trace, set the log category 'org.apache.commons.logging.LogAdapter$Slf4jLocationAwareLog@6d776086' to TRACE level.)
2025-10-24 16:16:03 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: org.apache.catalina.connector.ClientAbortException: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
2025-10-24 16:16:25 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 16:16:25 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 16:16:25 [http-nio-8080-exec-8] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 16:16:25 [http-nio-8080-exec-8] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 16:16:25 [http-nio-8080-exec-8] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 16:16:25 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 16:16:25 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 16:16:25 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 16:16:25 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 16:16:25 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 16:16:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 16:16:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 16:16:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 16:16:25 [http-nio-8080-exec-9] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 16:16:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 16:16:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 16:16:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 16:16:25 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 16:16:28 [http-nio-8080-exec-10] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:16:28 [http-nio-8080-exec-10] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 16:16:28 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 16:16:28 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 16:16:28 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 16:16:28 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 370(Integer), 380(Integer), 下单锁定库存(String), 2025-10-24T16:16:28.388760500(LocalDateTime)
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 16:16:28 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 16:16:28 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD1761293788389C1B2E2B8(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T16:16:28.389752700(LocalDateTime), 2025-10-24T16:16:28.389752700(LocalDateTime)
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 16:16:28 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD1761293788389C1B2E2B8
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 49(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 16:16:28 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 49, 订单号: ORD1761293788389C1B2E2B8
2025-10-24 16:16:28 [http-nio-8080-exec-10] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD1761293788389C1B2E2B8
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=49, orderNo=ORD1761293788389C1B2E2B8, us (truncated)...]
2025-10-24 16:16:28 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 16:16:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 16:16:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 16:16:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 16:16:30 [http-nio-8080-exec-1] WARN  c.j.a.PreventDuplicateSubmissionAspect - 检测到重复提交，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 16:16:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleRuntimeException(RuntimeException)
2025-10-24 16:16:30 [http-nio-8080-exec-1] ERROR c.j.exception.GlobalExceptionHandler - 运行时异常
java.lang.ClassCastException: class com.jiaoyi.common.ApiResponse cannot be cast to class org.springframework.http.ResponseEntity (com.jiaoyi.common.ApiResponse and org.springframework.http.ResponseEntity are in unnamed module of loader 'app')
	at com.jiaoyi.controller.OrderController$$SpringCGLIB$$0.createOrder(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 16:16:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 16:16:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误: class com.jiaoyi.common.ApiResponse cannot be cast to class or (truncated)...]
2025-10-24 16:16:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [java.lang.ClassCastException: class com.jiaoyi.common.ApiResponse cannot be cast to class org.springframework.http.ResponseEntity (com.jiaoyi.common.ApiResponse and org.springframework.http.ResponseEntity are in unnamed module of loader 'app')]
2025-10-24 16:16:30 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 17:02:37 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-24 17:02:37 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-24 17:02:43 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 35176 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-24 17:02:43 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-24 17:02:43 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-24 17:02:43 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-24 17:02:43 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-24 17:02:43 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-10-24 17:02:44 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-24 17:02:44 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-24 17:02:44 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-24 17:02:44 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-24 17:02:44 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1291 ms
2025-10-24 17:02:44 [main] DEBUG o.s.w.f.ServerHttpObservationFilter - Filter 'webMvcObservationFilter' configured for use
2025-10-24 17:02:44 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-10-24 17:02:44 [redisson-netty-2-6] INFO  o.r.c.p.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-10-24 17:02:44 [redisson-netty-2-20] INFO  o.r.c.pool.MasterConnectionPool - 24 connections initialized for localhost/127.0.0.1:6379
2025-10-24 17:02:45 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 19 mappings in 'requestMappingHandlerMapping'
2025-10-24 17:02:45 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-24 17:02:45 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-24 17:02:45 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-24 17:02:46 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-10-24 17:02:46 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-24 17:02:46 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 3.304 seconds (process running for 3.932)
2025-10-24 17:02:46 [RMI TCP Connection(3)-192.168.0.120] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-24 17:02:46 [RMI TCP Connection(3)-192.168.0.120] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-24 17:02:46 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-24 17:02:46 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-24 17:02:46 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-24 17:02:46 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@33d69ff8
2025-10-24 17:02:46 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@2f2d9c13
2025-10-24 17:02:46 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-24 17:02:46 [RMI TCP Connection(3)-192.168.0.120] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-10-24 17:02:46 [RMI TCP Connection(4)-192.168.0.120] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-24 17:02:46 [RMI TCP Connection(4)-192.168.0.120] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@53b324b3
2025-10-24 17:02:46 [RMI TCP Connection(4)-192.168.0.120] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-24 17:03:11 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-24 17:03:11 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-24 17:03:11 [http-nio-8080-exec-3] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-24 17:03:11 [http-nio-8080-exec-3] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-24 17:03:11 [http-nio-8080-exec-3] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-24 17:03:11 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-24 17:03:11 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 17:03:11 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-24 17:03:11 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-24 17:03:11 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-24 17:03:11 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-24 17:03:11 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-24 17:03:11 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-24 17:03:11 [http-nio-8080-exec-2] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 17:03:11 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-24 17:03:11 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-24 17:03:11 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-24 17:03:11 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 17:03:12 [http-nio-8080-exec-1] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 17:03:12 [http-nio-8080-exec-1] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 17:03:12 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 17:03:12 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 17:03:12 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 17:03:12 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 380(Integer), 390(Integer), 下单锁定库存(String), 2025-10-24T17:03:12.972511100(LocalDateTime)
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 17:03:12 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 17:03:12 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17612965929781882CCCB(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T17:03:12.979491500(LocalDateTime), 2025-10-24T17:03:12.979491500(LocalDateTime)
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 17:03:12 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17612965929781882CCCB
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 50(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 17:03:12 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 50, 订单号: ORD17612965929781882CCCB
2025-10-24 17:03:12 [http-nio-8080-exec-1] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17612965929781882CCCB
2025-10-24 17:03:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 17:03:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=50, orderNo=ORD17612965929781882CCCB, us (truncated)...]
2025-10-24 17:03:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 17:03:14 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 17:03:14 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 17:03:14 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 17:03:15 [http-nio-8080-exec-4] WARN  c.j.a.PreventDuplicateSubmissionAspect - 检测到重复提交，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 17:03:15 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleRuntimeException(RuntimeException)
2025-10-24 17:03:15 [http-nio-8080-exec-4] ERROR c.j.exception.GlobalExceptionHandler - 运行时异常
java.lang.RuntimeException: 请勿重复提交相同订单
	at com.jiaoyi.aspect.PreventDuplicateSubmissionAspect.around(PreventDuplicateSubmissionAspect.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:637)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:627)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:71)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:173)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.jiaoyi.controller.OrderController$$SpringCGLIB$$0.createOrder(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 17:03:15 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 17:03:15 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误: 请勿重复提交相同订单, data=null)]
2025-10-24 17:03:15 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [java.lang.RuntimeException: 请勿重复提交相同订单]
2025-10-24 17:03:15 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 17:03:23 [http-nio-8080-exec-5] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 17:03:23 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-24 17:03:23 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-24 17:03:23 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-24 17:03:23 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-24 17:03:23 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 555555505(Integer), 555555505(Integer), 390(Integer), 400(Integer), 下单锁定库存(String), 2025-10-24T17:03:23.510864500(LocalDateTime)
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-24 17:03:23 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-24 17:03:23 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD176129660351492C36E53(String), 94(Long), PENDING(String), 60(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-24T17:03:23.514850700(LocalDateTime), 2025-10-24T17:03:23.514850700(LocalDateTime)
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-24 17:03:23 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD176129660351492C36E53
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 51(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 6(BigDecimal), 10(Integer), 60(BigDecimal)
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-24 17:03:23 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 51, 订单号: ORD176129660351492C36E53
2025-10-24 17:03:23 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD176129660351492C36E53
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=51, orderNo=ORD176129660351492C36E53, us (truncated)...]
2025-10-24 17:03:23 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-24 17:03:26 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-24 17:03:26 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-24 17:03:26 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-24 17:03:27 [http-nio-8080-exec-6] WARN  c.j.a.PreventDuplicateSubmissionAspect - 检测到重复提交，锁key: duplicate_submission:E/MwhjvhMv/W2YR7t2f1bg==
2025-10-24 17:03:27 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleRuntimeException(RuntimeException)
2025-10-24 17:03:27 [http-nio-8080-exec-6] ERROR c.j.exception.GlobalExceptionHandler - 运行时异常
java.lang.RuntimeException: 请勿重复提交相同订单
	at com.jiaoyi.aspect.PreventDuplicateSubmissionAspect.around(PreventDuplicateSubmissionAspect.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:637)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:627)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:71)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:173)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:717)
	at com.jiaoyi.controller.OrderController$$SpringCGLIB$$0.createOrder(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-24 17:03:27 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-24 17:03:27 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误: 请勿重复提交相同订单, data=null)]
2025-10-24 17:03:27 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [java.lang.RuntimeException: 请勿重复提交相同订单]
2025-10-24 17:03:27 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
