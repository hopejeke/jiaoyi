2025-10-28 09:37:32 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 29660 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-28 09:37:32 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-28 09:37:32 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-28 09:37:33 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-28 09:37:33 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-28 09:37:33 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
2025-10-28 09:37:34 [main] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [org.apache.rocketmq.spring.annotation.RocketMQMessageListenerBeanPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2025-10-28 09:37:34 [main] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [org.apache.rocketmq.spring.annotation.RocketMQMessageListenerBeanPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2025-10-28 09:37:34 [main] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'createRocketMQMessageConverter' of type [org.apache.rocketmq.spring.support.RocketMQMessageConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [org.apache.rocketmq.spring.annotation.RocketMQMessageListenerBeanPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2025-10-28 09:37:34 [main] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketmq-org.apache.rocketmq.spring.autoconfigure.RocketMQProperties' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [org.apache.rocketmq.spring.annotation.RocketMQMessageListenerBeanPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2025-10-28 09:37:34 [main] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketMQMessageListenerContainerRegistrar' of type [org.apache.rocketmq.spring.support.RocketMQMessageListenerContainerRegistrar] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [org.apache.rocketmq.spring.annotation.RocketMQMessageListenerBeanPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2025-10-28 09:37:34 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-28 09:37:34 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-28 09:37:34 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-28 09:37:34 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-28 09:37:34 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1864 ms
2025-10-28 09:37:34 [main] DEBUG o.s.w.f.ServerHttpObservationFilter - Filter 'webMvcObservationFilter' configured for use
2025-10-28 09:37:34 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-10-28 09:37:34 [redisson-netty-2-5] INFO  o.r.c.p.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-10-28 09:37:34 [redisson-netty-2-20] INFO  o.r.c.pool.MasterConnectionPool - 24 connections initialized for localhost/127.0.0.1:6379
2025-10-28 09:37:35 [main] INFO  o.a.r.s.a.RocketMQAutoConfiguration - a producer (order-timeout-producer-group) init on namesrv localhost:9876
2025-10-28 09:37:35 [main] INFO  o.a.r.s.s.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='order-timeout-consumer-group', namespace='', nameServer='localhost:9876', topic='order-timeout-topic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='timeout', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-10-28 09:37:35 [main] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:orderTimeoutMessageService, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
2025-10-28 09:37:35 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-10-28 09:37:35 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 30 mappings in 'requestMappingHandlerMapping'
2025-10-28 09:37:35 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-28 09:37:35 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-28 09:37:36 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-28 09:37:36 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-10-28 09:37:36 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-28 09:37:36 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 4.526 seconds (process running for 5.728)
2025-10-28 09:37:36 [RMI TCP Connection(3)-192.168.0.120] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-28 09:37:36 [RMI TCP Connection(1)-192.168.0.120] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-28 09:37:36 [RMI TCP Connection(3)-192.168.0.120] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-28 09:37:36 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-28 09:37:36 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-28 09:37:36 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-28 09:37:36 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@4b4e48e0
2025-10-28 09:37:36 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@6efb3920
2025-10-28 09:37:36 [RMI TCP Connection(3)-192.168.0.120] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-28 09:37:36 [RMI TCP Connection(3)-192.168.0.120] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-10-28 09:37:37 [RMI TCP Connection(1)-192.168.0.120] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2f50307a
2025-10-28 09:37:37 [RMI TCP Connection(1)-192.168.0.120] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-28 11:28:53 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-28 11:28:53 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-28 11:28:53 [http-nio-8080-exec-2] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-28 11:28:53 [http-nio-8080-exec-2] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-28 11:28:53 [http-nio-8080-exec-2] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-28 11:28:53 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-28 11:28:53 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-28 11:28:53 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-28 11:28:53 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-28 11:28:53 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-28 11:28:53 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-28 11:28:53 [http-nio-8080-exec-5] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-28 11:28:53 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-28 11:28:53 [http-nio-8080-exec-5] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 11:28:53 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-28 11:28:53 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-28 11:28:53 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-28 11:28:53 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-28 18:53:00 [main] INFO  com.jiaoyi.JiaoyiApplication - Starting JiaoyiApplication using Java 21.0.7 with PID 38236 (D:\软件\ideaproject\jiaoyi\target\classes started by Administrator in D:\软件\ideaproject\jiaoyi)
2025-10-28 18:53:00 [main] DEBUG com.jiaoyi.JiaoyiApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-10-28 18:53:00 [main] INFO  com.jiaoyi.JiaoyiApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-28 18:53:01 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-10-28 18:53:01 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-28 18:53:02 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 38 ms. Found 0 Redis repository interfaces.
2025-10-28 18:53:03 [main] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [org.apache.rocketmq.spring.annotation.RocketMQMessageListenerBeanPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2025-10-28 18:53:03 [main] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [org.apache.rocketmq.spring.annotation.RocketMQMessageListenerBeanPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2025-10-28 18:53:03 [main] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'createRocketMQMessageConverter' of type [org.apache.rocketmq.spring.support.RocketMQMessageConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [org.apache.rocketmq.spring.annotation.RocketMQMessageListenerBeanPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2025-10-28 18:53:03 [main] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketmq-org.apache.rocketmq.spring.autoconfigure.RocketMQProperties' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [org.apache.rocketmq.spring.annotation.RocketMQMessageListenerBeanPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2025-10-28 18:53:03 [main] WARN  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketMQMessageListenerContainerRegistrar' of type [org.apache.rocketmq.spring.support.RocketMQMessageListenerContainerRegistrar] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected into a currently created BeanPostProcessor [org.apache.rocketmq.spring.annotation.RocketMQMessageListenerBeanPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies.
2025-10-28 18:53:04 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-10-28 18:53:04 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-28 18:53:04 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-10-28 18:53:04 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-28 18:53:04 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 4066 ms
2025-10-28 18:53:04 [main] DEBUG o.s.w.f.ServerHttpObservationFilter - Filter 'webMvcObservationFilter' configured for use
2025-10-28 18:53:04 [main] INFO  org.redisson.Version - Redisson 3.24.3
2025-10-28 18:53:05 [redisson-netty-2-6] INFO  o.r.c.p.MasterPubSubConnectionPool - 1 connections initialized for localhost/127.0.0.1:6379
2025-10-28 18:53:05 [redisson-netty-2-20] INFO  o.r.c.pool.MasterConnectionPool - 24 connections initialized for localhost/127.0.0.1:6379
2025-10-28 18:53:07 [main] INFO  o.a.r.s.a.RocketMQAutoConfiguration - a producer (order-timeout-producer-group) init on namesrv localhost:9876
2025-10-28 18:53:08 [main] INFO  o.a.r.s.s.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='order-timeout-consumer-group', namespace='', nameServer='localhost:9876', topic='order-timeout-topic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='timeout', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-10-28 18:53:08 [main] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:orderTimeoutMessageService, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
2025-10-28 18:53:08 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-10-28 18:53:08 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 33 mappings in 'requestMappingHandlerMapping'
2025-10-28 18:53:08 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-10-28 18:53:09 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-10-28 18:53:09 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-10-28 18:53:10 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-10-28 18:53:11 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-10-28 18:53:11 [main] INFO  com.jiaoyi.JiaoyiApplication - Started JiaoyiApplication in 11.788 seconds (process running for 13.866)
2025-10-28 18:53:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 18:53:11 [scheduling-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-28 18:53:11 [scheduling-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@16206bb5
2025-10-28 18:53:11 [scheduling-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T18:13:11.093458300(LocalDateTime)
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 15
2025-10-28 18:53:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 发现 15 个超时订单需要处理
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 1(Long)
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 1(Long)
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 1, 创建时间: 2025-01-15T09:30
2025-10-28 18:53:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 1 的库存已释放
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 2(Long)
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 2(Long)
2025-10-28 18:53:11 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 2, 创建时间: 2025-01-15T10:15
2025-10-28 18:53:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 2 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 3(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 3(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 3, 创建时间: 2025-01-15T11:20
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 3 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 13(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 13(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 13, 创建时间: 2025-10-27T11:27:47
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 13 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 14(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 14(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 14, 创建时间: 2025-10-27T11:28:07
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 14 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 15(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 15(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 15, 创建时间: 2025-10-27T11:28:26
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 15 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 16(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 16(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 16, 创建时间: 2025-10-27T11:31:08
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 16 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 17(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 17(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 17, 创建时间: 2025-10-27T11:31:29
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 17 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 18(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 18(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 18, 创建时间: 2025-10-27T11:34:42
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 18 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 19(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 19(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 19, 创建时间: 2025-10-27T13:36:37
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 19 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 20(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 20(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 20, 创建时间: 2025-10-27T13:47:25
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 20 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 21(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 21(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 21, 创建时间: 2025-10-27T13:54:40
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 21 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 22(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 22(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 22, 创建时间: 2025-10-27T13:59:50
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 22 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 24(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 24(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 24, 创建时间: 2025-10-27T14:10:37
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 24 的库存已释放
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 25(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 25(Long)
2025-10-28 18:53:12 [scheduling-1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 兜底任务成功取消超时订单: 25, 创建时间: 2025-10-27T16:21:51
2025-10-28 18:53:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 订单 25 的库存已释放
2025-10-28 18:53:26 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-28 18:53:26 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@2fef5cc
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@162528d1
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-10-28 18:53:26 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment", parameters={}
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.TestController#testPayment()
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [/test-payment.html]
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/test-payment.html", parameters={}
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 304
2025-10-28 18:53:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 304 NOT_MODIFIED
2025-10-28 18:53:26 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-28 18:53:26 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-28 18:53:26 [http-nio-8080-exec-4] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-28 18:53:26 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-28 18:53:26 [http-nio-8080-exec-4] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 18:53:26 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-28 18:53:26 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-28 18:53:26 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-28 18:53:26 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-28 18:55:09 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/test-payment.html", parameters={}
2025-10-28 18:55:09 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-28 18:55:09 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:09 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-28 18:55:09 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-28 18:55:09 [http-nio-8080-exec-9] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-28 18:55:09 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-28 18:55:09 [http-nio-8080-exec-9] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 18:55:09 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-28 18:55:09 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-28 18:55:09 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-28 18:55:09 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-28 18:55:11 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders", parameters={}
2025-10-28 18:55:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#createOrder(CreateOrderRequest)
2025-10-28 18:55:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateOrderRequest(userId=94, receiverName=张三, receiverPhone=13800138000, receiverAddress=北京市朝阳区xxx街 (truncated)...]
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:EDrDKciB4hB92U17L/bIQQ==
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  c.jiaoyi.controller.OrderController - 接收到创建订单请求，用户ID: 94
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 开始创建订单，用户ID: 94
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 成功获取分布式锁，开始处理订单创建，用户ID: 94
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 检查并锁定库存，商品数量: 1
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 批量检查并锁定库存，商品数量: 1
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 检查并锁定库存，商品ID: 2002, 数量: 10
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - ==>  Preparing: SELECT * FROM inventory WHERE product_id = ?
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - ==> Parameters: 2002(Long)
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.I.selectByProductId - <==      Total: 1
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - ==>  Preparing: UPDATE inventory SET locked_stock = locked_stock + ?, update_time = NOW() WHERE product_id = ? AND (current_stock - locked_stock) >= ?
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - ==> Parameters: 10(Integer), 2002(Long), 10(Integer)
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.mapper.InventoryMapper.lockStock - <==    Updates: 1
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - ==>  Preparing: INSERT INTO inventory_transactions ( product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - ==> Parameters: 2002(Long), null, LOCK(String), 10(Integer), 999999979(Integer), 999999979(Integer), 170(Integer), 180(Integer), 下单锁定库存(String), 2025-10-28T18:55:12.086002500(LocalDateTime)
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.I.insert - <==    Updates: 1
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 库存锁定成功，商品ID: 2002, 锁定数量: 10
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.InventoryService - 批量库存锁定完成
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.CouponService - 查询优惠券，代码: DISCOUNT10
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.C.selectByCouponCode - ==>  Preparing: SELECT id, coupon_code, coupon_name, type, value, min_order_amount, max_discount_amount, status, total_quantity, used_quantity, limit_per_user, applicable_type, applicable_products, start_time, end_time, create_time, update_time FROM coupons WHERE coupon_code = ?
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.C.selectByCouponCode - ==> Parameters: DISCOUNT10(String)
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.C.selectByCouponCode - <==      Total: 1
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.C.countByUserIdAndCouponId - ==>  Preparing: SELECT COUNT(*) FROM coupon_usage WHERE user_id = ? AND coupon_id = ?
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.C.countByUserIdAndCouponId - ==> Parameters: 94(Long), 4(Long)
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.C.countByUserIdAndCouponId - <==      Total: 1
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.CouponService - 优惠券验证通过，优惠券ID: 4
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.CouponService - 计算优惠金额，优惠券类型: PERCENTAGE, 订单金额: 6000, 优惠金额: 500.00
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 优惠券验证通过，优惠金额: 500.00, 实际支付金额: 5500.00
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==>  Preparing: INSERT INTO orders ( order_no, user_id, status, total_amount, coupon_id, coupon_code, discount_amount, actual_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - ==> Parameters: ORD17616489121012266(String), 94(Long), PENDING(String), 6000(BigDecimal), 4(Long), DISCOUNT10(String), 500.00(BigDecimal), 5500.00(BigDecimal), 张三(String), 13800138000(String), 北京市朝阳区xxx街道(String), 请尽快发货(String), 2025-10-28T18:55:12.127866200(LocalDateTime), 2025-10-28T18:55:12.127866200(LocalDateTime)
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.jiaoyi.mapper.OrderMapper.insert - <==    Updates: 1
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 订单创建成功，订单号: ORD17616489121012266
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - ==>  Preparing: INSERT INTO order_items ( order_id, product_id, product_name, product_image, unit_price, quantity, subtotal ) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - ==> Parameters: 32(Long), 2002(Long), 质朴的钢鞋子(String), https://example.com/shoe.jpg(String), 600(BigDecimal), 10(Integer), 6000(BigDecimal)
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.OrderItemMapper.insertBatch - <==    Updates: 1
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.CouponService - 使用优惠券，优惠券ID: 4, 用户ID: 94, 订单ID: 32
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.C.updateUsedQuantity - ==>  Preparing: UPDATE coupons SET used_quantity = used_quantity + ?, update_time = NOW() WHERE id = ?
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.C.updateUsedQuantity - ==> Parameters: 1(Integer), 4(Long)
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.m.C.updateUsedQuantity - <==    Updates: 1
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.mapper.CouponUsageMapper.insert - ==>  Preparing: INSERT INTO coupon_usage ( coupon_id, user_id, order_id, coupon_code, discount_amount, used_time, order_amount, actual_amount, status, remark, create_time ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.mapper.CouponUsageMapper.insert - ==> Parameters: 4(Long), 94(Long), 32(Long), DISCOUNT10(String), 500.00(BigDecimal), 2025-10-28T18:55:12.219735700(LocalDateTime), 6000(BigDecimal), 5500.00(BigDecimal), USED(String), 订单使用优惠券(String), 2025-10-28T18:55:12.219735700(LocalDateTime)
2025-10-28 18:55:12 [http-nio-8080-exec-10] DEBUG c.j.mapper.CouponUsageMapper.insert - <==    Updates: 1
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.CouponService - 优惠券使用成功，使用记录ID: 28
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 优惠券使用成功，优惠券ID: 4, 优惠金额: 500.00
2025-10-28 18:55:12 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 订单创建完成，订单ID: 32, 订单号: ORD17616489121012266, 总金额: 6000, 优惠金额: 500.00, 实际支付: 5500.00
2025-10-28 18:55:15 [http-nio-8080-exec-10] INFO  c.j.s.OrderTimeoutMessageService - 发送订单超时延迟消息，订单ID: 32, 订单号: ORD17616489121012266, 延迟: 1分钟
2025-10-28 18:55:15 [http-nio-8080-exec-10] INFO  c.j.s.OrderTimeoutMessageService - 订单超时延迟消息发送成功，订单ID: 32, 延迟级别: 5
2025-10-28 18:55:15 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 订单超时延迟消息已发送，订单将在30分钟后自动取消（如果未支付），订单ID: 32, 订单号: ORD17616489121012266
2025-10-28 18:55:15 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 分布式锁已释放，用户ID: 94
2025-10-28 18:55:15 [http-nio-8080-exec-10] INFO  c.jiaoyi.controller.OrderController - 订单创建成功，订单号: ORD17616489121012266
2025-10-28 18:55:15 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:15 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=订单创建成功, data=OrderResponse(id=32, orderNo=ORD17616489121012266, userId (truncated)...]
2025-10-28 18:55:15 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:18 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/orders/32/pay", parameters={}
2025-10-28 18:55:18 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#payOrder(Long, PaymentRequest)
2025-10-28 18:55:18 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PaymentRequest(paymentMethod=ALIPAY, amount=5500, channel=WEB, clientIp=192.168.1.100, userAgent=Moz (truncated)...]
2025-10-28 18:55:18 [http-nio-8080-exec-8] INFO  c.j.a.PreventDuplicateSubmissionAspect - 成功获取锁，锁key: duplicate_submission:32_pay
2025-10-28 18:55:18 [http-nio-8080-exec-8] INFO  c.jiaoyi.controller.OrderController - 支付订单，订单ID: 32, 支付方式: ALIPAY
2025-10-28 18:55:18 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.PaymentService - 处理支付，订单ID: 32, 支付方式: ALIPAY
2025-10-28 18:55:18 [http-nio-8080-exec-8] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:55:18 [http-nio-8080-exec-8] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 32(Long)
2025-10-28 18:55:18 [http-nio-8080-exec-8] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:55:18 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.PaymentService - 调用第三方支付平台，订单ID: 32, 支付方式: ALIPAY
2025-10-28 18:55:18 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.PaymentService - 调用支付宝支付，订单ID: 32
2025-10-28 18:55:18 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.AlipayService - 创建真实支付宝支付订单，订单号: ORD17616489121012266, 金额: 5500
2025-10-28 18:55:18 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.AlipayService - 调用支付宝预下单API，订单号: ORD17616489121012266, 金额: 5500, 网关: https://openapi-sandbox.dl.alipaydev.com/gateway.do
2025-10-28 18:55:20 [http-nio-8080-exec-8] INFO  sdk.biz.info - Summary^_^10000^_^null^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.precreate&sign=oY2doHYe3mTVHzT4HLtQuiaMhTzRie05Bmd2TfyrOa3A/u0nCz9YxaW8C6EKvf5s0WAkt23R24IEhWKeMknP+h5jj3kIFQsRLI180Sqf3nl6pPojwHTgHKUXOJifWNsiRpKor3Sj/jSu7foLmtrg6xSG6a/xoAsq5FX5KxNx4ene05id43nHwnz6NScQ9n2v4FePxTfZil5/HIaySrm1uxVKsFfFC/q1Ty3oaAo/KAKGa5CZWMFtqS6bXQieXD+0aXlHu9RD48ReYZ7/uJwY+H3xNebRZk4mHth7OVmsG5G5Mq2ZaKyNwL06lpQT93rCnl6HeLPzcuYB1K1Go8UOhw==&return_url=https://dorotha-gloomful-elfrieda.ngrok-free.dev/api/payment/alipay/return&notify_url=https://dorotha-gloomful-elfrieda.ngrok-free.dev/api/payment/alipay/notify&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-28 18:55:18^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=json^_^ApplicationParams:biz_content={"body":"商品购买","out_trade_no":"ORD17616489121012266","subject":"订单支付：ORD17616489121012266","timeout_express":"30m","total_amount":"5500"}^_^43ms,1302ms,49ms^_^trace_id:0601d6c717616489191993923919487
2025-10-28 18:55:20 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.AlipayService - 支付宝API响应 - 成功: true, 错误码: 10000, 错误信息: Success, 二维码: https://qr.alipay.com/bax06709hjbfxqspklo100a8
2025-10-28 18:55:20 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.AlipayService - 支付宝预下单成功，订单号: ORD17616489121012266, 二维码: https://qr.alipay.com/bax06709hjbfxqspklo100a8
2025-10-28 18:55:20 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:20 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=支付处理成功, data=PaymentResponse(paymentNo=PAY1761648918785E6DF3CBA, statu (truncated)...]
2025-10-28 18:55:20 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:25 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/", parameters={}
2025-10-28 18:55:25 [http-nio-8080-exec-6] DEBUG o.s.w.s.v.ContentNegotiatingViewResolver - Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
2025-10-28 18:55:25 [http-nio-8080-exec-6] DEBUG o.s.w.s.view.InternalResourceView - View name 'forward:', model {}
2025-10-28 18:55:25 [http-nio-8080-exec-6] DEBUG o.s.w.s.view.InternalResourceView - Forwarding to [index.html]
2025-10-28 18:55:25 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - "FORWARD" dispatch for GET "/index.html", parameters={}
2025-10-28 18:55:25 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-28 18:55:25 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "FORWARD" dispatch, status 200
2025-10-28 18:55:25 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/orders", parameters={}
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#getAllOrders()
2025-10-28 18:55:25 [http-nio-8080-exec-2] INFO  c.jiaoyi.controller.OrderController - 获取所有订单
2025-10-28 18:55:25 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 获取所有订单
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectAll - ==>  Preparing: SELECT * FROM orders ORDER BY create_time DESC
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectAll - ==> Parameters: 
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.mapper.OrderMapper.selectAll - <==      Total: 32
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 32(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 31(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 30(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 29(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 28(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 27(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 26(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 25(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 24(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 23(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 22(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 21(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 20(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 19(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 18(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 17(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 16(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 15(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 14(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 13(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 3(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 2(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 1(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 6(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 5(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 4(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 9(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 8(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 7(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 3
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 11(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 10(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 12(Long)
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:25 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=获取订单列表成功, data=[OrderResponse(id=32, orderNo=ORD17616489121012266, use (truncated)...]
2025-10-28 18:55:25 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-28 18:55:25 [http-nio-8080-exec-7] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-28 18:55:25 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-28 18:55:25 [http-nio-8080-exec-7] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 18:55:25 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-28 18:55:25 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-28 18:55:25 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-28 18:55:25 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-28 18:55:25 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/payment/query/ORD17616489121012266", parameters={}
2025-10-28 18:55:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#queryPayment(String)
2025-10-28 18:55:26 [http-nio-8080-exec-1] INFO  c.j.controller.PaymentController - 查询支付结果，支付流水号: ORD17616489121012266
2025-10-28 18:55:26 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.AlipayService - 查询真实支付宝支付结果，订单号: ORD17616489121012266
2025-10-28 18:55:26 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.AlipayService - 调用支付宝查询API，订单号: ORD17616489121012266, 网关: https://openapi-sandbox.dl.alipaydev.com/gateway.do
2025-10-28 18:55:26 [http-nio-8080-exec-1] ERROR sdk.biz.err - ErrorScene^_^40004^_^ACQ.TRADE_NOT_EXIST^_^null^_^Windows 10^_^2025-10-28 18:55:26^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.query&sign=HSjw4PH/R0GzW2YrXUkMNBVfr7nxdqV8uVJfOslX/XQq9L9tWJxpP6bTN/9Z5lYUdnh4euCXDClsVpAyzXWZfCmBQvwnc4iTToKphUFfun2peh8qzPRkyf8EPgGotzV3WmkatYJXpOL65r1mucYo8dBWPZTl7rWnvjZL6cnw6i35z7XQvOeT+6pltrPLA1RrkFj+EmhIM7hhuZz7W9iIqo8EDtdMs7rNYz1AHZFNrTXfVdkKc13SyyMX48DWWxKetrd8qHQQHzPnwL6MEopNBY+o+TudxB017sfyhIgwj+oHqOsbtnHrSoywL8+Gi7HIByM1kJ4VzAV7TlAcnuPBTQ==&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-28 18:55:26^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=json^_^ApplicationParams:traceId=060389ba176164892622167331954925&biz_content={"out_trade_no":"ORD17616489121012266"}^_^Body:{"alipay_trade_query_response":{"msg":"Business Failed","code":"40004","out_trade_no":"ORD17616489121012266","sub_msg":"交易不存在","sub_code":"ACQ.TRADE_NOT_EXIST","receipt_amount":"0.00","point_amount":"0.00","buyer_pay_amount":"0.00","invoice_amount":"0.00"},"sign":"WFHIP66m/ndamB9ILV0o8Ym8T5FvSND19bZ1dzyKh0zcsbxsnETYFEpBjt/RMT5xrtAkK7Ok5hq5VuJ+6f0BmSfOl97Qf6wBldK4AQ0MkSJOuyQrKUj87RaCRUPyjbkTOB+D8PJE8mX5KRanlM5CPTU4AmDGjL1sME6cFpVG114YQ5sDeqS9o0jQzvvX1fBnFHspdiFQjB/sxq65BNw0SbGRnY6EQIGSMnvboGGbtGJ5vCQSykgOGLSPynm/WrplfAxs+1UP9ZRgP51cZ1I4P8wjVMOoAhMmp7EL4QN7eDruY3PuRJKx5bZ6bZPg0QccOIPvi3DEUwymC0R/PvMUJA=="}^_^16ms,499ms,36ms^_^trace_id:060389ba176164892622167331954925
2025-10-28 18:55:26 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.AlipayService - 支付宝查询响应 - 成功: false, 错误码: 40004, 错误信息: Business Failed, 交易状态: null
2025-10-28 18:55:26 [http-nio-8080-exec-1] ERROR com.jiaoyi.service.AlipayService - 支付宝支付查询失败，错误码: 40004, 错误信息: Business Failed, 子错误码: ACQ.TRADE_NOT_EXIST, 子错误信息: 交易不存在
2025-10-28 18:55:26 [http-nio-8080-exec-1] ERROR c.j.controller.PaymentController - 查询支付结果失败
java.lang.RuntimeException: 支付宝支付查询失败: Business Failed - 交易不存在
	at com.jiaoyi.service.AlipayService.queryPayment(AlipayService.java:163)
	at com.jiaoyi.controller.PaymentController.queryPayment(PaymentController.java:163)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 18:55:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=查询失败: 支付宝支付查询失败: Business Failed - 交易不存在, data=null)]
2025-10-28 18:55:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:27 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/my-orders.html", parameters={}
2025-10-28 18:55:27 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-28 18:55:27 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/orders/user/1001", parameters={}
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#getOrdersByUserId(Long)
2025-10-28 18:55:27 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 查询用户订单列表，用户ID: 1001
2025-10-28 18:55:27 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 查询用户订单列表，用户ID: 1001
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG c.j.m.OrderMapper.selectByUserId - ==>  Preparing: SELECT * FROM orders WHERE user_id = ? ORDER BY create_time DESC
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG c.j.m.OrderMapper.selectByUserId - ==> Parameters: 1001(Long)
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG c.j.m.OrderMapper.selectByUserId - <==      Total: 2
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 1(Long)
2025-10-28 18:55:27 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/favicon.ico", parameters={}
2025-10-28 18:55:27 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:27 [http-nio-8080-exec-3] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:27 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 6(Long)
2025-10-28 18:55:27 [http-nio-8080-exec-3] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:27 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json;q=0.8', given [image/avif, image/webp, image/apng, image/svg+xml, image/*, */*;q=0.8] and supported [application/json, application/*+json]
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:27 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=系统内部错误, data=null)]
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=操作成功, data=[OrderResponse(id=1, orderNo=ORD202501150001, userId=1001,  (truncated)...]
2025-10-28 18:55:27 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource favicon.ico.]
2025-10-28 18:55:27 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 500 INTERNAL_SERVER_ERROR
2025-10-28 18:55:27 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:31 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/payment/query/ORD17616489121012266", parameters={}
2025-10-28 18:55:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#queryPayment(String)
2025-10-28 18:55:31 [http-nio-8080-exec-9] INFO  c.j.controller.PaymentController - 查询支付结果，支付流水号: ORD17616489121012266
2025-10-28 18:55:31 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.AlipayService - 查询真实支付宝支付结果，订单号: ORD17616489121012266
2025-10-28 18:55:31 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.AlipayService - 调用支付宝查询API，订单号: ORD17616489121012266, 网关: https://openapi-sandbox.dl.alipaydev.com/gateway.do
2025-10-28 18:55:31 [http-nio-8080-exec-9] ERROR sdk.biz.err - ErrorScene^_^40004^_^ACQ.TRADE_NOT_EXIST^_^null^_^Windows 10^_^2025-10-28 18:55:31^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.query&sign=JtvWSdasQgNP4/zcR+Aax4eo5lAc5J1WDjg8IU7guiiHk5FlsZE55AIScQeNxeOz4xQHpWx4YzGhrlrfS2U+NmRv0NNeeWS/OUDQSF91sFGP9UdU5L7obFaBDgsrxciZLo/7faHzAX2Kf91GGw1p1O97zHd5SFO4b6Tt+hPuArLbv+KHSO/XFHgYYJMUsDL8785/guxYJJOaSwqidBPMsV+KZG0lWST2ti6m7rJpt72RDv/V5XldMYLKaAsIxHcyCXKKQtQB8zl2lEEke1LM+t+XspChhf4mvU25+KFzmhF05R/jFgw1m/wfiYaC7QFR3/RjEcWOg/EfljSNWalYng==&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-28 18:55:31^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=json^_^ApplicationParams:traceId=0601d6c717616489311364086919487&biz_content={"out_trade_no":"ORD17616489121012266"}^_^Body:{"alipay_trade_query_response":{"msg":"Business Failed","code":"40004","out_trade_no":"ORD17616489121012266","sub_msg":"交易不存在","sub_code":"ACQ.TRADE_NOT_EXIST","receipt_amount":"0.00","point_amount":"0.00","buyer_pay_amount":"0.00","invoice_amount":"0.00"},"sign":"WFHIP66m/ndamB9ILV0o8Ym8T5FvSND19bZ1dzyKh0zcsbxsnETYFEpBjt/RMT5xrtAkK7Ok5hq5VuJ+6f0BmSfOl97Qf6wBldK4AQ0MkSJOuyQrKUj87RaCRUPyjbkTOB+D8PJE8mX5KRanlM5CPTU4AmDGjL1sME6cFpVG114YQ5sDeqS9o0jQzvvX1fBnFHspdiFQjB/sxq65BNw0SbGRnY6EQIGSMnvboGGbtGJ5vCQSykgOGLSPynm/WrplfAxs+1UP9ZRgP51cZ1I4P8wjVMOoAhMmp7EL4QN7eDruY3PuRJKx5bZ6bZPg0QccOIPvi3DEUwymC0R/PvMUJA=="}^_^14ms,204ms,17ms^_^trace_id:0601d6c717616489311364086919487
2025-10-28 18:55:31 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.AlipayService - 支付宝查询响应 - 成功: false, 错误码: 40004, 错误信息: Business Failed, 交易状态: null
2025-10-28 18:55:31 [http-nio-8080-exec-9] ERROR com.jiaoyi.service.AlipayService - 支付宝支付查询失败，错误码: 40004, 错误信息: Business Failed, 子错误码: ACQ.TRADE_NOT_EXIST, 子错误信息: 交易不存在
2025-10-28 18:55:31 [http-nio-8080-exec-9] ERROR c.j.controller.PaymentController - 查询支付结果失败
java.lang.RuntimeException: 支付宝支付查询失败: Business Failed - 交易不存在
	at com.jiaoyi.service.AlipayService.queryPayment(AlipayService.java:163)
	at com.jiaoyi.controller.PaymentController.queryPayment(PaymentController.java:163)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 18:55:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:31 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=查询失败: 支付宝支付查询失败: Business Failed - 交易不存在, data=null)]
2025-10-28 18:55:31 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:31 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/orders/user/92", parameters={}
2025-10-28 18:55:31 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#getOrdersByUserId(Long)
2025-10-28 18:55:31 [http-nio-8080-exec-10] INFO  c.jiaoyi.controller.OrderController - 查询用户订单列表，用户ID: 92
2025-10-28 18:55:31 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 查询用户订单列表，用户ID: 92
2025-10-28 18:55:31 [http-nio-8080-exec-10] DEBUG c.j.m.OrderMapper.selectByUserId - ==>  Preparing: SELECT * FROM orders WHERE user_id = ? ORDER BY create_time DESC
2025-10-28 18:55:31 [http-nio-8080-exec-10] DEBUG c.j.m.OrderMapper.selectByUserId - ==> Parameters: 92(Long)
2025-10-28 18:55:31 [http-nio-8080-exec-10] DEBUG c.j.m.OrderMapper.selectByUserId - <==      Total: 0
2025-10-28 18:55:31 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:31 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=操作成功, data=[])]
2025-10-28 18:55:31 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:34 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/orders/user/95", parameters={}
2025-10-28 18:55:34 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#getOrdersByUserId(Long)
2025-10-28 18:55:34 [http-nio-8080-exec-8] INFO  c.jiaoyi.controller.OrderController - 查询用户订单列表，用户ID: 95
2025-10-28 18:55:34 [http-nio-8080-exec-8] INFO  com.jiaoyi.service.OrderService - 查询用户订单列表，用户ID: 95
2025-10-28 18:55:34 [http-nio-8080-exec-8] DEBUG c.j.m.OrderMapper.selectByUserId - ==>  Preparing: SELECT * FROM orders WHERE user_id = ? ORDER BY create_time DESC
2025-10-28 18:55:34 [http-nio-8080-exec-8] DEBUG c.j.m.OrderMapper.selectByUserId - ==> Parameters: 95(Long)
2025-10-28 18:55:34 [http-nio-8080-exec-8] DEBUG c.j.m.OrderMapper.selectByUserId - <==      Total: 0
2025-10-28 18:55:34 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:34 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=操作成功, data=[])]
2025-10-28 18:55:34 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:36 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/payment/query/ORD17616489121012266", parameters={}
2025-10-28 18:55:36 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#queryPayment(String)
2025-10-28 18:55:36 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 查询支付结果，支付流水号: ORD17616489121012266
2025-10-28 18:55:36 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 查询真实支付宝支付结果，订单号: ORD17616489121012266
2025-10-28 18:55:36 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 调用支付宝查询API，订单号: ORD17616489121012266, 网关: https://openapi-sandbox.dl.alipaydev.com/gateway.do
2025-10-28 18:55:36 [http-nio-8080-exec-6] ERROR sdk.biz.err - ErrorScene^_^40004^_^ACQ.TRADE_NOT_EXIST^_^null^_^Windows 10^_^2025-10-28 18:55:36^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.query&sign=jeKbOe+/q0XeeedMo1foeqZMHIrH81jTMto/HrcEeDqJYn/crrc4/H9Ql2WBycm8GaoO+ZZK/uY4Nq1UxmXfPbXEdJLRG0hsqqUd1xRXKdcrc69OZPhOwXPGUl9VfSo3AXFmK3nbQVjW58iT8jPLMeevA5oyuRgCvQsfdT9lN9rulMGsArIaf1qga7g9xM5y84poMjpdR1yWrwKsg8KrKn0ddZhn5sO1BF5dLQESSLCry8JvRHZgVfZ/PAOt0F1ATDt8XiLgRIkeHMTeWEG626WTlEfgfSm3CoLNcBYgFlrzUj53aR3KSZjoNwCTmCaQEXDFP/vNGm6t3QPnGnflSg==&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-28 18:55:36^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=json^_^ApplicationParams:traceId=06013ec2176164893613467931436129&biz_content={"out_trade_no":"ORD17616489121012266"}^_^Body:{"alipay_trade_query_response":{"msg":"Business Failed","code":"40004","out_trade_no":"ORD17616489121012266","sub_msg":"交易不存在","sub_code":"ACQ.TRADE_NOT_EXIST","receipt_amount":"0.00","point_amount":"0.00","buyer_pay_amount":"0.00","invoice_amount":"0.00"},"sign":"WFHIP66m/ndamB9ILV0o8Ym8T5FvSND19bZ1dzyKh0zcsbxsnETYFEpBjt/RMT5xrtAkK7Ok5hq5VuJ+6f0BmSfOl97Qf6wBldK4AQ0MkSJOuyQrKUj87RaCRUPyjbkTOB+D8PJE8mX5KRanlM5CPTU4AmDGjL1sME6cFpVG114YQ5sDeqS9o0jQzvvX1fBnFHspdiFQjB/sxq65BNw0SbGRnY6EQIGSMnvboGGbtGJ5vCQSykgOGLSPynm/WrplfAxs+1UP9ZRgP51cZ1I4P8wjVMOoAhMmp7EL4QN7eDruY3PuRJKx5bZ6bZPg0QccOIPvi3DEUwymC0R/PvMUJA=="}^_^15ms,314ms,16ms^_^trace_id:06013ec2176164893613467931436129
2025-10-28 18:55:36 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 支付宝查询响应 - 成功: false, 错误码: 40004, 错误信息: Business Failed, 交易状态: null
2025-10-28 18:55:36 [http-nio-8080-exec-6] ERROR com.jiaoyi.service.AlipayService - 支付宝支付查询失败，错误码: 40004, 错误信息: Business Failed, 子错误码: ACQ.TRADE_NOT_EXIST, 子错误信息: 交易不存在
2025-10-28 18:55:36 [http-nio-8080-exec-6] ERROR c.j.controller.PaymentController - 查询支付结果失败
java.lang.RuntimeException: 支付宝支付查询失败: Business Failed - 交易不存在
	at com.jiaoyi.service.AlipayService.queryPayment(AlipayService.java:163)
	at com.jiaoyi.controller.PaymentController.queryPayment(PaymentController.java:163)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 18:55:36 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:36 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=查询失败: 支付宝支付查询失败: Business Failed - 交易不存在, data=null)]
2025-10-28 18:55:36 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:37 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/orders/user/96", parameters={}
2025-10-28 18:55:37 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#getOrdersByUserId(Long)
2025-10-28 18:55:37 [http-nio-8080-exec-2] INFO  c.jiaoyi.controller.OrderController - 查询用户订单列表，用户ID: 96
2025-10-28 18:55:37 [http-nio-8080-exec-2] INFO  com.jiaoyi.service.OrderService - 查询用户订单列表，用户ID: 96
2025-10-28 18:55:37 [http-nio-8080-exec-2] DEBUG c.j.m.OrderMapper.selectByUserId - ==>  Preparing: SELECT * FROM orders WHERE user_id = ? ORDER BY create_time DESC
2025-10-28 18:55:37 [http-nio-8080-exec-2] DEBUG c.j.m.OrderMapper.selectByUserId - ==> Parameters: 96(Long)
2025-10-28 18:55:37 [http-nio-8080-exec-2] DEBUG c.j.m.OrderMapper.selectByUserId - <==      Total: 0
2025-10-28 18:55:37 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:37 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=操作成功, data=[])]
2025-10-28 18:55:37 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:40 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/payment/query/ORD17616489121012266", parameters={}
2025-10-28 18:55:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#queryPayment(String)
2025-10-28 18:55:40 [http-nio-8080-exec-7] INFO  c.j.controller.PaymentController - 查询支付结果，支付流水号: ORD17616489121012266
2025-10-28 18:55:40 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.AlipayService - 查询真实支付宝支付结果，订单号: ORD17616489121012266
2025-10-28 18:55:40 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.AlipayService - 调用支付宝查询API，订单号: ORD17616489121012266, 网关: https://openapi-sandbox.dl.alipaydev.com/gateway.do
2025-10-28 18:55:40 [http-nio-8080-exec-7] ERROR sdk.biz.err - ErrorScene^_^40004^_^ACQ.TRADE_NOT_EXIST^_^null^_^Windows 10^_^2025-10-28 18:55:40^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.query&sign=i0X+7ONE8gk+fwAnjisz9Hg//QYUZFPLmsrJ0yE68VMhePYGsnPOcbPcM//r9zsZaruq3T9QdTFCAq3TRSAHYBUgSoAEc4l6MWkt0wMpUR3pjRWqYqLpG2Zn5ysx2XDnsWdcTWaLMx6AFQGZBaqB7fntcAIxMSmWnKskCyDM4qPFXFXUfOtr70lnpDiHyBYMSQsr63Nhu91meSaD/sP0ZqzKh3g0HSneHyMIWRCB2sPS41qcFYiarIjGPqv0zdWjwgKp/lWCCSWWoTusSPJ7iv0lI8GgUfqRu3BDHJskMem/QTwRZVnCLPSXvcruwrsD5IEO1B9V0qOaHKPElBZ4Vg==&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-28 18:55:40^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=json^_^ApplicationParams:traceId=0601ac3e176164894040964484904&biz_content={"out_trade_no":"ORD17616489121012266"}^_^Body:{"alipay_trade_query_response":{"msg":"Business Failed","code":"40004","out_trade_no":"ORD17616489121012266","sub_msg":"交易不存在","sub_code":"ACQ.TRADE_NOT_EXIST","receipt_amount":"0.00","point_amount":"0.00","buyer_pay_amount":"0.00","invoice_amount":"0.00"},"sign":"WFHIP66m/ndamB9ILV0o8Ym8T5FvSND19bZ1dzyKh0zcsbxsnETYFEpBjt/RMT5xrtAkK7Ok5hq5VuJ+6f0BmSfOl97Qf6wBldK4AQ0MkSJOuyQrKUj87RaCRUPyjbkTOB+D8PJE8mX5KRanlM5CPTU4AmDGjL1sME6cFpVG114YQ5sDeqS9o0jQzvvX1fBnFHspdiFQjB/sxq65BNw0SbGRnY6EQIGSMnvboGGbtGJ5vCQSykgOGLSPynm/WrplfAxs+1UP9ZRgP51cZ1I4P8wjVMOoAhMmp7EL4QN7eDruY3PuRJKx5bZ6bZPg0QccOIPvi3DEUwymC0R/PvMUJA=="}^_^15ms,398ms,14ms^_^trace_id:0601ac3e176164894040964484904
2025-10-28 18:55:40 [http-nio-8080-exec-7] INFO  com.jiaoyi.service.AlipayService - 支付宝查询响应 - 成功: false, 错误码: 40004, 错误信息: Business Failed, 交易状态: null
2025-10-28 18:55:40 [http-nio-8080-exec-7] ERROR com.jiaoyi.service.AlipayService - 支付宝支付查询失败，错误码: 40004, 错误信息: Business Failed, 子错误码: ACQ.TRADE_NOT_EXIST, 子错误信息: 交易不存在
2025-10-28 18:55:40 [http-nio-8080-exec-7] ERROR c.j.controller.PaymentController - 查询支付结果失败
java.lang.RuntimeException: 支付宝支付查询失败: Business Failed - 交易不存在
	at com.jiaoyi.service.AlipayService.queryPayment(AlipayService.java:163)
	at com.jiaoyi.controller.PaymentController.queryPayment(PaymentController.java:163)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 18:55:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=查询失败: 支付宝支付查询失败: Business Failed - 交易不存在, data=null)]
2025-10-28 18:55:40 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/orders/user/94", parameters={}
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#getOrdersByUserId(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] INFO  c.jiaoyi.controller.OrderController - 查询用户订单列表，用户ID: 94
2025-10-28 18:55:44 [http-nio-8080-exec-1] INFO  com.jiaoyi.service.OrderService - 查询用户订单列表，用户ID: 94
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.OrderMapper.selectByUserId - ==>  Preparing: SELECT * FROM orders WHERE user_id = ? ORDER BY create_time DESC
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.OrderMapper.selectByUserId - ==> Parameters: 94(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.OrderMapper.selectByUserId - <==      Total: 20
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 32(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 31(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 30(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 29(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 28(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 27(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 26(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 25(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 24(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 23(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 22(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 21(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 20(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 19(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 18(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 17(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 16(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 15(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 14(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 13(Long)
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=操作成功, data=[OrderResponse(id=32, orderNo=ORD17616489121012266, userId= (truncated)...]
2025-10-28 18:55:44 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:46 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/payment/query/ORD17616489121012266", parameters={}
2025-10-28 18:55:46 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#queryPayment(String)
2025-10-28 18:55:46 [http-nio-8080-exec-4] INFO  c.j.controller.PaymentController - 查询支付结果，支付流水号: ORD17616489121012266
2025-10-28 18:55:46 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 查询真实支付宝支付结果，订单号: ORD17616489121012266
2025-10-28 18:55:46 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 调用支付宝查询API，订单号: ORD17616489121012266, 网关: https://openapi-sandbox.dl.alipaydev.com/gateway.do
2025-10-28 18:55:46 [http-nio-8080-exec-4] ERROR sdk.biz.err - ErrorScene^_^40004^_^ACQ.TRADE_NOT_EXIST^_^null^_^Windows 10^_^2025-10-28 18:55:46^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.query&sign=YQlMc4BAJFfE++H11Ryq/zi/zkz2tP6/OSPSwwi34LSurx5BxR/0AFu6zj5OyaKPi5xxlNXEx70a5RXarydRiP91zA4z2jo0Dh78CS8RUkJNnc9bGWJ2AY4ncDpsksxJ1qSxAOTZz3hm5AlanALoxvg/zfRwwqjyYxlBUI5V0q86bqUjN5ZXaoE8x0DKla0i4TZsjTAVW9/lQj+gYGjtax60abECCGx8Z8+XqiwOIGRICl1MHgXdMN8I8iWmFZu+dlYDitElMiniXiFlzwNjlpGIvbjRO2gI9ijm7my3+nt9AC2TTfwDNmoF5vO+7yMXqwilTuYQMRVdwPp1TIVxbg==&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-28 18:55:46^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=json^_^ApplicationParams:traceId=0601d58b176164894620835121407451&biz_content={"out_trade_no":"ORD17616489121012266"}^_^Body:{"alipay_trade_query_response":{"msg":"Business Failed","code":"40004","out_trade_no":"ORD17616489121012266","sub_msg":"交易不存在","sub_code":"ACQ.TRADE_NOT_EXIST","receipt_amount":"0.00","point_amount":"0.00","buyer_pay_amount":"0.00","invoice_amount":"0.00"},"sign":"WFHIP66m/ndamB9ILV0o8Ym8T5FvSND19bZ1dzyKh0zcsbxsnETYFEpBjt/RMT5xrtAkK7Ok5hq5VuJ+6f0BmSfOl97Qf6wBldK4AQ0MkSJOuyQrKUj87RaCRUPyjbkTOB+D8PJE8mX5KRanlM5CPTU4AmDGjL1sME6cFpVG114YQ5sDeqS9o0jQzvvX1fBnFHspdiFQjB/sxq65BNw0SbGRnY6EQIGSMnvboGGbtGJ5vCQSykgOGLSPynm/WrplfAxs+1UP9ZRgP51cZ1I4P8wjVMOoAhMmp7EL4QN7eDruY3PuRJKx5bZ6bZPg0QccOIPvi3DEUwymC0R/PvMUJA=="}^_^15ms,393ms,16ms^_^trace_id:0601d58b176164894620835121407451
2025-10-28 18:55:46 [http-nio-8080-exec-4] INFO  com.jiaoyi.service.AlipayService - 支付宝查询响应 - 成功: false, 错误码: 40004, 错误信息: Business Failed, 交易状态: null
2025-10-28 18:55:46 [http-nio-8080-exec-4] ERROR com.jiaoyi.service.AlipayService - 支付宝支付查询失败，错误码: 40004, 错误信息: Business Failed, 子错误码: ACQ.TRADE_NOT_EXIST, 子错误信息: 交易不存在
2025-10-28 18:55:46 [http-nio-8080-exec-4] ERROR c.j.controller.PaymentController - 查询支付结果失败
java.lang.RuntimeException: 支付宝支付查询失败: Business Failed - 交易不存在
	at com.jiaoyi.service.AlipayService.queryPayment(AlipayService.java:163)
	at com.jiaoyi.controller.PaymentController.queryPayment(PaymentController.java:163)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 18:55:46 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:46 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=查询失败: 支付宝支付查询失败: Business Failed - 交易不存在, data=null)]
2025-10-28 18:55:46 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:55:51 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/payment/query/ORD17616489121012266", parameters={}
2025-10-28 18:55:51 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#queryPayment(String)
2025-10-28 18:55:51 [http-nio-8080-exec-3] INFO  c.j.controller.PaymentController - 查询支付结果，支付流水号: ORD17616489121012266
2025-10-28 18:55:51 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.AlipayService - 查询真实支付宝支付结果，订单号: ORD17616489121012266
2025-10-28 18:55:51 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.AlipayService - 调用支付宝查询API，订单号: ORD17616489121012266, 网关: https://openapi-sandbox.dl.alipaydev.com/gateway.do
2025-10-28 18:55:51 [http-nio-8080-exec-3] ERROR sdk.biz.err - ErrorScene^_^40004^_^ACQ.TRADE_NOT_EXIST^_^null^_^Windows 10^_^2025-10-28 18:55:51^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.query&sign=mbq0Cei5cig0WMVDyd1sHqOpk5GHf5sfSEUDST2bo4HJYDscbh4HOLANd0ujVXWKP/CVqcJqSJJBFrx9ws1w3n8LuMEAVkHkJstVLcSR+BAp177Xtw1fZeGyeU/cAwOyIn5WMOwKjLf8PPMjhJPh/XsVbDB7BOAOZs98M6JACAGUuI6r+d4pI3sIKRudGC6rx4ZeDXPYlMv6nFxWk7PAiJ3ULQvnJ7YwJfh1PE3dkqDtkITvBK5vxGS/yZG70ZwMJ8Vl0ttsp1m/RELcyYUNQDhXRxah6+OHvh+YcjouXGjW1yYBs3zauOruq1c0D+57GOaxIpCWtKmPDksLtiklPg==&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-28 18:55:51^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=json^_^ApplicationParams:traceId=06013ec2176164895113269941436129&biz_content={"out_trade_no":"ORD17616489121012266"}^_^Body:{"alipay_trade_query_response":{"msg":"Business Failed","code":"40004","out_trade_no":"ORD17616489121012266","sub_msg":"交易不存在","sub_code":"ACQ.TRADE_NOT_EXIST","receipt_amount":"0.00","point_amount":"0.00","buyer_pay_amount":"0.00","invoice_amount":"0.00"},"sign":"WFHIP66m/ndamB9ILV0o8Ym8T5FvSND19bZ1dzyKh0zcsbxsnETYFEpBjt/RMT5xrtAkK7Ok5hq5VuJ+6f0BmSfOl97Qf6wBldK4AQ0MkSJOuyQrKUj87RaCRUPyjbkTOB+D8PJE8mX5KRanlM5CPTU4AmDGjL1sME6cFpVG114YQ5sDeqS9o0jQzvvX1fBnFHspdiFQjB/sxq65BNw0SbGRnY6EQIGSMnvboGGbtGJ5vCQSykgOGLSPynm/WrplfAxs+1UP9ZRgP51cZ1I4P8wjVMOoAhMmp7EL4QN7eDruY3PuRJKx5bZ6bZPg0QccOIPvi3DEUwymC0R/PvMUJA=="}^_^15ms,190ms,15ms^_^trace_id:06013ec2176164895113269941436129
2025-10-28 18:55:51 [http-nio-8080-exec-3] INFO  com.jiaoyi.service.AlipayService - 支付宝查询响应 - 成功: false, 错误码: 40004, 错误信息: Business Failed, 交易状态: null
2025-10-28 18:55:51 [http-nio-8080-exec-3] ERROR com.jiaoyi.service.AlipayService - 支付宝支付查询失败，错误码: 40004, 错误信息: Business Failed, 子错误码: ACQ.TRADE_NOT_EXIST, 子错误信息: 交易不存在
2025-10-28 18:55:51 [http-nio-8080-exec-3] ERROR c.j.controller.PaymentController - 查询支付结果失败
java.lang.RuntimeException: 支付宝支付查询失败: Business Failed - 交易不存在
	at com.jiaoyi.service.AlipayService.queryPayment(AlipayService.java:163)
	at com.jiaoyi.controller.PaymentController.queryPayment(PaymentController.java:163)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:254)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:182)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 18:55:51 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:55:51 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=查询失败: 支付宝支付查询失败: Business Failed - 交易不存在, data=null)]
2025-10-28 18:55:51 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/orders/user/94", parameters={}
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#getOrdersByUserId(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] INFO  c.jiaoyi.controller.OrderController - 查询用户订单列表，用户ID: 94
2025-10-28 18:56:12 [http-nio-8080-exec-5] INFO  com.jiaoyi.service.OrderService - 查询用户订单列表，用户ID: 94
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.OrderMapper.selectByUserId - ==>  Preparing: SELECT * FROM orders WHERE user_id = ? ORDER BY create_time DESC
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.OrderMapper.selectByUserId - ==> Parameters: 94(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.OrderMapper.selectByUserId - <==      Total: 20
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 32(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 31(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 30(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 29(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 28(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 27(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 26(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 25(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 24(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 23(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 22(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 21(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 20(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 19(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 18(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 17(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 16(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 15(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 14(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 13(Long)
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=操作成功, data=[OrderResponse(id=32, orderNo=ORD17616489121012266, userId= (truncated)...]
2025-10-28 18:56:12 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/orders/user/94", parameters={}
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#getOrdersByUserId(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] INFO  c.jiaoyi.controller.OrderController - 查询用户订单列表，用户ID: 94
2025-10-28 18:56:13 [http-nio-8080-exec-9] INFO  com.jiaoyi.service.OrderService - 查询用户订单列表，用户ID: 94
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.OrderMapper.selectByUserId - ==>  Preparing: SELECT * FROM orders WHERE user_id = ? ORDER BY create_time DESC
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.OrderMapper.selectByUserId - ==> Parameters: 94(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.OrderMapper.selectByUserId - <==      Total: 20
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 32(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 31(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 30(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 29(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 28(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 27(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 26(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 25(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 24(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 23(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 22(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 21(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 20(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 19(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 18(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 17(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 16(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 15(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 14(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 13(Long)
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=操作成功, data=[OrderResponse(id=32, orderNo=ORD17616489121012266, userId= (truncated)...]
2025-10-28 18:56:13 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:56:15 [ConsumeMessageThread_order-timeout-consumer-group_1] INFO  c.j.s.OrderTimeoutMessageService - 接收到订单超时消息，订单ID: 32, 订单号: ORD17616489121012266
2025-10-28 18:56:21 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.mapper.OrderMapper.selectById - ==>  Preparing: SELECT * FROM orders WHERE id = ?
2025-10-28 18:56:21 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.mapper.OrderMapper.selectById - ==> Parameters: 32(Long)
2025-10-28 18:56:21 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.mapper.OrderMapper.selectById - <==      Total: 1
2025-10-28 18:56:21 [ConsumeMessageThread_order-timeout-consumer-group_1] INFO  c.j.s.OrderTimeoutMessageService - 开始处理超时订单，订单ID: 32, 订单号: ORD17616489121012266
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.O.updateStatusIfPending - ==>  Preparing: UPDATE orders SET status = ?, update_time = NOW() WHERE id = ? AND status = 'PENDING'
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.O.updateStatusIfPending - ==> Parameters: CANCELLED(String), 32(Long)
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.O.updateStatusIfPending - <==    Updates: 1
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] INFO  c.j.s.OrderTimeoutMessageService - 订单超时取消成功，订单ID: 32, 订单号: ORD17616489121012266
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] INFO  com.jiaoyi.service.CouponService - 退款优惠券，订单ID: 32
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.C.selectByOrderId - ==>  Preparing: SELECT id, coupon_id, user_id, order_id, coupon_code, discount_amount, used_time, order_amount, actual_amount, status, remark, create_time FROM coupon_usage WHERE order_id = ?
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.C.selectByOrderId - ==> Parameters: 32(Long)
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.C.selectByOrderId - <==      Total: 1
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.CouponUsageMapper.updateStatus - ==>  Preparing: UPDATE coupon_usage SET status = ? WHERE id = ?
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.CouponUsageMapper.updateStatus - ==> Parameters: REFUNDED(String), 28(Long)
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.CouponUsageMapper.updateStatus - <==    Updates: 1
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.C.updateUsedQuantity - ==>  Preparing: UPDATE coupons SET used_quantity = used_quantity + ?, update_time = NOW() WHERE id = ?
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.C.updateUsedQuantity - ==> Parameters: -1(Integer), 4(Long)
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] DEBUG c.j.m.C.updateUsedQuantity - <==    Updates: 1
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] INFO  com.jiaoyi.service.CouponService - 优惠券退款成功，使用记录ID: 28
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] INFO  c.j.s.OrderTimeoutMessageService - 超时订单优惠券退还成功，订单ID: 32, 优惠券ID: 4
2025-10-28 18:56:22 [ConsumeMessageThread_order-timeout-consumer-group_1] INFO  c.j.s.OrderTimeoutMessageService - 订单超时取消成功，订单ID: 32, 订单号: ORD17616489121012266
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/orders/user/94", parameters={}
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.OrderController#getOrdersByUserId(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] INFO  c.jiaoyi.controller.OrderController - 查询用户订单列表，用户ID: 94
2025-10-28 18:56:25 [http-nio-8080-exec-10] INFO  com.jiaoyi.service.OrderService - 查询用户订单列表，用户ID: 94
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.OrderMapper.selectByUserId - ==>  Preparing: SELECT * FROM orders WHERE user_id = ? ORDER BY create_time DESC
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.OrderMapper.selectByUserId - ==> Parameters: 94(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.OrderMapper.selectByUserId - <==      Total: 20
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 32(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 31(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 30(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 29(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 28(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 27(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 26(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 25(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 24(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 23(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 22(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 21(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 20(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 19(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 18(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 17(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 16(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 15(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 14(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==>  Preparing: SELECT * FROM order_items WHERE order_id = ?
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - ==> Parameters: 13(Long)
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG c.j.m.O.selectByOrderId - <==      Total: 1
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [ApiResponse(code=200, message=操作成功, data=[OrderResponse(id=32, orderNo=ORD17616489121012266, userId= (truncated)...]
2025-10-28 18:56:25 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-10-28 18:56:53 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/payment/alipay/notify", parameters={masked}
2025-10-28 18:56:53 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.jiaoyi.controller.PaymentController#alipayNotify(HttpServletRequest)
2025-10-28 18:56:53 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 收到支付宝支付回调通知
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: gmt_create = 2025-10-28 18:56:38
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: charset = UTF-8
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: seller_email = gvmmnq2968@sandbox.com
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: subject = 订单支付：ORD17616489121012266
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: sign = lIzmIaZvpwRM5D8P5pT2qwwUUdqF3noZWxaBBfV2Dw4xWIRgXT2eyDyn8JjAfQsY+OhiNRcqLVgoNxdvj15+kIk+sW3JsY3BDIo3riWA8XlsQ1RTpcrTDo7nlVRM3lkcbJUcg/w0/RP58NP8+mp3uiQdNHCNNbmDV6yccDHd+tdBvVTl4nMuHzElUkHILugZsAUpBxc7gGUWR05xa1gRwPy2rtc1dhTEqw5eXRb61hKiTk2LP6g6dHNLE9vhxfWhzXnLZtbBWrGUyLteCQGsTbSWyToXiXREWDrUTAQ1+DF7wHKUPM2JnYHGwUoFqEM+gsVaabOOXZmctPpWRQca+A==
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: buyer_id = 2088722085542274
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: body = 商品购买
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: invoice_amount = 5500.00
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: notify_id = 2025102801222185652142270507238200
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: fund_bill_list = [{"amount":"5500.00","fundChannel":"ALIPAYACCOUNT"}]
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: notify_type = trade_status_sync
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: trade_status = TRADE_SUCCESS
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: receipt_amount = 5500.00
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: buyer_pay_amount = 5500.00
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: app_id = 9021000157614744
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: sign_type = RSA2
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: seller_id = 2088721085542262
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: gmt_payment = 2025-10-28 18:56:51
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: notify_time = 2025-10-28 18:56:53
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: version = 1.0
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: out_trade_no = ORD17616489121012266
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: total_amount = 5500.00
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: trade_no = 2025102822001442270507362242
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: auth_app_id = 9021000157614744
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: buyer_logon_id = bwugqj4497@sandbox.com
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 回调参数: point_amount = 0.00
2025-10-28 18:57:05 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 支付回调处理 - 订单号: ORD17616489121012266, 状态: TRADE_SUCCESS, 金额: 5500.00, 支付宝交易号: 2025102822001442270507362242
2025-10-28 18:57:06 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 开始处理支付成功回调，支付流水号: ORD17616489121012266
2025-10-28 18:57:07 [http-nio-8080-exec-6] DEBUG c.j.m.OrderMapper.selectByOrderNo - ==>  Preparing: SELECT * FROM orders WHERE order_no = ?
2025-10-28 18:57:07 [http-nio-8080-exec-6] DEBUG c.j.m.OrderMapper.selectByOrderNo - ==> Parameters: ORD17616489121012266(String)
2025-10-28 18:57:07 [http-nio-8080-exec-6] DEBUG c.j.m.OrderMapper.selectByOrderNo - <==      Total: 1
2025-10-28 18:57:13 [http-nio-8080-exec-6] WARN  c.j.controller.PaymentController - 订单已取消，但收到支付成功回调，订单号: ORD17616489121012266, 当前状态: CANCELLED
2025-10-28 18:57:16 [http-nio-8080-exec-6] WARN  c.j.controller.PaymentController - 处理已取消订单的支付回调，订单号: ORD17616489121012266, 订单ID: 32, 支付金额: 5500.00
2025-10-28 18:57:17 [http-nio-8080-exec-6] ERROR c.j.controller.PaymentController - 异常情况：订单已取消但支付成功，需要退款处理，订单号: ORD17616489121012266, 订单ID: 32, 支付金额: 5500.00
2025-10-28 18:59:10 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m57s14ms941µs100ns).
2025-10-28 18:59:10 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 18:59:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 18:59:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T18:19:10.064687700(LocalDateTime)
2025-10-28 18:59:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 18:59:10 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 18:59:11 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 发起退款，订单号: ORD17616489121012266, 退款金额: 5500.00, 退款原因: 订单超时取消自动退款
2025-10-28 18:59:13 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 发起支付宝退款，订单号: ORD17616489121012266, 退款金额: 5500.00, 退款原因: 订单超时取消自动退款
2025-10-28 18:59:27 [http-nio-8080-exec-6] INFO  sdk.biz.info - Summary^_^10000^_^null^_^ProtocalMustParams:charset=UTF-8&method=alipay.trade.refund&sign=hEj+j1m9GaCuJpFYBDzRn2Br60zE3raUU7iuFDeVdArBQdECZRIXxWmvUGC04H/k552dRBzX0+oIxeflga19151dXrFSlc+5Bpq+mkPX/hD3OCjs1lbyUDSLt1mvxmwa13eSTNb+HlqGGhCxgxK6I5wL4v11L84szgS79BeT92j09xcGUtH1jfGGdZ3+saaPnu/jHk+RPurubmFWKP2EO6EehQHXcywc7NZrhSEEtdKnLHHlh/ibPxNZmsCxLzPXyxB5AF7ib/fRJXndONpncGa+mPdOorigu+eVduIFNyu8/9Nqrd8xq9t59R0KVMcI2/HlIwKIEO/sA7qfz0ysZw==&version=1.0&app_id=9021000157614744&sign_type=RSA2&timestamp=2025-10-28 18:59:17^_^ProtocalOptParams:alipay_sdk=alipay-sdk-java-4.38.10.ALL&format=json^_^ApplicationParams:biz_content={"out_request_no":"REF1761649153701722","out_trade_no":"ORD17616489121012266","refund_amount":"5500.00","refund_reason":"订单超时取消自动退款"}^_^257ms,9856ms,253ms^_^trace_id:06022481176164916531988636847
2025-10-28 18:59:47 [http-nio-8080-exec-6] INFO  com.jiaoyi.service.AlipayService - 支付宝退款成功，订单号: ORD17616489121012266, 退款单号: REF1761649153701722, 退款金额: 5500.00
2025-10-28 18:59:47 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 退款成功，订单号: ORD17616489121012266, 退款金额: 5500.00
2025-10-28 18:59:47 [http-nio-8080-exec-6] INFO  c.j.controller.PaymentController - 已取消订单退款成功，订单号: ORD17616489121012266, 退款金额: 5500.00
2025-10-28 18:59:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-10-28 18:59:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing ["success"]
2025-10-28 18:59:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Using @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
2025-10-28 18:59:47 [http-nio-8080-exec-6] ERROR c.j.exception.GlobalExceptionHandler - 未知异常
org.apache.catalina.connector.ClientAbortException: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:305)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:267)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:120)
	at org.springframework.util.StreamUtils.copy(StreamUtils.java:135)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:130)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:44)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:236)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:300)
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.handleReturnValue(RequestResponseBodyMethodProcessor.java:190)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:78)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:136)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:917)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:829)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:542)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:118)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1381)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:566)
	at org.apache.coyote.http11.filters.IdentityOutputFilter.flush(IdentityOutputFilter.java:117)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:220)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1245)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:400)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:301)
	... 58 common frames omitted
2025-10-28 18:59:47 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Found 'Content-Type:text/plain;charset=UTF-8' in response
2025-10-28 18:59:47 [http-nio-8080-exec-6] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Failure in @ExceptionHandler com.jiaoyi.exception.GlobalExceptionHandler#handleException(Exception)
org.springframework.http.converter.HttpMessageNotWritableException: No converter for [class com.jiaoyi.common.ApiResponse] with preset Content-Type 'text/plain;charset=UTF-8'
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:319)
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.handleReturnValue(RequestResponseBodyMethodProcessor.java:190)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:78)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:136)
	at org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver.doResolveHandlerMethodException(ExceptionHandlerExceptionResolver.java:432)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodExceptionResolver.doResolveException(AbstractHandlerMethodExceptionResolver.java:74)
	at org.springframework.web.servlet.handler.AbstractHandlerExceptionResolver.resolveException(AbstractHandlerExceptionResolver.java:161)
	at org.springframework.web.servlet.handler.HandlerExceptionResolverComposite.resolveException(HandlerExceptionResolverComposite.java:80)
	at org.springframework.web.servlet.DispatcherServlet.processHandlerException(DispatcherServlet.java:1357)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1160)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.__invoke(StandardContextValve.java:90)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:41002)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:340)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-28 18:59:47 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: org.apache.catalina.connector.ClientAbortException: java.io.IOException: 你的主机中的软件中止了一个已建立的连接。
2025-10-28 19:04:10 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:04:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:04:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T18:24:10.494586(LocalDateTime)
2025-10-28 19:04:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:04:10 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 19:09:10 [scheduling-1] WARN  o.m.s.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.jiaoyi.mapper]' package. Please check your configuration.
2025-10-28 19:09:10 [scheduling-1] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-28 19:09:10 [scheduling-1] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-10-28 19:09:10 [scheduling-1] INFO  o.a.r.s.s.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='order-timeout-consumer-group', namespace='', nameServer='localhost:9876', topic='order-timeout-topic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='timeout', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-10-28 19:09:10 [scheduling-1] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:orderTimeoutMessageService, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_2
2025-10-28 19:09:10 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:09:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:09:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T18:29:10.873295200(LocalDateTime)
2025-10-28 19:09:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:09:10 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 19:14:10 [scheduling-1] WARN  o.m.s.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.jiaoyi.mapper]' package. Please check your configuration.
2025-10-28 19:14:10 [scheduling-1] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-28 19:14:10 [scheduling-1] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-10-28 19:14:10 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:14:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:14:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T18:34:10.915552100(LocalDateTime)
2025-10-28 19:14:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:14:10 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 19:19:10 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:19:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:19:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T18:39:10.936223800(LocalDateTime)
2025-10-28 19:19:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:19:10 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 19:24:10 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:24:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:24:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T18:44:10.961416200(LocalDateTime)
2025-10-28 19:24:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:24:10 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 19:29:10 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:29:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:29:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T18:49:10.971610100(LocalDateTime)
2025-10-28 19:29:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:29:10 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 19:34:10 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:34:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:34:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T18:54:10.980447700(LocalDateTime)
2025-10-28 19:34:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:34:10 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 19:39:10 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:39:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:39:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T18:59:10.984564600(LocalDateTime)
2025-10-28 19:39:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:39:10 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 19:44:10 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:44:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:44:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:04:10.990491900(LocalDateTime)
2025-10-28 19:44:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:44:10 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 19:49:10 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:49:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:49:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:09:10.997261200(LocalDateTime)
2025-10-28 19:49:10 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:49:10 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 19:54:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:54:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:54:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:14:11.001365600(LocalDateTime)
2025-10-28 19:54:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:54:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 19:59:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 19:59:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 19:59:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:19:11.010018800(LocalDateTime)
2025-10-28 19:59:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 19:59:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:04:11 [scheduling-1] WARN  o.m.s.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.jiaoyi.mapper]' package. Please check your configuration.
2025-10-28 20:04:11 [scheduling-1] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-28 20:04:11 [scheduling-1] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-10-28 20:04:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:04:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:04:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:24:11.151132400(LocalDateTime)
2025-10-28 20:04:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:04:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:09:11 [scheduling-1] WARN  o.m.s.mapper.ClassPathMapperScanner - No MyBatis mapper was found in '[com.jiaoyi.mapper]' package. Please check your configuration.
2025-10-28 20:09:11 [scheduling-1] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-10-28 20:09:11 [scheduling-1] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-10-28 20:09:11 [scheduling-1] INFO  o.a.r.s.s.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='order-timeout-consumer-group', namespace='', nameServer='localhost:9876', topic='order-timeout-topic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='timeout', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-10-28 20:09:11 [scheduling-1] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:orderTimeoutMessageService, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_3
2025-10-28 20:09:11 [scheduling-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 40 mappings in 'requestMappingHandlerMapping'
2025-10-28 20:09:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:09:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:09:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:29:11.850159900(LocalDateTime)
2025-10-28 20:09:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:09:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:14:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:14:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:14:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:34:11.855635(LocalDateTime)
2025-10-28 20:14:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:14:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:19:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:19:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:19:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:39:11.860796700(LocalDateTime)
2025-10-28 20:19:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:19:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:24:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:24:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:24:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:44:11.863840200(LocalDateTime)
2025-10-28 20:24:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:24:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:29:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:29:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:29:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:49:11.875817600(LocalDateTime)
2025-10-28 20:29:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:29:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:34:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:34:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:34:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:54:11.882670200(LocalDateTime)
2025-10-28 20:34:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:34:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:39:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:39:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:39:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T19:59:11.887970500(LocalDateTime)
2025-10-28 20:39:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:39:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:44:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:44:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:44:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:04:11.892413700(LocalDateTime)
2025-10-28 20:44:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:44:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:49:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:49:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:49:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:09:11.899467400(LocalDateTime)
2025-10-28 20:49:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:49:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:54:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:54:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:54:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:14:11.907196800(LocalDateTime)
2025-10-28 20:54:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:54:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 20:59:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 20:59:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 20:59:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:19:11.918940900(LocalDateTime)
2025-10-28 20:59:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 20:59:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:04:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:04:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:04:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:24:11.922986100(LocalDateTime)
2025-10-28 21:04:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:04:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:09:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:09:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:09:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:29:11.926197500(LocalDateTime)
2025-10-28 21:09:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:09:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:14:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:14:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:14:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:34:11.931794700(LocalDateTime)
2025-10-28 21:14:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:14:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:19:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:19:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:19:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:39:11.935312600(LocalDateTime)
2025-10-28 21:19:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:19:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:24:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:24:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:24:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:44:11.940142300(LocalDateTime)
2025-10-28 21:24:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:24:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:29:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:29:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:29:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:49:11.948964200(LocalDateTime)
2025-10-28 21:29:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:29:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:34:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:34:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:34:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:54:11.953937500(LocalDateTime)
2025-10-28 21:34:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:34:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:39:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:39:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:39:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T20:59:11.959676400(LocalDateTime)
2025-10-28 21:39:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:39:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:44:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:44:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:44:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T21:04:11.964091700(LocalDateTime)
2025-10-28 21:44:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:44:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:49:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:49:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:49:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T21:09:11.968650600(LocalDateTime)
2025-10-28 21:49:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:49:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:54:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:54:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:54:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T21:14:11.972465900(LocalDateTime)
2025-10-28 21:54:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:54:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 21:59:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 21:59:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 21:59:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T21:19:11.981951900(LocalDateTime)
2025-10-28 21:59:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 21:59:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 22:04:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 22:04:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 22:04:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T21:24:11.987993500(LocalDateTime)
2025-10-28 22:04:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 22:04:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 22:09:11 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 22:09:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 22:09:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T21:29:11.995244700(LocalDateTime)
2025-10-28 22:09:11 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 22:09:11 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 22:14:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 22:14:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 22:14:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T21:34:12.000494100(LocalDateTime)
2025-10-28 22:14:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 22:14:12 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 22:19:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 22:19:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 22:19:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T21:39:12.007373500(LocalDateTime)
2025-10-28 22:19:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 22:19:12 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 22:24:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 22:24:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 22:24:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T21:44:12.014517200(LocalDateTime)
2025-10-28 22:24:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 22:24:12 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 22:29:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 22:29:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 22:29:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T21:49:12.025459400(LocalDateTime)
2025-10-28 22:29:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 22:29:12 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
2025-10-28 22:34:12 [scheduling-1] INFO  c.j.s.OrderTimeoutFallbackService - 开始执行订单超时兜底检查任务
2025-10-28 22:34:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==>  Preparing: SELECT * FROM orders WHERE status = 'PENDING' AND create_time < ? ORDER BY create_time ASC
2025-10-28 22:34:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - ==> Parameters: 2025-10-28T21:54:12.030165100(LocalDateTime)
2025-10-28 22:34:12 [scheduling-1] DEBUG c.j.m.O.selectTimeoutOrders - <==      Total: 0
2025-10-28 22:34:12 [scheduling-1] DEBUG c.j.s.OrderTimeoutFallbackService - 未发现超时订单
