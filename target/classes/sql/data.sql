-- 插入测试数据
USE jiaoyi;

-- 清空现有数据（按依赖关系顺序）
DELETE FROM coupon_usage;
DELETE FROM inventory_transactions;
DELETE FROM order_items;
DELETE FROM orders;
DELETE FROM inventory;
DELETE FROM coupons;

-- 插入优惠券测试数据
INSERT INTO coupons (coupon_code, coupon_name, type, value, min_order_amount, max_discount_amount, status, total_quantity, used_quantity, limit_per_user, applicable_type, applicable_products, start_time, end_time, create_time, update_time) VALUES
-- 固定金额优惠券
('NEWUSER100', '新用户专享券', 'FIXED', 100.00, 500.00, NULL, 'ACTIVE', 1000, 0, 1, 'ALL', NULL, '2024-01-01 00:00:00', '2024-12-31 23:59:59', '2024-01-01 10:00:00', '2024-01-01 10:00:00'),
('SAVE200', '满减200元券', 'FIXED', 200.00, 1000.00, NULL, 'ACTIVE', 500, 0, 2, 'ALL', NULL, '2024-01-01 00:00:00', '2024-12-31 23:59:59', '2024-01-01 10:00:00', '2024-01-01 10:00:00'),
('VIP500', 'VIP专享券', 'FIXED', 500.00, 2000.00, NULL, 'ACTIVE', 100, 0, 1, 'ALL', NULL, '2024-01-01 00:00:00', '2024-12-31 23:59:59', '2024-01-01 10:00:00', '2024-01-01 10:00:00'),

-- 百分比折扣优惠券
('DISCOUNT10', '9折优惠券', 'PERCENTAGE', 10.00, 300.00, 500.00, 'ACTIVE', 2000, 0, 3, 'ALL', NULL, '2024-01-01 00:00:00', '2024-12-31 23:59:59', '2024-01-01 10:00:00', '2024-01-01 10:00:00'),
('DISCOUNT15', '85折优惠券', 'PERCENTAGE', 15.00, 800.00, 1000.00, 'ACTIVE', 1000, 0, 2, 'ALL', NULL, '2024-01-01 00:00:00', '2024-12-31 23:59:59', '2024-01-01 10:00:00', '2024-01-01 10:00:00'),
('DISCOUNT20', '8折优惠券', 'PERCENTAGE', 20.00, 1500.00, 2000.00, 'ACTIVE', 500, 0, 1, 'ALL', NULL, '2024-01-01 00:00:00', '2024-12-31 23:59:59', '2024-01-01 10:00:00', '2024-01-01 10:00:00'),

-- 指定商品优惠券
('IPHONE100', 'iPhone专享券', 'FIXED', 100.00, 0.00, NULL, 'ACTIVE', 300, 0, 1, 'PRODUCT', '[2001,2002,2003,2004]', '2024-01-01 00:00:00', '2024-12-31 23:59:59', '2024-01-01 10:00:00', '2024-01-01 10:00:00'),
('MACBOOK200', 'MacBook专享券', 'FIXED', 200.00, 0.00, NULL, 'ACTIVE', 200, 0, 1, 'PRODUCT', '[2005,2006,2007]', '2024-01-01 00:00:00', '2024-12-31 23:59:59', '2024-01-01 10:00:00', '2024-01-01 10:00:00'),

-- 已过期优惠券
('EXPIRED50', '已过期券', 'FIXED', 50.00, 200.00, NULL, 'EXPIRED', 100, 0, 1, 'ALL', NULL, '2023-12-01 00:00:00', '2023-12-31 23:59:59', '2023-12-01 10:00:00', '2023-12-31 23:59:59'),

-- 限量优惠券
('LIMITED1000', '限量1000元券', 'FIXED', 1000.00, 5000.00, NULL, 'ACTIVE', 50, 0, 1, 'ALL', NULL, '2024-01-01 00:00:00', '2024-12-31 23:59:59', '2024-01-01 10:00:00', '2024-01-01 10:00:00');

-- 插入库存测试数据
INSERT INTO inventory (product_id, product_name, current_stock, locked_stock, min_stock, max_stock, create_time, update_time) VALUES
-- 手机类
(2001, 'iPhone 15 Pro 256GB 深空黑色', 150, 0, 20, 1000, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2002, 'iPhone 15 Pro 512GB 钛原色', 80, 0, 15, 800, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2003, 'iPhone 15 128GB 粉色', 200, 0, 25, 1200, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2004, 'iPhone 15 256GB 蓝色', 120, 0, 20, 1000, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),

-- 电脑类
(2005, 'MacBook Pro 14英寸 M3 512GB', 60, 0, 10, 500, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2006, 'MacBook Air 13英寸 M2 256GB', 100, 0, 15, 800, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2007, 'MacBook Pro 16英寸 M3 Max 1TB', 30, 0, 5, 300, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),

-- 平板类
(2008, 'iPad Pro 12.9英寸 256GB', 80, 0, 12, 600, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2009, 'iPad Air 10.9英寸 64GB', 150, 0, 20, 1000, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2010, 'iPad mini 8.3英寸 64GB', 200, 0, 25, 1200, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),

-- 手表类
(2011, 'Apple Watch Series 9 GPS 45mm', 120, 0, 15, 800, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2012, 'Apple Watch Ultra 2 49mm', 50, 0, 8, 400, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2013, 'Apple Watch SE 44mm', 180, 0, 20, 1000, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),

-- 耳机类
(2014, 'AirPods Pro 2代 USB-C', 300, 0, 30, 2000, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2015, 'AirPods 3代 无线充电盒', 250, 0, 25, 1500, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2016, 'AirPods Max 深空灰色', 80, 0, 10, 500, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),

-- 配件类
(2017, 'Apple Pencil 2代', 200, 0, 20, 1000, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2018, 'Magic Keyboard iPad Pro 11英寸', 100, 0, 15, 600, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2019, 'Magic Mouse 2代', 150, 0, 20, 800, '2024-01-01 10:00:00', '2024-01-15 14:30:00'),
(2020, 'Studio Display 27英寸', 40, 0, 5, 200, '2024-01-01 10:00:00', '2024-01-15 14:30:00');

-- 插入订单测试数据
INSERT INTO orders (order_no, user_id, status, total_amount, coupon_id, coupon_code, discount_amount, actual_amount, receiver_name, receiver_phone, receiver_address, remark, create_time, update_time) VALUES
-- 待支付订单（使用优惠券）
('ORD202401150001', 1001, 'PENDING', 8999.00, 1, 'NEWUSER100', 100.00, 8899.00, '张三', '13800138001', '北京市朝阳区建国门外大街1号国贸大厦A座1001室', '请尽快发货，急用', '2024-01-15 09:30:00', '2024-01-15 09:30:00'),
('ORD202401150002', 1002, 'PENDING', 12999.00, 4, 'DISCOUNT10', 1299.90, 11699.10, '李四', '13800138002', '上海市浦东新区陆家嘴环路1000号恒生银行大厦20楼', '', '2024-01-15 10:15:00', '2024-01-15 10:15:00'),
('ORD202401150003', 1003, 'PENDING', 1999.00, 7, 'IPHONE100', 100.00, 1899.00, '王五', '13800138003', '广州市天河区珠江新城花城大道85号高德置地广场A座', '请包装精美一些', '2024-01-15 11:20:00', '2024-01-15 11:20:00'),

-- 已支付订单（使用优惠券）
('ORD202401140001', 1004, 'PAID', 15999.00, 2, 'SAVE200', 200.00, 15799.00, '赵六', '13800138004', '深圳市南山区科技园南区深南大道10000号腾讯大厦', '发票抬头：腾讯科技（深圳）有限公司', '2024-01-14 14:30:00', '2024-01-14 15:45:00'),
('ORD202401140002', 1005, 'PAID', 2499.00, 5, 'DISCOUNT15', 374.85, 2124.15, '孙七', '13800138005', '杭州市西湖区文三路259号昌地火炬大厦1号楼', '', '2024-01-14 16:20:00', '2024-01-14 17:10:00'),
('ORD202401140003', 1001, 'PAID', 899.00, NULL, NULL, 0.00, 899.00, '张三', '13800138001', '北京市朝阳区建国门外大街1号国贸大厦A座1001室', '', '2024-01-14 18:45:00', '2024-01-14 19:30:00'),

-- 已发货订单（使用优惠券）
('ORD202401130001', 1006, 'SHIPPED', 19999.00, 3, 'VIP500', 500.00, 19499.00, '周八', '13800138006', '成都市锦江区红星路三段1号国际金融中心', '请使用顺丰快递', '2024-01-13 09:15:00', '2024-01-13 16:20:00'),
('ORD202401130002', 1007, 'SHIPPED', 3999.00, 8, 'MACBOOK200', 200.00, 3799.00, '吴九', '13800138007', '武汉市江汉区中山大道818号佳丽广场', '', '2024-01-13 11:30:00', '2024-01-13 14:15:00'),
('ORD202401130003', 1002, 'SHIPPED', 1799.00, NULL, NULL, 0.00, 1799.00, '李四', '13800138002', '上海市浦东新区陆家嘴环路1000号恒生银行大厦20楼', '', '2024-01-13 15:45:00', '2024-01-13 18:30:00'),

-- 已送达订单（使用优惠券）
('ORD202401120001', 1008, 'DELIVERED', 12999.00, 6, 'DISCOUNT20', 2000.00, 10999.00, '郑十', '13800138008', '南京市鼓楼区中山路321号鼓楼国际大厦', '', '2024-01-12 10:20:00', '2024-01-12 16:45:00'),
('ORD202401120002', 1009, 'DELIVERED', 2999.00, NULL, NULL, 0.00, 2999.00, '冯十一', '13800138009', '西安市雁塔区高新路52号高科大厦', '', '2024-01-12 14:10:00', '2024-01-12 17:20:00'),

-- 已取消订单（使用优惠券）
('ORD202401110001', 1010, 'CANCELLED', 8999.00, 1, 'NEWUSER100', 100.00, 8899.00, '陈十二', '13800138010', '重庆市渝中区解放碑步行街88号大都会东方广场', '用户主动取消', '2024-01-11 16:30:00', '2024-01-11 17:15:00');

-- 插入订单项测试数据
INSERT INTO order_items (order_id, product_id, product_name, product_image, unit_price, quantity, subtotal) VALUES
-- 订单1：iPhone 15 Pro + AirPods Pro
(1, 2001, 'iPhone 15 Pro 256GB 深空黑色', 'https://store.apple.com/iphone-15-pro', 8999.00, 1, 8999.00),

-- 订单2：MacBook Pro + Apple Pencil
(2, 2005, 'MacBook Pro 14英寸 M3 512GB', 'https://store.apple.com/macbook-pro-14', 12999.00, 1, 12999.00),

-- 订单3：iPad Air + Apple Pencil
(3, 2009, 'iPad Air 10.9英寸 64GB', 'https://store.apple.com/ipad-air', 1999.00, 1, 1999.00),

-- 订单4：MacBook Pro 16英寸 + Studio Display
(4, 2007, 'MacBook Pro 16英寸 M3 Max 1TB', 'https://store.apple.com/macbook-pro-16', 15999.00, 1, 15999.00),

-- 订单5：iPad Pro + Magic Keyboard
(5, 2008, 'iPad Pro 12.9英寸 256GB', 'https://store.apple.com/ipad-pro', 2499.00, 1, 2499.00),

-- 订单6：AirPods Pro
(6, 2014, 'AirPods Pro 2代 USB-C', 'https://store.apple.com/airpods-pro', 899.00, 1, 899.00),

-- 订单7：MacBook Pro + iPad Pro + Apple Watch
(7, 2005, 'MacBook Pro 14英寸 M3 512GB', 'https://store.apple.com/macbook-pro-14', 12999.00, 1, 12999.00),
(7, 2008, 'iPad Pro 12.9英寸 256GB', 'https://store.apple.com/ipad-pro', 2499.00, 1, 2499.00),
(7, 2011, 'Apple Watch Series 9 GPS 45mm', 'https://store.apple.com/apple-watch-series-9', 4501.00, 1, 4501.00),

-- 订单8：iPhone 15 + AirPods
(8, 2003, 'iPhone 15 128GB 粉色', 'https://store.apple.com/iphone-15', 3999.00, 1, 3999.00),

-- 订单9：Apple Watch Ultra
(9, 2012, 'Apple Watch Ultra 2 49mm', 'https://store.apple.com/apple-watch-ultra', 1799.00, 1, 1799.00),

-- 订单10：MacBook Air + AirPods Max
(10, 2006, 'MacBook Air 13英寸 M2 256GB', 'https://store.apple.com/macbook-air', 12999.00, 1, 12999.00),

-- 订单11：iPad mini + Apple Pencil
(11, 2010, 'iPad mini 8.3英寸 64GB', 'https://store.apple.com/ipad-mini', 2999.00, 1, 2999.00),

-- 订单12：iPhone 15 Pro（已取消）
(12, 2001, 'iPhone 15 Pro 256GB 深空黑色', 'https://store.apple.com/iphone-15-pro', 8999.00, 1, 8999.00);

-- 插入库存变动记录测试数据
INSERT INTO inventory_transactions (product_id, order_id, transaction_type, quantity, before_stock, after_stock, before_locked, after_locked, remark, create_time) VALUES
-- 初始入库记录
(2001, NULL, 'IN', 200, 0, 200, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2002, NULL, 'IN', 100, 0, 100, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2003, NULL, 'IN', 250, 0, 250, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2004, NULL, 'IN', 150, 0, 150, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2005, NULL, 'IN', 80, 0, 80, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2006, NULL, 'IN', 120, 0, 120, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2007, NULL, 'IN', 40, 0, 40, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2008, NULL, 'IN', 100, 0, 100, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2009, NULL, 'IN', 180, 0, 180, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2010, NULL, 'IN', 220, 0, 220, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2011, NULL, 'IN', 140, 0, 140, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2012, NULL, 'IN', 60, 0, 60, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2013, NULL, 'IN', 200, 0, 200, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2014, NULL, 'IN', 350, 0, 350, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2015, NULL, 'IN', 280, 0, 280, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2016, NULL, 'IN', 100, 0, 100, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2017, NULL, 'IN', 250, 0, 250, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2018, NULL, 'IN', 120, 0, 120, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2019, NULL, 'IN', 180, 0, 180, 0, 0, '初始入库', '2024-01-01 10:00:00'),
(2020, NULL, 'IN', 50, 0, 50, 0, 0, '初始入库', '2024-01-01 10:00:00'),

-- 销售出库记录
(2001, 1, 'OUT', 1, 200, 199, 0, 0, '订单ORD202401150001销售出库', '2024-01-15 09:30:00'),
(2005, 2, 'OUT', 1, 80, 79, 0, 0, '订单ORD202401150002销售出库', '2024-01-15 10:15:00'),
(2009, 3, 'OUT', 1, 180, 179, 0, 0, '订单ORD202401150003销售出库', '2024-01-15 11:20:00'),
(2007, 4, 'OUT', 1, 40, 39, 0, 0, '订单ORD202401140001销售出库', '2024-01-14 15:45:00'),
(2008, 5, 'OUT', 1, 100, 99, 0, 0, '订单ORD202401140002销售出库', '2024-01-14 17:10:00'),
(2014, 6, 'OUT', 1, 350, 349, 0, 0, '订单ORD202401140003销售出库', '2024-01-14 19:30:00'),
(2005, 7, 'OUT', 1, 79, 78, 0, 0, '订单ORD202401130001销售出库', '2024-01-13 16:20:00'),
(2008, 7, 'OUT', 1, 99, 98, 0, 0, '订单ORD202401130001销售出库', '2024-01-13 16:20:00'),
(2011, 7, 'OUT', 1, 140, 139, 0, 0, '订单ORD202401130001销售出库', '2024-01-13 16:20:00'),
(2003, 8, 'OUT', 1, 250, 249, 0, 0, '订单ORD202401130002销售出库', '2024-01-13 14:15:00'),
(2012, 9, 'OUT', 1, 60, 59, 0, 0, '订单ORD202401130003销售出库', '2024-01-13 18:30:00'),
(2006, 10, 'OUT', 1, 120, 119, 0, 0, '订单ORD202401120001销售出库', '2024-01-12 16:45:00'),
(2010, 11, 'OUT', 1, 220, 219, 0, 0, '订单ORD202401120002销售出库', '2024-01-12 17:20:00'),

-- 库存调整记录
(2001, NULL, 'ADJUST', -50, 199, 149, 0, 0, '盘点调整，发现50台损坏', '2024-01-15 14:30:00'),
(2002, NULL, 'ADJUST', 20, 100, 120, 0, 0, '补货入库', '2024-01-15 14:30:00'),
(2003, NULL, 'ADJUST', -30, 249, 219, 0, 0, '盘点调整，发现30台损坏', '2024-01-15 14:30:00'),
(2004, NULL, 'ADJUST', 10, 150, 160, 0, 0, '补货入库', '2024-01-15 14:30:00'),
(2005, NULL, 'ADJUST', -10, 78, 68, 0, 0, '盘点调整，发现10台损坏', '2024-01-15 14:30:00'),
(2006, NULL, 'ADJUST', 15, 119, 134, 0, 0, '补货入库', '2024-01-15 14:30:00'),
(2007, NULL, 'ADJUST', -5, 39, 34, 0, 0, '盘点调整，发现5台损坏', '2024-01-15 14:30:00'),
(2008, NULL, 'ADJUST', 8, 98, 106, 0, 0, '补货入库', '2024-01-15 14:30:00'),
(2009, NULL, 'ADJUST', -20, 179, 159, 0, 0, '盘点调整，发现20台损坏', '2024-01-15 14:30:00'),
(2010, NULL, 'ADJUST', 12, 219, 231, 0, 0, '补货入库', '2024-01-15 14:30:00'),
(2011, NULL, 'ADJUST', -8, 139, 131, 0, 0, '盘点调整，发现8台损坏', '2024-01-15 14:30:00'),
(2012, NULL, 'ADJUST', 5, 59, 64, 0, 0, '补货入库', '2024-01-15 14:30:00'),
(2013, NULL, 'ADJUST', -15, 200, 185, 0, 0, '盘点调整，发现15台损坏', '2024-01-15 14:30:00'),
(2014, NULL, 'ADJUST', 25, 349, 374, 0, 0, '补货入库', '2024-01-15 14:30:00'),
(2015, NULL, 'ADJUST', -12, 280, 268, 0, 0, '盘点调整，发现12台损坏', '2024-01-15 14:30:00'),
(2016, NULL, 'ADJUST', 8, 100, 108, 0, 0, '补货入库', '2024-01-15 14:30:00'),
(2017, NULL, 'ADJUST', -18, 250, 232, 0, 0, '盘点调整，发现18台损坏', '2024-01-15 14:30:00'),
(2018, NULL, 'ADJUST', 10, 120, 130, 0, 0, '补货入库', '2024-01-15 14:30:00'),
(2019, NULL, 'ADJUST', -5, 180, 175, 0, 0, '盘点调整，发现5台损坏', '2024-01-15 14:30:00'),
(2020, NULL, 'ADJUST', 3, 50, 53, 0, 0, '补货入库', '2024-01-15 14:30:00');

-- 插入优惠券使用记录测试数据
INSERT INTO coupon_usage (coupon_id, user_id, order_id, coupon_code, discount_amount, used_time, order_amount, actual_amount, status, remark, create_time) VALUES
-- 已使用的优惠券记录
(1, 1001, 1, 'NEWUSER100', 100.00, '2024-01-15 09:30:00', 8999.00, 8899.00, 'USED', '新用户专享券使用', '2024-01-15 09:30:00'),
(4, 1002, 2, 'DISCOUNT10', 1299.90, '2024-01-15 10:15:00', 12999.00, 11699.10, 'USED', '9折优惠券使用', '2024-01-15 10:15:00'),
(7, 1003, 3, 'IPHONE100', 100.00, '2024-01-15 11:20:00', 1999.00, 1899.00, 'USED', 'iPhone专享券使用', '2024-01-15 11:20:00'),
(2, 1004, 4, 'SAVE200', 200.00, '2024-01-14 15:45:00', 15999.00, 15799.00, 'USED', '满减200元券使用', '2024-01-14 15:45:00'),
(5, 1005, 5, 'DISCOUNT15', 374.85, '2024-01-14 17:10:00', 2499.00, 2124.15, 'USED', '85折优惠券使用', '2024-01-14 17:10:00'),
(3, 1006, 7, 'VIP500', 500.00, '2024-01-13 16:20:00', 19999.00, 19499.00, 'USED', 'VIP专享券使用', '2024-01-13 16:20:00'),
(8, 1007, 8, 'MACBOOK200', 200.00, '2024-01-13 14:15:00', 3999.00, 3799.00, 'USED', 'MacBook专享券使用', '2024-01-13 14:15:00'),
(6, 1008, 10, 'DISCOUNT20', 2000.00, '2024-01-12 16:45:00', 12999.00, 10999.00, 'USED', '8折优惠券使用', '2024-01-12 16:45:00'),
(1, 1010, 12, 'NEWUSER100', 100.00, '2024-01-11 17:15:00', 8999.00, 8899.00, 'REFUNDED', '订单取消，优惠券已退款', '2024-01-11 17:15:00');
